2025-06-29 21:41:10,791 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:41:10,792 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:41:10,796 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:41:10,796 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:41:46,972 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:46,972 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:46,983 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 21:41:46,989 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-29 21:41:47,034 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:47,035 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:47,035 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 21:41:47,038 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-29 21:41:47,087 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:47,088 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:47,091 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 21:41:47,094 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-29 21:41:47,126 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:47,127 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:47,127 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 21:41:47,131 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-29 21:41:51,250 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:41:51,250 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:41:51,250 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:41:51,250 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 30, 5, 11, 51, 250235), 'iat': datetime.datetime(2025, 6, 30, 4, 41, 51, 250318)}
2025-06-29 21:41:51,251 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:41:51,251 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxODYzMzExLCJpYXQiOjE3NTEyNTg1MTF9.txlYB-GgOelNHVtqQfIPVXb8d4MxNkXP7enR6SPHDO8, Expiry (seconds): 604800
2025-06-29 21:41:51,253 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-29 21:41:52,371 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,371 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,372 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,372 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 21:41:52,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,372 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,372 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,373 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:52,382 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:52,383 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:52,383 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:52,419 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,419 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,420 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,420 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,420 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 21:41:52,420 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,421 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,424 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,424 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,424 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:52,454 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,455 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,456 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,458 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,459 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:52,473 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:52,474 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:52,474 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:52,515 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:52,515 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:52,708 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:52,709 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:52,710 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,710 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:52,710 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:52,761 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:52,761 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:54,051 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:54,051 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:54,056 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:54,057 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:54,057 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:54,084 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:54,085 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:41:54,374 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:54,374 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:54,375 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:56,253 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:41:56,256 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:41:56,258 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:56,258 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:41:56,258 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:41:56,276 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:41:56,276 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:42:55,106 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:42:55,106 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:42:55,110 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:42:55,110 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:42:55,117 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:42:55,117 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:42:55,117 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:42:55,117 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 17, 55, 117158), 'iat': datetime.datetime(2025, 6, 30, 4, 42, 55, 117162)}
2025-06-29 21:42:55,117 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:42:58,672 - INFO - app.core.security - Closing Redis connection...
2025-06-29 21:42:58,678 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:42:58,678 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:42:58,679 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:42:58,684 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:42:58,685 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:42:58,686 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:42:58,686 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:42:58,689 - INFO - app.core.security - Redis connection closed.
2025-06-29 21:42:58,713 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:43:01,539 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:43:01,539 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:43:01,544 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:43:01,545 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:43:01,554 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:43:01,554 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:43:01,554 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:43:01,554 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 18, 1, 554568), 'iat': datetime.datetime(2025, 6, 30, 4, 43, 1, 554572)}
2025-06-29 21:43:01,555 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:43:03,262 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,263 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,263 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,263 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,263 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:03,267 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,268 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,269 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,269 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,269 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 21:43:03,269 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,269 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,270 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,270 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,270 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:03,497 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:03,497 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:03,498 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:03,506 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:03,507 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:03,526 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,526 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,526 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,527 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,527 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 21:43:03,527 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,527 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,527 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,528 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,528 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:03,535 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:03,535 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:03,535 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:03,608 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:03,608 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:03,609 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,609 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:03,609 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:03,617 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:03,617 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:04,142 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:04,143 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:04,143 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:04,143 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:04,143 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:04,152 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:04,153 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:04,478 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:04,478 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:04,479 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:04,695 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:43:04,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:43:04,695 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:04,696 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:43:04,696 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:43:04,702 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:43:04,702 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:43:17,077 - INFO - app.core.security - Closing Redis connection...
2025-06-29 21:43:17,080 - INFO - app.core.security - Redis connection closed.
2025-06-29 21:50:42,682 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:50:42,682 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:50:42,688 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:50:42,688 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:50:42,696 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:50:42,696 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:50:42,696 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:50:42,696 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 25, 42, 695996), 'iat': datetime.datetime(2025, 6, 30, 4, 50, 42, 695998)}
2025-06-29 21:50:42,696 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:50:43,705 - INFO - app.core.security - Service account JWT for 'barclays_service_provider' was generated and pushed to Firebase.
2025-06-29 21:50:44,438 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:50:44,438 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:50:44,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:50:44,441 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:50:44,442 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:50:44,442 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:50:44,442 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:50:44,442 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:50:44,572 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:50:44,572 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:51:03,436 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:51:03,436 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:51:03,436 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:51:03,436 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:51:03,436 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:52:01,795 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:52:01,795 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:52:01,796 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:52:01,796 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:52:01,796 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:52:01,798 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:52:01,798 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:52:40,338 - INFO - app.core.security - Closing Redis connection...
2025-06-29 21:52:40,339 - INFO - app.core.security - Redis connection closed.
2025-06-29 21:58:45,854 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:58:45,854 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:58:45,858 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:58:45,858 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:58:45,867 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:58:45,867 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:58:45,867 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:58:45,867 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 33, 45, 867752), 'iat': datetime.datetime(2025, 6, 30, 4, 58, 45, 867756)}
2025-06-29 21:58:45,868 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:58:49,387 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:58:49,387 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:58:49,387 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:58:50,820 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:58:50,820 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:58:50,820 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:58:50,821 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:58:50,823 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:59:14,618 - INFO - app.core.security - Closing Redis connection...
2025-06-29 21:59:14,619 - INFO - app.core.security - Redis connection closed.
2025-06-29 21:59:31,031 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 21:59:31,031 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 21:59:31,036 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 21:59:31,036 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 21:59:31,047 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 21:59:31,047 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 21:59:31,048 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 21:59:31,048 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 34, 31, 47709), 'iat': datetime.datetime(2025, 6, 30, 4, 59, 31, 47714)}
2025-06-29 21:59:31,049 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 21:59:34,403 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:59:34,403 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:59:34,404 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:59:42,567 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:59:42,567 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:59:42,568 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:59:42,568 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:59:42,568 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 21:59:42,578 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 21:59:42,579 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 21:59:56,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 21:59:56,372 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 21:59:56,373 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 21:59:56,373 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 21:59:56,377 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:00:43,398 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:00:43,399 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:00:43,399 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:00:43,400 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:00:43,400 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:00:43,407 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:00:43,408 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:01:18,492 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:01:18,492 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:01:18,493 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:01:18,493 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:01:18,493 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:01:18,500 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:01:18,500 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:02:02,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:02:02,372 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:02:02,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:02:02,372 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:02:02,372 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:02:02,376 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:02:02,376 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:02:10,525 - INFO - app.core.security - Closing Redis connection...
2025-06-29 22:02:10,526 - INFO - app.core.security - Redis connection closed.
2025-06-29 22:04:18,643 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 22:04:18,643 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 22:04:18,648 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 22:04:18,648 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 22:04:18,659 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:04:18,660 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:04:18,660 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:04:18,660 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 39, 18, 659907), 'iat': datetime.datetime(2025, 6, 30, 5, 4, 18, 659912)}
2025-06-29 22:04:18,661 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:04:23,383 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:04:23,383 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:04:23,384 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:04:25,781 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:04:25,781 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:04:25,782 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:04:25,782 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:04:25,792 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:04:35,111 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:04:35,112 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:04:35,113 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:04:35,113 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:04:35,113 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:04:35,155 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:04:35,156 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:05:08,647 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:05:08,647 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:05:08,648 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:08,648 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:08,648 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:05:08,652 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:05:08,652 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:05:22,230 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:05:22,230 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:05:22,231 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:22,231 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:05:22,232 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:05:31,649 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:05:31,649 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:05:31,649 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:31,649 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:31,649 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:05:31,657 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:05:31,658 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:05:44,436 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:05:44,436 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:05:44,437 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:44,437 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:44,437 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:05:44,477 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:05:44,478 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:05:50,484 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:05:50,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:05:50,490 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:50,493 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:05:50,497 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:05:50,653 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:05:50,654 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:06:26,870 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:06:26,870 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:06:26,871 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:26,871 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:26,872 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:06:26,889 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:06:26,890 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:06:41,457 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:06:41,458 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:06:41,459 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:41,464 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:06:41,478 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:06:49,570 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:06:49,570 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:06:49,571 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:49,571 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:49,571 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:06:49,610 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:06:49,611 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:06:54,501 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:06:54,503 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:06:54,510 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:54,511 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:06:54,511 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:06:54,581 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:06:54,583 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:07:09,521 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:09,521 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:09,522 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:07:09,522 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:07:09,522 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:07:09,542 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:07:09,543 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:07:24,688 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:24,694 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:24,695 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:07:24,701 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:07:24,723 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:07:26,640 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:26,641 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:26,646 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:07:26,648 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751260311, 'iat': 1751258511}
2025-06-29 22:07:26,648 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:07:26,721 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:07:26,721 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:07:26,722 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:07:26,745 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYwMzExLCJpYXQiOjE3NTEyNTg1MTF9.DiAxcTyg66BcMm7m13pxgiDA0SANhRlWvnH-DqS4kHc
2025-06-29 22:07:29,452 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:07:29,453 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:07:29,453 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:07:29,454 - DEBUG - app.core.security - Payload to encode: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': datetime.datetime(2025, 6, 30, 5, 37, 29, 452744), 'iat': datetime.datetime(2025, 6, 30, 5, 7, 29, 452770)}
2025-06-29 22:07:29,455 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:07:29,456 - INFO - app.core.security - Storing refresh token for user ID 9 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTE4NjQ4NDksImlhdCI6MTc1MTI2MDA0OX0.BJWdBaaEjNDcqGX3XKkcKerLslg6xu14nQIYbpXugO0, Expiry (seconds): 604800
2025-06-29 22:07:29,466 - INFO - app.core.security - Refresh token stored successfully for user ID: 9
2025-06-29 22:07:30,680 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:30,682 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:30,684 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,684 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,684 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:07:30,685 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:30,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:30,696 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,697 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,701 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:30,741 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:30,742 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:30,742 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:30,820 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:30,820 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:30,827 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,828 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,828 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:07:30,832 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:30,835 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:30,837 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,840 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,841 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:30,867 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:30,867 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:30,868 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:30,906 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:30,907 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:30,908 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,912 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:30,913 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:30,965 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:30,967 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:32,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:32,980 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:32,985 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:32,986 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:32,991 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:33,062 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:33,062 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:33,297 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:33,297 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:33,302 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:33,303 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:33,303 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:33,352 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:33,353 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:33,986 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:33,986 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:33,987 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:37,337 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:37,339 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:37,341 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:37,341 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:37,341 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:37,397 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:37,398 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:37,933 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:37,933 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:37,936 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:37,937 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:37,937 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:38,055 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:38,055 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:47,814 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:47,814 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:47,817 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:47,817 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:47,818 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:07:47,818 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:07:47,818 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:07:47,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:47,820 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:07:47,820 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:07:47,869 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:07:47,869 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:07:47,870 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:08:00,951 - INFO - app.core.security - Closing Redis connection...
2025-06-29 22:08:00,959 - INFO - app.core.security - Redis connection closed.
2025-06-29 22:14:04,296 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 22:14:04,297 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 22:14:04,300 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 22:14:04,300 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 22:14:04,307 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:14:04,307 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:14:04,307 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:14:04,307 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 5, 49, 4, 307545), 'iat': datetime.datetime(2025, 6, 30, 5, 14, 4, 307548)}
2025-06-29 22:14:04,308 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:14:06,618 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:06,618 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:06,618 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:06,618 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEyNjE4NDksImlhdCI6MTc1MTI2MDA0OX0.GN6kWyARMD62hEDHBYRNohemfXUUKWThaYD1Qt5XbdQ
2025-06-29 22:14:06,619 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTEyNjE4NDksImlhdCI6MTc1MTI2MDA0OX0.GN6kWyARMD62hEDHBYRNohemfXUUKWThaYD1Qt5XbdQ
2025-06-29 22:14:10,787 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:10,787 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:10,788 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:10,788 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:10,789 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:14:11,134 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:14:11,134 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:14:11,768 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:11,769 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:11,769 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:12,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:12,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:12,624 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:12,625 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:12,625 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:12,625 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:12,626 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:12,628 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:12,628 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751261849, 'iat': 1751260049}
2025-06-29 22:14:12,629 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-06-29 22:14:12,737 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-06-29 22:14:12,739 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:14:12,740 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-06-29 22:14:27,833 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:14:27,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:14:27,834 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:14:27,834 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 30, 5, 44, 27, 833747), 'iat': datetime.datetime(2025, 6, 30, 5, 14, 27, 833765)}
2025-06-29 22:14:27,835 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:14:27,836 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxODY1MjY3LCJpYXQiOjE3NTEyNjA0Njd9.AmWi-IiaMfpzb7qlzBNIsNlURySrS4MSAm4Hg0JNqBU, Expiry (seconds): 604800
2025-06-29 22:14:27,839 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-29 22:14:29,518 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:29,518 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:29,519 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,519 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,519 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:29,519 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:29,519 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:29,520 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,520 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,520 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:29,529 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:29,529 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:29,529 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:29,551 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:29,552 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:29,553 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,554 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,554 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:29,554 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:29,554 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:29,555 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,555 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,556 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:29,696 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:29,710 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:29,724 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,724 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:29,725 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:29,854 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:29,855 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:29,855 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:29,966 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:29,966 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:30,931 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:30,932 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:30,933 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:30,933 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:30,934 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:30,964 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:30,965 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:32,001 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:32,002 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:32,003 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:32,003 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:32,003 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:32,015 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:32,015 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:34,893 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:34,893 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:34,894 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:34,894 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:34,894 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:34,897 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:34,897 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:35,200 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:35,200 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:35,201 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:42,360 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:42,360 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:42,361 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:42,361 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:42,361 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:42,362 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:42,362 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:42,362 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:42,363 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:42,364 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:42,411 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:42,411 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:42,412 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:43,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:43,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:43,898 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:43,898 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:43,899 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:43,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:43,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:43,900 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:43,900 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:43,900 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:43,930 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:43,931 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:43,931 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:45,889 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:45,902 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:45,911 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:45,912 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:45,913 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:45,913 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:45,913 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:45,914 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:45,920 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:45,921 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:46,044 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:46,044 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:46,045 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:47,900 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:47,901 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:47,902 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:47,902 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:47,903 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:14:47,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:14:47,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:14:47,906 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:47,906 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:14:47,907 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:14:47,945 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:14:47,945 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:14:47,946 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:09,080 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:09,081 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:09,083 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:09,083 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:09,083 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:09,114 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:09,114 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,211 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,212 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,213 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,213 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,213 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:15:22,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,213 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,214 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,214 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,214 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:22,225 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:22,226 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,226 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,273 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,273 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,274 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,274 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,275 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:15:22,275 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,275 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,276 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,276 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,279 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:22,303 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,304 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,305 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,306 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,307 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:22,337 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:22,338 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,338 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,374 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:22,375 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:22,414 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:22,415 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:22,418 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,419 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:22,419 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:22,459 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:22,467 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:25,363 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:25,365 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:25,372 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:25,372 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:25,373 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:25,408 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:25,409 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:15:25,811 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:25,812 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:25,816 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:28,930 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:15:28,930 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:15:28,932 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:28,932 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:15:28,932 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:15:28,958 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:15:28,959 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:16:22,534 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:16:22,534 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:16:22,535 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:16:22,535 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYyMjY3LCJpYXQiOjE3NTEyNjA0Njd9.pwt4w70KkizEICpI1vT4h-hVphMbDiPvl7OZa6gCS68
2025-06-29 22:16:22,537 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjYyMjY3LCJpYXQiOjE3NTEyNjA0Njd9.pwt4w70KkizEICpI1vT4h-hVphMbDiPvl7OZa6gCS68
2025-06-29 22:16:36,752 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:16:36,753 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:16:36,754 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:16:36,754 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751262267, 'iat': 1751260467}
2025-06-29 22:16:36,754 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:16:36,778 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:16:36,778 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:17:09,462 - INFO - app.core.security - Closing Redis connection...
2025-06-29 22:17:09,463 - INFO - app.core.security - Redis connection closed.
2025-06-29 22:53:36,498 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 22:53:36,498 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 22:53:36,501 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 22:53:36,502 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 22:53:36,511 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:53:36,511 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:53:36,511 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:53:36,511 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 6, 28, 36, 511227), 'iat': datetime.datetime(2025, 6, 30, 5, 53, 36, 511236)}
2025-06-29 22:53:36,512 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:54:24,746 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 22:54:24,746 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 22:54:24,746 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 22:54:24,746 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 30, 6, 24, 24, 745972), 'iat': datetime.datetime(2025, 6, 30, 5, 54, 24, 745984)}
2025-06-29 22:54:24,748 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 22:54:24,749 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxODY3NjY0LCJpYXQiOjE3NTEyNjI4NjR9.XKgibxFBwq4I4Px6SWgDIkMwDh6E0ST4I02CAx2nJzo, Expiry (seconds): 604800
2025-06-29 22:54:24,763 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-29 22:54:25,909 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:25,909 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:25,910 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,910 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,910 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:54:25,910 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:25,910 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:25,910 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,911 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,911 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:54:25,925 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:54:25,926 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:25,931 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:25,966 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:25,967 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:25,967 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,968 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,968 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 22:54:25,968 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:25,968 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:25,970 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,979 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:25,980 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:54:26,014 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:54:26,014 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:26,014 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:26,033 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:26,033 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:26,033 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:26,033 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:26,033 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:54:26,045 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:54:26,046 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:26,349 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:26,349 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:26,352 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:26,353 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:26,353 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:54:26,372 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:54:26,372 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:27,257 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:27,258 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:27,259 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:27,259 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:27,259 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:54:27,267 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:54:27,267 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:27,578 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:27,578 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:27,578 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:28,178 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 22:54:28,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 22:54:28,179 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:28,179 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 22:54:28,179 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 22:54:28,195 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 22:54:28,195 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 22:54:58,918 - INFO - app.core.security - Closing Redis connection...
2025-06-29 22:54:58,919 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:19:13,212 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:19:13,212 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:19:13,215 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:19:13,215 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:19:13,221 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:19:13,221 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:19:13,221 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:19:13,221 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 6, 54, 13, 221092), 'iat': datetime.datetime(2025, 6, 30, 6, 19, 13, 221094)}
2025-06-29 23:19:13,221 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:19:16,397 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:16,397 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:16,397 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:20,547 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:20,547 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:20,547 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:20,547 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY0NjY0LCJpYXQiOjE3NTEyNjI4NjR9.s8D7k1j5Sp6Xj8RXlMVFpIHacc1sLjQqqeAPe1k8dcY
2025-06-29 23:19:20,549 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY0NjY0LCJpYXQiOjE3NTEyNjI4NjR9.s8D7k1j5Sp6Xj8RXlMVFpIHacc1sLjQqqeAPe1k8dcY
2025-06-29 23:19:27,908 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:27,909 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:27,909 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:27,909 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:27,910 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:19:27,910 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:27,910 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:27,910 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:27,911 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:27,911 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:27,923 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:27,924 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:27,924 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:28,741 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:28,742 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:28,742 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:28,742 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:28,743 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:19:28,743 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:28,743 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:28,743 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:28,744 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:28,744 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:28,773 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:28,774 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:28,775 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:29,556 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:29,556 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:29,557 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:29,557 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:29,557 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:19:29,557 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:29,557 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:29,557 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:29,558 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:29,558 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:29,571 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:29,572 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:29,572 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:30,382 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:30,382 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:30,383 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:30,383 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:30,384 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:19:30,384 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:30,384 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:30,384 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:30,385 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:30,385 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:30,406 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:30,407 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:30,407 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:31,686 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:31,686 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:31,687 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:31,687 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:31,687 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:31,706 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:31,707 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:33,246 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:33,247 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:33,247 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:33,247 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:33,247 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:33,261 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:33,261 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:38,864 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:38,864 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:38,865 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:38,865 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:38,865 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:38,872 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:38,872 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:19:48,343 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:19:48,343 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:19:48,343 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:48,343 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:19:48,343 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:19:48,350 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:19:48,350 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:20:05,948 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:20:05,948 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:20:05,948 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:05,948 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:05,949 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:20:05,959 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:20:05,959 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:20:20,360 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:20:20,361 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:20:20,361 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:20,361 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY0NjY0LCJpYXQiOjE3NTEyNjI4NjR9.s8D7k1j5Sp6Xj8RXlMVFpIHacc1sLjQqqeAPe1k8dcY
2025-06-29 23:20:20,364 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY0NjY0LCJpYXQiOjE3NTEyNjI4NjR9.s8D7k1j5Sp6Xj8RXlMVFpIHacc1sLjQqqeAPe1k8dcY
2025-06-29 23:20:47,066 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:20:47,066 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:20:47,067 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:47,067 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:47,067 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:20:47,069 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:20:47,070 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:20:51,060 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:20:51,060 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:20:51,060 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:51,060 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:51,060 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:20:51,063 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:20:51,063 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:20:53,330 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:20:53,330 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:20:53,330 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:53,330 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:20:53,330 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:20:53,332 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:20:53,332 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:20:56,367 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:20:56,369 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:21:20,419 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:21:20,419 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:21:20,423 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:21:20,424 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:21:20,433 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:21:20,433 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:21:20,433 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:21:20,433 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 6, 56, 20, 433664), 'iat': datetime.datetime(2025, 6, 30, 6, 21, 20, 433667)}
2025-06-29 23:21:20,434 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:21:25,373 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:21:25,374 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:21:25,374 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:06,380 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:22:06,380 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:22:06,380 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:06,380 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:06,380 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:22:06,384 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:22:06,384 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:22:08,164 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:22:08,164 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:22:08,165 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:08,165 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:08,165 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:22:08,169 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:22:08,169 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:22:09,261 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:22:09,262 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:22:09,262 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:09,262 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:22:09,263 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:22:09,269 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:22:09,269 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:22:58,069 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:22:58,070 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:23:00,251 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:23:00,252 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:23:00,255 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:23:00,255 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:23:00,263 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:23:00,263 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:23:00,263 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:23:00,263 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 6, 58, 0, 263413), 'iat': datetime.datetime(2025, 6, 30, 6, 23, 0, 263416)}
2025-06-29 23:23:00,264 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:23:02,392 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:23:02,392 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:23:02,392 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:23:23,440 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:23:23,441 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:23:23,441 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:23:23,441 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:23:23,441 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:23:23,449 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:23:23,449 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:23:23,470 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:23:23,471 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:23:23,471 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:23:23,471 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751264664, 'iat': 1751262864}
2025-06-29 23:23:23,471 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:23:23,476 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:23:23,476 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:23:25,304 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:23:25,304 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:26:26,218 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:26:26,219 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:26:26,228 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:26:26,228 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:26:26,234 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:26:26,234 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:26:26,234 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:26:26,234 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 1, 26, 234581), 'iat': datetime.datetime(2025, 6, 30, 6, 26, 26, 234588)}
2025-06-29 23:26:26,235 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:26:27,934 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:27,934 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:27,934 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 23:26:30,734 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:30,734 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:30,735 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-29 23:26:34,241 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:26:34,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:26:34,241 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:26:34,241 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': datetime.datetime(2025, 6, 30, 6, 56, 34, 241070), 'iat': datetime.datetime(2025, 6, 30, 6, 26, 34, 241075)}
2025-06-29 23:26:34,241 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:26:34,241 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxODY5NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.1CI2M3SnTBh7ncTGY0-jr7cE89v3CV49yWPVTL2PHHE, Expiry (seconds): 604800
2025-06-29 23:26:34,242 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-29 23:26:35,352 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:35,352 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:35,353 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,353 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,353 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:26:35,353 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:35,354 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:35,354 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,354 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,355 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:26:35,390 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:26:35,390 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:35,390 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:35,464 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:35,465 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:35,465 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,465 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,465 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:26:35,512 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:35,512 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:35,519 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,519 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,519 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:26:35,520 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:35,520 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:35,524 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,524 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,524 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:26:35,536 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:26:35,537 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:35,726 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:35,726 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:35,727 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,727 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:35,727 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:26:35,804 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:26:35,809 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:35,809 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:35,826 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:26:35,827 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:38,276 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:38,277 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:38,280 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:38,280 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:38,280 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:26:38,301 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:26:38,306 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:26:38,661 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:38,661 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:38,662 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:44,063 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:26:44,063 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:26:44,064 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:44,064 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:26:44,064 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:26:44,119 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:26:44,120 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:27:50,480 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:27:50,480 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:27:50,481 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:27:50,481 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:27:50,481 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:27:50,483 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:27:50,483 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:28:25,509 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:28:25,509 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:28:27,793 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:28:27,794 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:28:27,797 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:28:27,797 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:28:27,802 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:28:27,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:28:27,802 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:28:27,802 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 3, 27, 802230), 'iat': datetime.datetime(2025, 6, 30, 6, 28, 27, 802233)}
2025-06-29 23:28:27,802 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:28:29,373 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:28:29,373 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:28:29,373 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:28:39,238 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:28:39,238 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:29:52,727 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:29:52,727 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:29:52,730 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:29:52,730 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:29:52,738 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:29:52,738 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:29:52,738 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:29:52,738 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 4, 52, 738636), 'iat': datetime.datetime(2025, 6, 30, 6, 29, 52, 738642)}
2025-06-29 23:29:52,739 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:29:55,387 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:29:55,387 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:29:55,387 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:07,848 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:30:07,849 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:30:07,850 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:07,850 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY2NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.TZ7rf64aKjUmx0iiaeYAnwjTENcmDAJVA_Mud8o-NMw
2025-06-29 23:30:07,851 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY2NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.TZ7rf64aKjUmx0iiaeYAnwjTENcmDAJVA_Mud8o-NMw
2025-06-29 23:30:13,859 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:30:13,860 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:30:13,861 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:13,862 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:13,862 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:30:13,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:30:13,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:30:13,863 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:13,863 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:13,863 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:30:13,880 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:30:13,880 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:30:13,880 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:30:17,095 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:30:17,095 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:30:17,096 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:17,096 - INFO - app.core.security - Token payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:17,096 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-29 23:30:17,096 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:30:17,097 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:30:17,097 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:17,097 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:17,097 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:30:17,130 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:30:17,131 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:30:17,131 - INFO - app.core.security - Authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:30:20,493 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:30:20,493 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:30:20,493 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:20,494 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:30:20,494 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:30:20,572 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:30:20,573 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:31:13,398 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:31:13,399 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:32:36,293 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:32:36,294 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:32:36,296 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:32:36,296 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:32:36,303 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:32:36,303 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:32:36,303 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:32:36,303 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 7, 36, 303491), 'iat': datetime.datetime(2025, 6, 30, 6, 32, 36, 303494)}
2025-06-29 23:32:36,303 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:32:38,429 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:32:38,429 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:32:38,429 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:32:45,600 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:32:45,601 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:32:45,601 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:32:45,601 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY2NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.TZ7rf64aKjUmx0iiaeYAnwjTENcmDAJVA_Mud8o-NMw
2025-06-29 23:32:45,602 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY2NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.TZ7rf64aKjUmx0iiaeYAnwjTENcmDAJVA_Mud8o-NMw
2025-06-29 23:32:48,240 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:32:48,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:32:48,241 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:32:48,241 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:32:48,241 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:32:48,246 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:32:48,247 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:33:03,182 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:33:03,183 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:33:03,183 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:33:03,183 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:33:03,183 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:33:03,197 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:33:03,197 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:33:42,283 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:33:42,283 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:34:20,907 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:34:20,907 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:34:20,911 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:34:20,911 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:34:20,917 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:34:20,917 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:34:20,917 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:34:20,917 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 9, 20, 917420), 'iat': datetime.datetime(2025, 6, 30, 6, 34, 20, 917425)}
2025-06-29 23:34:20,918 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:34:49,111 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:34:49,111 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:34:49,115 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:34:49,116 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:34:49,124 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:34:49,124 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:34:49,124 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:34:49,124 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 9, 49, 124562), 'iat': datetime.datetime(2025, 6, 30, 6, 34, 49, 124566)}
2025-06-29 23:34:49,125 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:34:50,886 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:34:50,886 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:34:50,886 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:35:06,712 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:35:06,712 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:35:06,713 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:35:06,713 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:35:06,713 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:35:06,715 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:35:06,716 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:36:22,693 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:36:22,693 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:36:22,693 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:36:22,694 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:36:22,694 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:36:22,697 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:36:22,697 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:36:32,940 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:36:32,941 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:36:35,803 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:36:35,803 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:36:35,806 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:36:35,806 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:36:35,810 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:36:35,811 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:36:35,811 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:36:35,811 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 11, 35, 810972), 'iat': datetime.datetime(2025, 6, 30, 6, 36, 35, 810974)}
2025-06-29 23:36:35,811 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:36:37,257 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:36:37,257 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:36:37,258 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:36:37,258 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:36:37,258 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:36:37,403 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:36:37,403 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:36:38,370 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:36:38,370 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:36:38,370 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:11,923 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:37:11,923 - INFO - app.core.security - Redis connection closed.
2025-06-29 23:37:13,946 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-29 23:37:13,946 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-29 23:37:13,950 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-29 23:37:13,950 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-29 23:37:13,955 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-29 23:37:13,955 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-29 23:37:13,955 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-29 23:37:13,955 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 7, 12, 13, 955721), 'iat': datetime.datetime(2025, 6, 30, 6, 37, 13, 955723)}
2025-06-29 23:37:13,956 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-29 23:37:15,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:37:15,385 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:37:15,385 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:17,724 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:37:17,724 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:37:17,725 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:17,725 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY2NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.TZ7rf64aKjUmx0iiaeYAnwjTENcmDAJVA_Mud8o-NMw
2025-06-29 23:37:17,726 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImRlbW8iLCJhY2NvdW50X251bWJlciI6IlVQUUtJIiwiZXhwIjoxNzUxMjY2NTk0LCJpYXQiOjE3NTEyNjQ3OTR9.TZ7rf64aKjUmx0iiaeYAnwjTENcmDAJVA_Mud8o-NMw
2025-06-29 23:37:38,254 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:37:38,254 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:37:38,255 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:38,255 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:38,255 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:37:38,264 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:37:38,264 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:37:40,120 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-29 23:37:40,120 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-29 23:37:40,120 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:40,120 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'demo', 'account_number': 'UPQKI', 'exp': 1751266594, 'iat': 1751264794}
2025-06-29 23:37:40,120 - INFO - app.core.security - Looking up demo user with ID: 10
2025-06-29 23:37:40,127 - INFO - app.core.security - Found demo user - ID: 10, Type: demo
2025-06-29 23:37:40,128 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: demo, Class: DemoUser
2025-06-29 23:37:50,881 - INFO - app.core.security - Closing Redis connection...
2025-06-29 23:37:50,882 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:09:17,034 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:09:17,035 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:09:17,044 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:09:17,044 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:09:17,053 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:09:17,053 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:09:17,053 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:09:17,053 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 44, 17, 53285), 'iat': datetime.datetime(2025, 6, 30, 10, 9, 17, 53289)}
2025-06-30 03:09:17,053 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:09:21,614 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:09:21,614 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:09:21,615 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:09:24,421 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:09:24,422 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:12:07,652 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:12:07,652 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:12:07,657 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:12:07,657 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:12:07,663 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:12:07,664 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:12:07,664 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:12:07,664 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 47, 7, 663952), 'iat': datetime.datetime(2025, 6, 30, 10, 12, 7, 663957)}
2025-06-30 03:12:07,664 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:12:09,631 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:12:09,631 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:12:09,632 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:12:13,358 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:12:13,358 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:15:03,223 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:15:03,223 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:15:03,226 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:15:03,226 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:15:03,230 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:15:03,230 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:15:03,231 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:15:03,231 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 50, 3, 230913), 'iat': datetime.datetime(2025, 6, 30, 10, 15, 3, 230917)}
2025-06-30 03:15:03,231 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:15:05,129 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:15:05,129 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:15:05,130 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:15:06,826 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:15:06,826 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:15:06,826 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:15:06,827 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:15:06,827 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:15:06,841 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:15:06,842 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:15:18,495 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:15:18,497 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:16:56,590 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:16:56,590 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:16:56,593 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:16:56,593 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:16:56,599 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:16:56,600 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:16:56,600 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:16:56,600 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 51, 56, 599923), 'iat': datetime.datetime(2025, 6, 30, 10, 16, 56, 599928)}
2025-06-30 03:16:56,600 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:18:08,451 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:18:08,452 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:18:12,334 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:18:12,334 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:18:12,338 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:18:12,339 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:18:12,344 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:18:12,344 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:18:12,344 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:18:12,344 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 53, 12, 344260), 'iat': datetime.datetime(2025, 6, 30, 10, 18, 12, 344266)}
2025-06-30 03:18:12,345 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:18:49,639 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:18:49,641 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:18:55,731 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:18:55,731 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:18:55,735 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:18:55,736 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:18:55,740 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:18:55,740 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:18:55,740 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:18:55,741 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 53, 55, 740872), 'iat': datetime.datetime(2025, 6, 30, 10, 18, 55, 740875)}
2025-06-30 03:18:55,741 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:19:33,375 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:19:33,377 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:20:51,140 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:20:51,140 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:20:51,144 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:20:51,144 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:20:51,148 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:20:51,148 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:20:51,149 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:20:51,149 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 10, 55, 51, 148915), 'iat': datetime.datetime(2025, 6, 30, 10, 20, 51, 148919)}
2025-06-30 03:20:51,149 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:21:33,717 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,718 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,718 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,719 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,719 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:33,722 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:33,722 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:33,743 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,744 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,744 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,744 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyNzg5MDMsImlhdCI6MTc1MTI3NzEwM30.7N8ihtaJZm5ZqIZBpgn5J56mNN36n3A_uJhAX_45Txw
2025-06-30 03:21:33,745 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyNzg5MDMsImlhdCI6MTc1MTI3NzEwM30.7N8ihtaJZm5ZqIZBpgn5J56mNN36n3A_uJhAX_45Txw
2025-06-30 03:21:33,761 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,761 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,761 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,761 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,761 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:33,765 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:33,766 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:33,823 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,823 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,825 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,835 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,836 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,837 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,837 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,838 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:33,888 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:33,889 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:33,913 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,913 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,914 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,914 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,914 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:33,918 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:33,918 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:33,946 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,946 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,947 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,947 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,947 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:33,953 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:33,953 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:33,992 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:33,992 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:33,993 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,993 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:33,993 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:34,001 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:34,002 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:34,032 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:34,033 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:34,033 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:34,033 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:34,033 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:34,039 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:34,039 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:21:36,853 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:21:36,853 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:21:36,854 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:36,854 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751278903, 'iat': 1751277103}
2025-06-30 03:21:36,854 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:21:36,858 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:21:36,858 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:18,307 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:18,307 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:18,308 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 03:22:18,492 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:18,492 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:18,493 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 03:22:18,497 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 03:22:31,196 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:22:31,197 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:22:31,197 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:22:31,197 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 30, 10, 52, 31, 196175), 'iat': datetime.datetime(2025, 6, 30, 10, 22, 31, 196259)}
2025-06-30 03:22:31,199 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:22:31,200 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE4ODM3NTEsImlhdCI6MTc1MTI3ODk1MX0.pacNe5osQIpSmhN_r7qeka1nsmPKH3_FCUK62R1-h0Q, Expiry (seconds): 604800
2025-06-30 03:22:31,204 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 03:22:32,433 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:32,434 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:32,434 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,435 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,435 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:22:32,435 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:32,435 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:32,436 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,436 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,436 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:22:32,443 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:22:32,443 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:32,443 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:32,465 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:32,465 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:32,466 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,466 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,467 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:22:32,467 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:32,467 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:32,468 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,468 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,468 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:22:32,475 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:22:32,476 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:32,476 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:32,485 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:32,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:32,486 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,487 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,487 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:22:32,495 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:22:32,496 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:32,665 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:32,665 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:32,667 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,668 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:32,668 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:22:32,684 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:22:32,684 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:33,085 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:33,085 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:33,087 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:33,087 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:33,088 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:22:33,100 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:22:33,101 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:33,760 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:33,760 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:33,761 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:33,761 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:22:33,762 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:22:33,770 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:22:33,770 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:22:33,791 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:22:33,791 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:22:33,792 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:23:48,864 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:23:48,864 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:23:48,864 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:23:48,864 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:23:48,864 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:23:48,868 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:23:48,868 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:25:07,002 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:25:07,002 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:25:07,002 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:25:07,003 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:25:07,003 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:25:07,005 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:25:07,006 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:25:13,342 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:25:13,344 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:25:17,822 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:25:17,823 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:25:17,829 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:25:17,830 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:25:17,836 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:25:17,836 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:25:17,836 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:25:17,836 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 0, 17, 836691), 'iat': datetime.datetime(2025, 6, 30, 10, 25, 17, 836696)}
2025-06-30 03:25:17,837 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:25:19,798 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:25:19,799 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:25:19,799 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:25:24,689 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:25:24,690 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:25:28,941 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:25:28,942 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:25:28,947 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:25:28,947 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:25:28,955 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:25:28,955 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:25:28,955 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:25:28,955 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 0, 28, 955146), 'iat': datetime.datetime(2025, 6, 30, 10, 25, 28, 955150)}
2025-06-30 03:25:28,956 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:25:30,566 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:25:30,566 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:25:30,567 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:27:48,674 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:27:48,675 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:27:48,679 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:27:48,679 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:27:48,689 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:27:48,689 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:27:48,689 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:27:48,689 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 2, 48, 689090), 'iat': datetime.datetime(2025, 6, 30, 10, 27, 48, 689097)}
2025-06-30 03:27:48,690 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:27:53,602 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:27:53,602 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:27:53,602 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:27:55,834 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:27:55,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:27:55,834 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:27:55,834 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODA3NTEsImlhdCI6MTc1MTI3ODk1MX0.wZJ0o1ETvDGfCzbXRRa4S60EOKxmSItXQPM2w2w8YKg
2025-06-30 03:27:55,835 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODA3NTEsImlhdCI6MTc1MTI3ODk1MX0.wZJ0o1ETvDGfCzbXRRa4S60EOKxmSItXQPM2w2w8YKg
2025-06-30 03:28:05,329 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:28:05,329 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:28:05,330 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:28:05,330 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODA3NTEsImlhdCI6MTc1MTI3ODk1MX0.wZJ0o1ETvDGfCzbXRRa4S60EOKxmSItXQPM2w2w8YKg
2025-06-30 03:28:05,332 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODA3NTEsImlhdCI6MTc1MTI3ODk1MX0.wZJ0o1ETvDGfCzbXRRa4S60EOKxmSItXQPM2w2w8YKg
2025-06-30 03:28:32,283 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:28:32,284 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:41:34,224 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:41:34,225 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:41:34,229 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:41:34,229 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:41:34,236 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:41:34,236 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:41:34,236 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:41:34,236 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 16, 34, 236308), 'iat': datetime.datetime(2025, 6, 30, 10, 41, 34, 236312)}
2025-06-30 03:41:34,237 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:41:39,646 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:39,647 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:39,647 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:41:52,517 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:52,518 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:52,518 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751280751, 'iat': 1751278951}
2025-06-30 03:41:52,518 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODA3NTEsImlhdCI6MTc1MTI3ODk1MX0.wZJ0o1ETvDGfCzbXRRa4S60EOKxmSItXQPM2w2w8YKg
2025-06-30 03:41:52,518 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODA3NTEsImlhdCI6MTc1MTI3ODk1MX0.wZJ0o1ETvDGfCzbXRRa4S60EOKxmSItXQPM2w2w8YKg
2025-06-30 03:41:56,537 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:41:56,537 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:41:56,537 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:41:56,537 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 30, 11, 11, 56, 537116), 'iat': datetime.datetime(2025, 6, 30, 10, 41, 56, 537123)}
2025-06-30 03:41:56,537 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:41:56,538 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE4ODQ5MTYsImlhdCI6MTc1MTI4MDExNn0.eDmFMTxpQhAQCZmjlcF9Yucbaee8maMn9kT-tPQVT_I, Expiry (seconds): 604800
2025-06-30 03:41:56,538 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 03:41:57,604 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,605 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,605 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,605 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,605 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:41:57,605 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,605 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,605 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,605 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,606 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:41:57,613 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:41:57,613 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:57,613 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:57,623 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,624 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,625 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,625 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:41:57,625 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,625 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,625 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,625 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,626 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:41:57,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,630 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,630 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,630 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:41:57,632 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:41:57,633 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:57,633 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:57,636 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:41:57,636 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:57,813 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,813 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,813 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,813 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,813 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:41:57,817 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:41:57,817 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:57,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:57,949 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:57,949 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,949 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:41:57,949 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:41:57,951 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:41:57,951 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:41:58,122 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:41:58,122 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:41:58,122 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:00,063 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:42:00,063 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:42:00,064 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:00,064 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:00,064 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:42:00,073 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:42:00,073 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:42:03,581 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:42:03,581 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:42:03,581 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:03,581 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:03,581 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:42:03,585 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:42:03,585 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:42:09,994 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:42:09,994 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:42:09,995 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:09,995 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:09,995 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:42:09,995 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:42:09,995 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:42:09,995 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:09,995 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:09,995 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:42:09,999 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:42:09,999 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:42:09,999 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:42:10,598 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:42:10,599 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:42:10,599 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:10,599 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:10,599 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:42:10,599 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:42:10,600 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:42:10,600 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:10,600 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:42:10,600 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:42:10,605 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:42:10,606 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:42:10,606 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:42:20,582 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:42:20,583 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:43:17,179 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:43:17,180 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:43:17,184 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:43:17,184 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:43:17,188 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:43:17,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:43:17,188 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:43:17,188 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 18, 17, 188723), 'iat': datetime.datetime(2025, 6, 30, 10, 43, 17, 188731)}
2025-06-30 03:43:17,189 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:43:20,605 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:43:20,606 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:43:20,606 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:43:23,757 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:43:23,757 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:43:23,758 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:43:23,758 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:43:23,759 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:43:27,579 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:43:27,579 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:43:27,579 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:43:27,579 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:43:27,580 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:43:31,071 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:43:31,071 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:43:31,072 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:43:31,072 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:43:31,072 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:43:40,759 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:43:40,760 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:44:21,112 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:44:21,113 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:44:21,117 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:44:21,117 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:44:21,120 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:44:21,120 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:44:21,120 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:44:21,120 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 19, 21, 120122), 'iat': datetime.datetime(2025, 6, 30, 10, 44, 21, 120123)}
2025-06-30 03:44:21,120 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:44:24,615 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:44:24,615 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:44:24,615 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:44:25,858 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:44:25,858 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:44:25,858 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:44:25,858 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:44:25,859 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:44:29,299 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:44:29,299 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:44:29,299 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:44:29,299 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:44:29,299 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:44:29,302 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:44:29,302 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:44:38,131 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:44:38,132 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:58:04,860 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:58:04,860 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:58:04,864 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:58:04,864 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:58:04,871 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:58:04,871 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:58:04,871 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:58:04,871 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 33, 4, 871496), 'iat': datetime.datetime(2025, 6, 30, 10, 58, 4, 871499)}
2025-06-30 03:58:04,871 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:58:07,137 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:07,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:07,138 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:58:09,543 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:09,543 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:09,543 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751281916, 'iat': 1751280116}
2025-06-30 03:58:09,544 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:58:09,544 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODE5MTYsImlhdCI6MTc1MTI4MDExNn0.3_I5Yx6EnWj5YICeO5ry2Tje0Nw-1z_CiVbrQ7ekgew
2025-06-30 03:58:13,829 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:58:13,829 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:58:13,829 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:58:13,829 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 30, 11, 28, 13, 829516), 'iat': datetime.datetime(2025, 6, 30, 10, 58, 13, 829523)}
2025-06-30 03:58:13,830 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:58:13,830 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE4ODU4OTMsImlhdCI6MTc1MTI4MTA5M30.tC1mQFEFGzlRyCKqAdjjyw30RLGuU8z2moF3iu5pzv4, Expiry (seconds): 604800
2025-06-30 03:58:13,832 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 03:58:14,933 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:14,933 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:14,934 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,934 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,934 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:58:14,934 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:14,934 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:14,934 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,935 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,935 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:14,939 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:14,939 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:14,939 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:14,944 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:14,945 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:14,945 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,945 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,945 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 03:58:14,945 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:14,945 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:14,946 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,946 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,946 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:14,951 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:14,951 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:14,952 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:14,955 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:14,955 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:14,956 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,956 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:14,956 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:14,961 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:14,961 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:15,206 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:15,207 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:15,207 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:15,207 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:15,207 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:15,211 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:15,211 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:15,244 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:15,245 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:15,245 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:15,245 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:15,245 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:15,262 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:15,262 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:15,465 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:15,465 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:15,466 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:15,466 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:15,466 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:15,471 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:15,471 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:15,517 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:15,517 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:15,518 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:26,965 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:58:26,966 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:58:26,966 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:26,967 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:58:26,967 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:58:26,970 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:58:26,971 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:58:45,556 - INFO - app.core.security - Closing Redis connection...
2025-06-30 03:58:45,558 - INFO - app.core.security - Redis connection closed.
2025-06-30 03:59:45,600 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 03:59:45,600 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 03:59:45,605 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 03:59:45,605 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 03:59:45,612 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 03:59:45,612 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 03:59:45,612 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 03:59:45,612 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 34, 45, 612486), 'iat': datetime.datetime(2025, 6, 30, 10, 59, 45, 612489)}
2025-06-30 03:59:45,612 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 03:59:47,201 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:59:47,201 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:59:47,201 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:47,201 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 03:59:47,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:59:47,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:59:47,202 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:47,204 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 03:59:53,472 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:59:53,473 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:59:53,473 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:53,473 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:53,474 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:59:53,480 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:59:53,480 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:59:57,032 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:59:57,032 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:59:57,033 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:57,033 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:57,033 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:59:57,037 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:59:57,037 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 03:59:59,378 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 03:59:59,378 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 03:59:59,379 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:59,379 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 03:59:59,379 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 03:59:59,383 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 03:59:59,383 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:00:33,343 - INFO - app.core.security - Closing Redis connection...
2025-06-30 04:00:33,343 - INFO - app.core.security - Redis connection closed.
2025-06-30 04:02:15,690 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 04:02:15,690 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 04:02:15,693 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 04:02:15,693 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 04:02:15,696 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 04:02:15,696 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 04:02:15,696 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 04:02:15,696 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 37, 15, 696499), 'iat': datetime.datetime(2025, 6, 30, 11, 2, 15, 696501)}
2025-06-30 04:02:15,696 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 04:02:20,915 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:20,916 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:20,916 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:20,916 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:20,916 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:02:20,916 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:20,916 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:20,917 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:20,917 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:20,917 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:02:20,930 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:02:20,930 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:20,930 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:21,600 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:21,600 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:21,601 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:21,601 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:21,601 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:02:21,601 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:21,601 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:21,602 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:21,602 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:21,602 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:02:21,608 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:02:21,608 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:21,608 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:21,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:21,949 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:21,950 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,207 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:22,207 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:22,208 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,208 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,208 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:02:22,208 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:22,208 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:22,209 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,209 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,209 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:02:22,227 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:02:22,227 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:22,227 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:22,861 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:22,861 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:22,862 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,862 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,862 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:02:22,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:22,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:22,863 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,864 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:22,864 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:02:22,875 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:02:22,876 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:22,876 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:02:59,695 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:02:59,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:02:59,696 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:02:59,696 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 04:02:59,698 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 04:03:04,017 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:04,017 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:04,017 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,017 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,017 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:03:04,017 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:04,018 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:04,018 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,018 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,018 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:04,021 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:04,021 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:04,021 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:04,039 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:04,040 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:04,040 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,040 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,040 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:03:04,040 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:04,040 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:04,041 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,041 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:04,041 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:04,046 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:04,046 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:04,046 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:12,841 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:12,842 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:12,842 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:12,842 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 04:03:12,846 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 04:03:22,387 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:22,387 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:22,388 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:22,388 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:22,388 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:22,396 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:22,397 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:26,403 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:26,404 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:26,404 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:26,405 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:26,405 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:26,411 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:26,411 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:29,315 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:29,315 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:29,316 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:29,316 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:29,316 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:29,322 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:29,322 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:35,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:35,385 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:35,386 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:35,386 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:35,386 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:03:35,386 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:35,386 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:35,386 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:35,386 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:35,386 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:35,391 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:35,392 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:35,392 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:40,375 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:40,375 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:40,376 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:40,376 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:40,377 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:03:40,377 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:40,377 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:40,377 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:40,377 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:40,377 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:40,382 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:40,382 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:40,382 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:42,887 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:42,887 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:42,888 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:42,888 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:42,888 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:03:42,888 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:42,888 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:42,888 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:42,889 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:42,889 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:42,892 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:42,892 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:42,892 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:53,882 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:53,882 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:53,883 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:53,883 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:53,883 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:53,888 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:53,889 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:56,773 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:56,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:56,774 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:56,774 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:56,774 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:56,779 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:56,779 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:03:59,693 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:03:59,693 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:03:59,694 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:59,694 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:03:59,694 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:03:59,701 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:03:59,701 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:04:13,948 - INFO - app.core.security - Closing Redis connection...
2025-06-30 04:04:13,948 - INFO - app.core.security - Redis connection closed.
2025-06-30 04:04:15,942 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 04:04:15,942 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 04:04:15,945 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 04:04:15,945 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 04:04:15,948 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 04:04:15,948 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 04:04:15,948 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 04:04:15,948 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 39, 15, 948296), 'iat': datetime.datetime(2025, 6, 30, 11, 4, 15, 948298)}
2025-06-30 04:04:15,948 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 04:04:19,611 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:04:19,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:04:19,612 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:04:27,674 - INFO - app.core.security - Closing Redis connection...
2025-06-30 04:04:27,675 - INFO - app.core.security - Redis connection closed.
2025-06-30 04:17:30,358 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 04:17:30,358 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 04:17:30,361 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 04:17:30,361 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 04:17:30,368 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 04:17:30,368 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 04:17:30,368 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 04:17:30,368 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 52, 30, 368877), 'iat': datetime.datetime(2025, 6, 30, 11, 17, 30, 368879)}
2025-06-30 04:17:30,369 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 04:17:32,296 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:32,296 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:32,297 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:17:32,297 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 04:17:32,298 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODI4OTMsImlhdCI6MTc1MTI4MTA5M30.qENmWLHwzn7iVxVbR6tSR-91hrx0GSRBqTdGAL2RsD8
2025-06-30 04:17:33,969 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:33,969 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:33,970 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751282893, 'iat': 1751281093}
2025-06-30 04:17:37,492 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 04:17:37,492 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 04:17:37,492 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 04:17:37,492 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 6, 30, 11, 47, 37, 492308), 'iat': datetime.datetime(2025, 6, 30, 11, 17, 37, 492318)}
2025-06-30 04:17:37,493 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 04:17:37,493 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE4ODcwNTcsImlhdCI6MTc1MTI4MjI1N30.n3Lsq3ifbl0jCqu10AB1rPD0ouNXeX--HIIDRXrjvEo, Expiry (seconds): 604800
2025-06-30 04:17:37,503 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 04:17:38,767 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:38,767 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:38,767 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,767 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,767 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:17:38,767 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:38,768 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:38,768 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,768 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,768 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:38,772 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:38,772 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:38,772 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:38,783 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:38,783 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:38,784 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,784 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,784 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:17:38,784 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:38,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:38,784 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,785 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,785 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:38,791 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:38,791 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:38,791 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:38,795 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:38,796 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:38,796 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,796 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:38,796 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:38,814 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:38,814 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:39,071 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:39,071 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:39,072 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:39,072 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:39,072 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:39,075 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:39,076 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:39,299 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:39,300 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:39,300 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:39,300 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:39,300 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:39,304 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:39,304 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:39,386 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:39,386 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:39,386 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:41,046 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:41,047 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:41,047 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:41,047 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:41,047 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:41,057 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:41,057 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:46,665 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:46,665 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:46,666 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:46,666 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:46,667 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:46,676 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:46,676 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:17:53,467 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:17:53,469 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:17:53,471 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:53,471 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:17:53,471 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:17:53,476 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:17:53,476 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:18:15,659 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:18:15,659 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:18:15,659 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:18:15,659 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:18:15,660 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:18:15,662 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:18:15,663 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:18:39,306 - INFO - app.core.security - Closing Redis connection...
2025-06-30 04:18:39,307 - INFO - app.core.security - Redis connection closed.
2025-06-30 04:20:57,896 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 04:20:57,897 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 04:20:57,900 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 04:20:57,900 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 04:20:57,903 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 04:20:57,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 04:20:57,903 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 04:20:57,903 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 11, 55, 57, 903693), 'iat': datetime.datetime(2025, 6, 30, 11, 20, 57, 903695)}
2025-06-30 04:20:57,904 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 04:20:59,790 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:20:59,790 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:20:59,791 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:20:59,791 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODQwNTcsImlhdCI6MTc1MTI4MjI1N30.8Dwq_4ZjIdskMI2vG43ByUyCtT3nLcYkYGW6360E_xA
2025-06-30 04:20:59,792 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODQwNTcsImlhdCI6MTc1MTI4MjI1N30.8Dwq_4ZjIdskMI2vG43ByUyCtT3nLcYkYGW6360E_xA
2025-06-30 04:20:59,799 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:20:59,799 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:20:59,800 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:06,231 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:06,231 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:06,231 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:06,231 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:06,231 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:21:06,243 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:21:06,243 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:11,005 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:11,006 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:11,006 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:11,006 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:11,006 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:21:11,006 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:11,007 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:11,007 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:11,007 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:11,007 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:21:11,020 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:21:11,021 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:11,021 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:13,633 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:13,633 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:13,633 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:13,634 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:13,634 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 04:21:13,634 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:13,634 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:13,634 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:13,634 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:13,634 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:21:13,642 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:21:13,643 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:13,643 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:19,918 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:19,918 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:19,919 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:19,919 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:19,919 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:21:19,926 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:21:19,926 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:24,452 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:24,453 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:24,453 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:24,453 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:24,453 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:21:24,461 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:21:24,461 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:34,316 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:34,316 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:34,317 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:34,317 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:34,317 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 04:21:34,324 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 04:21:34,325 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 04:21:46,993 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 04:21:46,994 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 04:21:46,994 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751284057, 'iat': 1751282257}
2025-06-30 04:21:46,994 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODQwNTcsImlhdCI6MTc1MTI4MjI1N30.8Dwq_4ZjIdskMI2vG43ByUyCtT3nLcYkYGW6360E_xA
2025-06-30 04:21:46,996 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEyODQwNTcsImlhdCI6MTc1MTI4MjI1N30.8Dwq_4ZjIdskMI2vG43ByUyCtT3nLcYkYGW6360E_xA
2025-06-30 04:22:22,123 - INFO - app.core.security - Closing Redis connection...
2025-06-30 04:22:22,123 - INFO - app.core.security - Redis connection closed.
2025-06-30 05:26:11,842 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 05:26:11,842 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 05:26:11,846 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 05:26:11,846 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 05:26:11,852 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:26:11,852 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:26:11,852 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:26:11,852 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 1, 11, 852541), 'iat': datetime.datetime(2025, 6, 30, 12, 26, 11, 852543)}
2025-06-30 05:26:11,857 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:26:14,075 - INFO - app.core.security - Closing Redis connection...
2025-06-30 05:26:14,075 - INFO - app.core.security - Redis connection closed.
2025-06-30 05:26:23,129 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 05:26:23,129 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 05:26:23,135 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 05:26:23,135 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 05:26:23,140 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:26:23,140 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:26:23,140 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:26:23,140 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 1, 23, 140353), 'iat': datetime.datetime(2025, 6, 30, 12, 26, 23, 140355)}
2025-06-30 05:26:23,140 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:26:29,631 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:29,631 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:29,632 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:30,599 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:30,599 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:30,599 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:30,600 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:26:31,687 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:31,687 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:31,687 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:31,688 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:26:35,606 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:35,607 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:35,607 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:38,300 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:38,300 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:38,301 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:38,301 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:26:41,625 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:41,625 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:41,625 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:47,615 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:47,615 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:47,615 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:52,598 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:52,598 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:52,598 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:52,599 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:26:53,605 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:53,605 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:53,605 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:26:59,624 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:26:59,624 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:26:59,625 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:03,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:03,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:03,291 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:03,292 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:05,619 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:05,619 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:05,619 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:11,612 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:11,612 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:11,613 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:11,613 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:11,616 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:11,616 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:11,616 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:17,604 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:17,604 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:17,604 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:23,816 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:23,816 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:23,816 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:29,625 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:29,625 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:29,625 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:35,651 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:35,651 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:35,651 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:41,653 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:41,653 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:41,654 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:44,295 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:44,295 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:44,296 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:44,297 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:47,746 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:47,746 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:47,746 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:48,296 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:48,296 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:48,296 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:48,297 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:48,688 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:48,688 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:48,688 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:48,689 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:49,284 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:49,284 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:49,284 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:49,285 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:53,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:53,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:53,290 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:53,292 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:27:53,614 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:53,614 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:53,614 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:27:59,607 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:27:59,608 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:27:59,608 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:05,617 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:05,617 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:05,617 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:10,613 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:10,613 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:10,614 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:10,614 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:28:11,615 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:11,615 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:11,615 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:17,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:17,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:17,623 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:18,288 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:18,288 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:18,288 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:18,290 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:28:23,783 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:23,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:23,784 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:29,604 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:29,604 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:29,604 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:29,606 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:28:29,653 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:29,654 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:29,654 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:35,623 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:35,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:35,623 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:41,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:41,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:41,630 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:47,683 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:47,683 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:47,683 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:53,634 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:53,635 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:53,635 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:59,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:59,292 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:59,292 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:28:59,294 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:28:59,657 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:28:59,658 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:28:59,658 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:04,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:04,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:04,292 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:04,293 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:05,674 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:05,675 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:05,675 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:05,691 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:05,692 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:05,692 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:05,694 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:10,287 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:10,287 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:10,287 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:10,289 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:11,617 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:11,617 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:11,617 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:16,773 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:16,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:16,773 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:16,774 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:16,781 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:16,781 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:16,782 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:16,954 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:16,954 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:16,955 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:22,655 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:22,655 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:22,656 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:26,297 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:26,297 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:26,298 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:26,300 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:28,619 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:28,620 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:28,620 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:34,620 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:34,620 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:34,621 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:36,626 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:36,627 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:36,627 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:36,635 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:40,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:40,622 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:40,622 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:44,617 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:44,617 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:44,618 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:44,620 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:29:46,613 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:46,614 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:46,614 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:52,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:52,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:52,630 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:29:58,623 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:29:58,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:29:58,626 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:04,611 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:04,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:04,612 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:10,643 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:10,643 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:10,644 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:16,597 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:16,598 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:16,599 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:16,601 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:30:16,618 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:16,619 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:16,619 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:19,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:19,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:19,292 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:19,295 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:30:21,707 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:21,708 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:21,708 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:21,711 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:30:22,632 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:22,633 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:22,633 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:28,297 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:28,297 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:28,298 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:28,300 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:30:28,627 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:28,627 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:28,628 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:34,648 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:34,649 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:34,649 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:40,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:40,622 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:40,623 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:42,599 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:42,599 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:42,601 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:42,603 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:30:46,623 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:46,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:46,623 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:51,588 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:51,588 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:51,588 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:51,590 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:30:52,638 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:52,638 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:52,639 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:58,616 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:58,616 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:58,617 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:59,603 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:30:59,603 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:30:59,604 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:30:59,605 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:31:04,608 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:04,608 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:04,609 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:10,660 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:10,661 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:10,661 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:16,684 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:16,684 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:16,685 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:21,609 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:21,609 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:21,609 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:21,611 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:31:22,627 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:22,628 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:22,629 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:28,628 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:28,628 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:28,629 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:30,637 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:30,637 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:30,637 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:30,639 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:31:34,770 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:34,771 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:34,771 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:35,291 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:35,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:35,291 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:35,292 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:31:39,461 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:39,461 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:39,462 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:39,463 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:31:40,828 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:40,828 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:40,829 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:44,285 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:44,285 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:44,286 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:44,286 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:31:46,610 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:46,610 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:46,610 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:52,605 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:52,605 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:52,605 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:58,606 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:58,607 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:58,607 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:59,294 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:31:59,295 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:31:59,295 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:31:59,298 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:04,624 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:04,624 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:04,624 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:07,608 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:07,609 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:07,609 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:07,611 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:10,627 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:10,627 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:10,628 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:14,596 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:14,596 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:14,596 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:14,598 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:16,629 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:16,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:16,630 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:22,652 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:22,652 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:22,653 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:28,639 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:28,639 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:28,640 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:34,635 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:34,635 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:34,636 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:40,689 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:40,689 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:40,689 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:45,601 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:45,601 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:45,602 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:45,603 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:46,681 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:46,681 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:46,681 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:51,300 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:51,301 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:51,301 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:51,302 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:52,712 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:52,712 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:52,712 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:55,937 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:55,937 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:55,938 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:55,939 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:56,286 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:56,287 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:56,287 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:32:56,288 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:32:59,713 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:32:59,713 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:32:59,713 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:00,296 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:00,296 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:00,297 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:00,298 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:05,606 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:05,607 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:05,607 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:11,655 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:11,655 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:11,656 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:15,602 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:15,602 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:15,603 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:15,605 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:17,657 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:17,658 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:17,658 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:23,638 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:23,638 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:23,638 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,428 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,428 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,428 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,429 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:24,440 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,441 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,441 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,442 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:24,455 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,456 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,456 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,457 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:24,467 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,467 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,468 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,469 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:24,479 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,479 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,480 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,481 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:24,488 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,489 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,489 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,491 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:24,504 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:24,504 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:24,504 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 05:33:24,505 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 05:33:32,713 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:33:32,713 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:33:32,713 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:33:32,713 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 30, 13, 3, 32, 713218), 'iat': datetime.datetime(2025, 6, 30, 12, 33, 32, 713222)}
2025-06-30 05:33:32,713 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:33:32,713 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE4OTE2MTIsImlhdCI6MTc1MTI4NjgxMn0.olIogoWFAl1IuD11BFWa6RNtA1MCy-53wW4Uezuvz4c, Expiry (seconds): 604800
2025-06-30 05:33:32,717 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-30 05:33:33,808 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:33,808 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:33,808 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,808 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,808 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:33:33,808 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:33,808 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:33,808 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,808 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,808 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:33,811 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:33,811 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:33,812 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:33,818 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:33,819 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:33,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,819 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,819 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:33:33,819 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:33,819 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:33,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,819 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,819 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:33,822 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:33,822 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:33,822 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:33,834 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:33,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:33,834 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,834 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,834 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:33,837 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:33,837 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:33,934 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:33,934 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:33,934 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,934 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:33,934 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:33,937 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:33,937 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:34,023 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:34,024 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:34,024 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:34,024 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:34,024 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:34,025 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:34,026 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:34,085 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:34,085 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:34,086 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:34,086 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:34,086 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:34,091 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:34,091 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:34,250 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:34,250 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:34,250 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:35,232 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:35,232 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:35,232 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:35,232 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:35,232 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:35,237 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:35,237 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:50,719 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:50,720 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:50,720 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:50,720 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:50,720 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:50,722 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:50,722 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:50,802 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:50,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:50,802 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:50,802 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:50,802 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:50,804 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:50,804 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:50,897 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:50,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:50,897 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:50,897 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:50,897 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:50,899 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:50,899 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:33:51,120 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:51,120 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:51,120 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:53,043 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:33:53,043 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:33:53,043 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:53,043 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:33:53,043 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:33:53,045 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:33:53,045 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,581 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,581 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,582 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,582 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,582 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:34:06,582 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,582 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,582 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,582 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,582 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:06,584 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:06,584 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,584 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,586 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,587 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,587 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,587 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,587 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:34:06,587 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,587 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,587 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,587 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,587 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:06,589 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:06,589 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,589 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,611 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,611 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,611 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,611 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:06,613 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:06,613 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,679 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,679 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,679 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,679 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,679 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:06,680 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:06,680 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,754 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,754 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,754 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,754 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:06,754 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:06,756 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:06,756 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:06,998 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:06,998 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:06,998 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,115 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:07,115 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:07,115 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,115 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,115 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:07,117 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:07,117 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:07,991 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:07,992 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:07,992 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,992 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,992 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:34:07,992 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:07,992 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:07,992 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,992 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,992 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:07,994 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:07,994 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:07,994 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:07,999 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:07,999 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:07,999 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,999 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:07,999 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:34:07,999 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:07,999 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:08,000 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,000 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,000 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:08,003 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:08,004 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:08,004 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:08,005 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:08,005 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:08,005 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,005 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,005 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:08,008 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:08,008 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:08,092 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:08,092 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:08,092 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,092 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,092 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:08,095 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:08,095 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:08,118 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:08,118 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:08,118 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,119 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,119 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:08,122 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:08,123 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:08,368 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:08,368 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:08,368 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,368 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:08,368 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:08,371 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:08,372 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:08,403 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:08,403 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:08,403 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:12,075 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:34:12,075 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:34:12,075 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:12,075 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:34:12,075 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:34:12,078 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:34:12,078 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:34:41,250 - WARNING - app.core.security - Access token is missing.
2025-06-30 05:35:35,709 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:35:35,709 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:35:35,709 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:35:35,710 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:35:35,710 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:35:35,713 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:35:35,713 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:38:36,837 - INFO - app.core.security - Closing Redis connection...
2025-06-30 05:38:36,838 - INFO - app.core.security - Redis connection closed.
2025-06-30 05:38:39,686 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 05:38:39,686 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 05:38:39,716 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 05:38:39,716 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 05:38:39,723 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:38:39,723 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:38:39,723 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:38:39,723 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 13, 39, 723125), 'iat': datetime.datetime(2025, 6, 30, 12, 38, 39, 723128)}
2025-06-30 05:38:39,723 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:38:57,767 - INFO - app.core.security - Closing Redis connection...
2025-06-30 05:38:57,767 - INFO - app.core.security - Redis connection closed.
2025-06-30 05:38:59,716 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 05:38:59,716 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 05:38:59,719 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 05:38:59,719 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 05:38:59,722 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:38:59,722 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:38:59,722 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:38:59,722 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 13, 59, 722508), 'iat': datetime.datetime(2025, 6, 30, 12, 38, 59, 722511)}
2025-06-30 05:38:59,722 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:39:03,269 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:39:03,269 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:39:03,270 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:39:03,270 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:39:03,270 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:39:03,281 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:39:03,281 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:39:19,030 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:39:19,030 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:39:19,030 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:39:19,030 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:39:19,031 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:39:19,036 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:39:19,037 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:43:55,294 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:43:55,294 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:43:55,295 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:43:55,295 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751288612, 'iat': 1751286812}
2025-06-30 05:43:55,295 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:43:55,300 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:43:55,300 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:49:49,371 - INFO - app.core.security - Closing Redis connection...
2025-06-30 05:49:49,372 - INFO - app.core.security - Redis connection closed.
2025-06-30 05:56:14,549 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 05:56:14,550 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 05:56:14,554 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 05:56:14,554 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 05:56:14,558 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:56:14,558 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:56:14,558 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:56:14,558 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 31, 14, 558602), 'iat': datetime.datetime(2025, 6, 30, 12, 56, 14, 558604)}
2025-06-30 05:56:14,559 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:56:19,929 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 05:56:19,930 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 05:56:19,930 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 05:56:19,930 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 30, 13, 26, 19, 929588), 'iat': datetime.datetime(2025, 6, 30, 12, 56, 19, 929606)}
2025-06-30 05:56:19,931 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 05:56:19,932 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE4OTI5NzksImlhdCI6MTc1MTI4ODE3OX0.VM3n-D9ue1RNX-JrZ0S4S9shmNZWyHAAO6_YmsDcMVs, Expiry (seconds): 604800
2025-06-30 05:56:19,936 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-30 05:56:21,027 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,027 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,027 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,027 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,027 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:56:21,028 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,028 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,028 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,028 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,028 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:21,033 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:21,034 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,034 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,044 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,044 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,045 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,045 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,045 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 05:56:21,045 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,045 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,045 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,045 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,046 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:21,050 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:21,050 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,051 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,052 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,052 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,053 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,053 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,053 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:21,068 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:21,069 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,228 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,228 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,229 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,229 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,229 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:21,236 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:21,236 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,448 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,448 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,449 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,449 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,449 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:21,456 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:21,456 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,697 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,697 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,698 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,698 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:21,698 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:21,706 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:21,707 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:21,764 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:21,764 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:21,765 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:26,615 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 05:56:26,615 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 05:56:26,615 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:26,615 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751289979, 'iat': 1751288179}
2025-06-30 05:56:26,615 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 05:56:26,620 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 05:56:26,621 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 05:56:48,850 - INFO - app.core.security - Closing Redis connection...
2025-06-30 05:56:48,855 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:15:53,880 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:15:53,881 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:15:53,886 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:15:53,886 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:15:53,898 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:15:53,898 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:15:53,898 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:15:53,898 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 50, 53, 898073), 'iat': datetime.datetime(2025, 6, 30, 13, 15, 53, 898076)}
2025-06-30 06:15:53,898 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:18:05,890 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:18:05,891 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:18:16,106 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:18:16,107 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:18:16,109 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:18:16,109 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:18:16,112 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:18:16,112 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:18:16,112 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:18:16,112 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 53, 16, 112079), 'iat': datetime.datetime(2025, 6, 30, 13, 18, 16, 112082)}
2025-06-30 06:18:16,112 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:19:26,650 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:19:26,650 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:19:29,079 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:19:29,079 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:19:29,082 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:19:29,082 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:19:29,089 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:19:29,089 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:19:29,089 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:19:29,089 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 54, 29, 89091), 'iat': datetime.datetime(2025, 6, 30, 13, 19, 29, 89093)}
2025-06-30 06:19:29,089 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:19:33,559 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:19:33,560 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:19:35,990 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:19:35,990 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:19:36,017 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:19:36,018 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:19:36,022 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:19:36,022 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:19:36,022 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:19:36,022 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 54, 36, 22257), 'iat': datetime.datetime(2025, 6, 30, 13, 19, 36, 22260)}
2025-06-30 06:19:36,022 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:19:38,170 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:19:38,171 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:19:40,592 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:19:40,592 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:19:40,595 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:19:40,595 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:19:40,599 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:19:40,599 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:19:40,599 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:19:40,599 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 54, 40, 599366), 'iat': datetime.datetime(2025, 6, 30, 13, 19, 40, 599368)}
2025-06-30 06:19:40,599 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:23:00,964 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:23:00,965 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:23:03,289 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:23:03,290 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:23:03,302 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:23:03,302 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:23:03,306 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:23:03,306 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:23:03,306 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:23:03,306 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 58, 3, 306478), 'iat': datetime.datetime(2025, 6, 30, 13, 23, 3, 306481)}
2025-06-30 06:23:03,307 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:23:10,180 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:23:10,181 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:23:12,531 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:23:12,531 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:23:12,546 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:23:12,547 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:23:12,550 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:23:12,550 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:23:12,550 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:23:12,550 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 13, 58, 12, 550477), 'iat': datetime.datetime(2025, 6, 30, 13, 23, 12, 550479)}
2025-06-30 06:23:12,550 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:23:54,736 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:23:54,736 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:23:54,737 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:23:54,737 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': datetime.datetime(2025, 6, 30, 13, 53, 54, 736563), 'iat': datetime.datetime(2025, 6, 30, 13, 23, 54, 736571)}
2025-06-30 06:23:54,737 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:23:54,737 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImFkbWluIiwiYWNjb3VudF9udW1iZXIiOiJKUEJaWCIsImV4cCI6MTc1MTg5NDYzNCwiaWF0IjoxNzUxMjg5ODM0fQ.L1QZ-kEEtVNvsTgImE9x6FGFGL5yapYPdJhUGhGGrUU, Expiry (seconds): 604800
2025-06-30 06:23:54,738 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-30 06:26:15,142 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:26:15,142 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:26:15,173 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:26:15,174 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:26:15,174 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:26:15,182 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:26:15,182 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:27:15,878 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:27:15,879 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:27:18,741 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:27:18,741 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:27:18,765 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:27:18,766 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:27:18,773 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:27:18,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:27:18,773 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:27:18,773 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 2, 18, 773464), 'iat': datetime.datetime(2025, 6, 30, 13, 27, 18, 773469)}
2025-06-30 06:27:18,774 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:27:34,266 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:27:34,266 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:27:36,426 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:27:36,426 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:27:36,431 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:27:36,432 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:27:36,435 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:27:36,435 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:27:36,435 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:27:36,435 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 2, 36, 435459), 'iat': datetime.datetime(2025, 6, 30, 13, 27, 36, 435461)}
2025-06-30 06:27:36,435 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:27:41,174 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:27:41,175 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:27:48,286 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:27:48,286 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:27:48,290 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:27:48,290 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:27:48,295 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:27:48,295 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:27:48,295 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:27:48,295 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 2, 48, 295881), 'iat': datetime.datetime(2025, 6, 30, 13, 27, 48, 295884)}
2025-06-30 06:27:48,296 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:27:54,771 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:27:54,772 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:27:54,772 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:27:54,772 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:27:54,773 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:27:54,786 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:27:54,786 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:28:13,285 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:28:13,286 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:28:15,548 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:28:15,548 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:28:15,557 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:28:15,557 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:28:15,561 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:28:15,561 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:28:15,561 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:28:15,561 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 3, 15, 561070), 'iat': datetime.datetime(2025, 6, 30, 13, 28, 15, 561072)}
2025-06-30 06:28:15,561 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:28:19,952 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:28:19,952 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:28:19,953 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:28:19,953 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:28:19,953 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:28:19,964 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:28:19,965 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:30:10,282 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:30:10,284 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:30:12,823 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:30:12,823 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:30:12,828 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:30:12,829 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:30:12,833 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:30:12,833 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:30:12,833 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:30:12,833 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 5, 12, 833749), 'iat': datetime.datetime(2025, 6, 30, 13, 30, 12, 833752)}
2025-06-30 06:30:12,834 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:30:26,293 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:30:26,293 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:30:28,608 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:30:28,608 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:30:28,617 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:30:28,617 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:30:28,620 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:30:28,620 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:30:28,620 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:30:28,620 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 5, 28, 620033), 'iat': datetime.datetime(2025, 6, 30, 13, 30, 28, 620035)}
2025-06-30 06:30:28,620 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:30:33,540 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:30:33,540 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:30:33,540 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:30:33,540 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:30:33,540 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:30:33,552 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:30:33,552 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:30:51,590 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:30:51,590 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:30:53,913 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:30:53,913 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:30:53,918 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:30:53,918 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:30:53,921 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:30:53,921 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:30:53,921 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:30:53,921 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 5, 53, 921237), 'iat': datetime.datetime(2025, 6, 30, 13, 30, 53, 921239)}
2025-06-30 06:30:53,921 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:30:58,911 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:30:58,912 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:30:58,912 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:30:58,912 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:30:58,912 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:30:58,922 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:30:58,922 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:31:07,664 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:31:07,665 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:31:09,961 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:31:09,961 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:31:09,963 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:31:09,964 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:31:09,967 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:31:09,967 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:31:09,967 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:31:09,967 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 6, 9, 967208), 'iat': datetime.datetime(2025, 6, 30, 13, 31, 9, 967211)}
2025-06-30 06:31:09,967 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:31:11,568 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:31:11,568 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:31:11,568 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:31:11,568 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:31:11,568 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:31:11,666 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:31:11,666 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:34:09,827 - WARNING - app.core.security - Access token is missing.
2025-06-30 06:34:27,309 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:34:27,310 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:34:27,310 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:34:27,310 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:34:27,310 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:34:27,314 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:34:27,314 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:35:36,042 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:35:36,043 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:35:38,913 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:35:38,913 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:35:38,919 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:35:38,919 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:35:38,923 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:35:38,923 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:35:38,923 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:35:38,923 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 10, 38, 923497), 'iat': datetime.datetime(2025, 6, 30, 13, 35, 38, 923499)}
2025-06-30 06:35:38,923 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:35:49,776 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:35:49,776 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:35:52,552 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:35:52,552 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:35:52,565 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:35:52,565 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:35:52,568 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:35:52,569 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:35:52,569 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:35:52,569 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 10, 52, 568967), 'iat': datetime.datetime(2025, 6, 30, 13, 35, 52, 568970)}
2025-06-30 06:35:52,569 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:35:54,197 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:35:54,197 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:35:54,197 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:35:54,198 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:35:54,198 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:35:54,312 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:35:54,312 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:36:13,537 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:36:13,538 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:36:19,651 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:36:19,651 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:36:19,655 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:36:19,655 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:36:19,658 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:36:19,658 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:36:19,658 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:36:19,658 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 11, 19, 658609), 'iat': datetime.datetime(2025, 6, 30, 13, 36, 19, 658612)}
2025-06-30 06:36:19,659 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:37:41,303 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:37:41,303 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:37:41,304 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:37:41,304 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:37:41,304 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:37:41,309 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:37:41,309 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:39:17,449 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:39:17,450 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:39:20,253 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:39:20,253 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:39:20,257 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:39:20,257 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:39:20,262 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:39:20,262 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:39:20,262 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:39:20,262 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 14, 20, 262567), 'iat': datetime.datetime(2025, 6, 30, 13, 39, 20, 262569)}
2025-06-30 06:39:20,262 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:39:21,968 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:39:21,969 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:39:21,969 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:39:21,969 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:39:21,969 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:39:22,113 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:39:22,113 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:39:33,413 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:39:33,414 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:39:35,982 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:39:35,982 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:39:35,986 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:39:35,986 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:39:35,989 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:39:35,989 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:39:35,989 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:39:35,989 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 14, 35, 989840), 'iat': datetime.datetime(2025, 6, 30, 13, 39, 35, 989843)}
2025-06-30 06:39:35,990 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:39:37,912 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:39:37,912 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:39:37,912 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:39:37,912 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:39:37,912 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:39:37,921 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:39:37,921 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:40:41,696 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:40:41,696 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:40:44,656 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:40:44,657 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:40:44,662 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:40:44,662 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:40:44,668 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:40:44,668 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:40:44,668 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:40:44,668 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 15, 44, 668468), 'iat': datetime.datetime(2025, 6, 30, 13, 40, 44, 668471)}
2025-06-30 06:40:44,668 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:40:50,814 - INFO - app.core.security - Closing Redis connection...
2025-06-30 06:40:50,815 - INFO - app.core.security - Redis connection closed.
2025-06-30 06:40:53,519 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 06:40:53,519 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 06:40:53,522 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 06:40:53,522 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 06:40:53,525 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 06:40:53,525 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 06:40:53,526 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 06:40:53,526 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 14, 15, 53, 525914), 'iat': datetime.datetime(2025, 6, 30, 13, 40, 53, 525917)}
2025-06-30 06:40:53,526 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 06:40:57,940 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:40:57,940 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:40:57,941 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:40:57,941 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:40:57,941 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:40:57,953 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:40:57,953 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 06:41:10,607 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 06:41:10,607 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 06:41:10,608 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:41:10,608 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751291634, 'iat': 1751289834}
2025-06-30 06:41:10,608 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 06:41:10,611 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 06:41:10,612 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 10:08:56,700 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 10:08:56,700 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 10:08:56,726 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 10:08:56,726 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 10:08:56,735 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 10:08:56,735 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 10:08:56,735 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 10:08:56,735 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 17, 43, 56, 735561), 'iat': datetime.datetime(2025, 6, 30, 17, 8, 56, 735564)}
2025-06-30 10:08:56,736 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 10:09:22,224 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:22,224 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:22,226 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 10:09:22,231 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 10:09:22,248 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:22,248 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:22,248 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 10:09:22,250 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 10:09:22,262 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:22,262 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:22,263 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 10:09:22,265 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 10:09:22,275 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:22,275 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:22,275 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 10:09:22,277 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 10:09:22,286 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:22,286 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:22,286 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 10:09:22,295 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:22,295 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:22,296 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 10:09:26,922 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 10:09:26,923 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 10:09:26,923 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 10:09:26,923 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 30, 17, 39, 26, 922787), 'iat': datetime.datetime(2025, 6, 30, 17, 9, 26, 922804)}
2025-06-30 10:09:26,924 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 10:09:26,924 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5MDgxNjYsImlhdCI6MTc1MTMwMzM2Nn0.LdJC1RHvG8ovE30L4qIdsCeQFn5R-nuh-9eRSWggkMQ, Expiry (seconds): 604800
2025-06-30 10:09:26,929 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-30 10:09:28,032 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,033 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,033 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,033 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,033 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 10:09:28,034 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,034 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,034 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,034 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,034 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:09:28,039 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:09:28,040 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,040 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,049 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,049 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,050 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,050 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,050 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 10:09:28,050 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,050 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,050 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,050 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,050 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:09:28,056 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,056 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,057 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,057 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,057 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:09:28,063 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:09:28,063 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,064 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,077 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:09:28,077 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,379 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,380 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,383 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,383 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,383 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:09:28,394 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:09:28,394 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,396 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,397 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,397 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,397 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,397 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:09:28,411 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:09:28,411 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:09:28,710 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,710 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,711 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,743 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:09:28,743 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:09:28,743 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,743 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:09:28,744 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:09:28,749 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:09:28,749 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:10:43,580 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:10:43,580 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:10:43,581 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:10:43,581 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:10:43,581 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:10:43,585 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:10:43,585 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:11:04,788 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 10:11:04,788 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 10:11:04,788 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 10:11:04,789 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 30, 17, 41, 4, 788643), 'iat': datetime.datetime(2025, 6, 30, 17, 11, 4, 788651)}
2025-06-30 10:11:04,789 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 10:11:04,789 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5MDgyNjQsImlhdCI6MTc1MTMwMzQ2NH0.Lr9BetCnlMtk2-mI8eWlOIWGgwLRwCjzvwhqrFLHn_g, Expiry (seconds): 604800
2025-06-30 10:11:04,791 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-30 10:11:16,658 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:11:16,658 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:11:16,658 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305264, 'iat': 1751303464}
2025-06-30 10:11:16,658 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305264, 'iat': 1751303464}
2025-06-30 10:11:16,658 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:11:16,664 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:11:16,665 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:11:30,241 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:11:30,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:11:30,242 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:11:30,242 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDUxNjYsImlhdCI6MTc1MTMwMzM2Nn0.sior3g7CO7VBiQ7N2MWCA1j1PgpLKGUXm0543oDNK24
2025-06-30 10:11:30,244 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDUxNjYsImlhdCI6MTc1MTMwMzM2Nn0.sior3g7CO7VBiQ7N2MWCA1j1PgpLKGUXm0543oDNK24
2025-06-30 10:11:59,562 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:11:59,562 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:11:59,562 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:11:59,563 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:11:59,563 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:11:59,567 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:11:59,567 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:12:02,526 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 10:12:02,526 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 10:12:02,526 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 10:12:02,526 - DEBUG - app.core.security - Payload to encode: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': datetime.datetime(2025, 6, 30, 17, 42, 2, 526364), 'iat': datetime.datetime(2025, 6, 30, 17, 12, 2, 526373)}
2025-06-30 10:12:02,527 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 10:12:02,527 - INFO - app.core.security - Storing refresh token for user ID 10 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMCIsInVzZXJfdHlwZSI6ImFkbWluIiwiYWNjb3VudF9udW1iZXIiOiJKUEJaWCIsImV4cCI6MTc1MTkwODMyMiwiaWF0IjoxNzUxMzAzNTIyfQ.7ZA6zo6bZJL04fMUoeVc6DUIS6R7Y0Gwpn7hpmlGsHU, Expiry (seconds): 604800
2025-06-30 10:12:02,529 - INFO - app.core.security - Refresh token stored successfully for user ID: 10
2025-06-30 10:12:22,628 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:12:22,628 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:12:22,628 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751305322, 'iat': 1751303522}
2025-06-30 10:12:22,628 - INFO - app.core.security - Token payload in get_current_user: {'sub': '10', 'user_type': 'admin', 'account_number': 'JPBZX', 'exp': 1751305322, 'iat': 1751303522}
2025-06-30 10:12:22,629 - INFO - app.core.security - Looking up live user with ID: 10, Type: admin
2025-06-30 10:12:22,633 - INFO - app.core.security - Found live user - ID: 10, Type: admin
2025-06-30 10:12:22,633 - INFO - app.core.security - Successfully authenticated user - ID: 10, Type: admin, Class: User
2025-06-30 10:12:29,485 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:12:29,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:12:29,486 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305264, 'iat': 1751303464}
2025-06-30 10:12:29,486 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305264, 'iat': 1751303464}
2025-06-30 10:12:29,486 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:12:29,490 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:12:29,490 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:13:00,471 - INFO - app.core.security - Closing Redis connection...
2025-06-30 10:13:00,471 - INFO - app.core.security - Redis connection closed.
2025-06-30 10:25:02,091 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 10:25:02,092 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 10:25:02,096 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 10:25:02,096 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 10:25:02,133 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 10:25:02,133 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 10:25:02,133 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 10:25:02,134 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 18, 0, 2, 133750), 'iat': datetime.datetime(2025, 6, 30, 17, 25, 2, 133754)}
2025-06-30 10:25:02,134 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 10:25:27,064 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:27,064 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:27,065 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,066 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDUxNjYsImlhdCI6MTc1MTMwMzM2Nn0.sior3g7CO7VBiQ7N2MWCA1j1PgpLKGUXm0543oDNK24
2025-06-30 10:25:27,068 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDUxNjYsImlhdCI6MTc1MTMwMzM2Nn0.sior3g7CO7VBiQ7N2MWCA1j1PgpLKGUXm0543oDNK24
2025-06-30 10:25:27,139 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:27,139 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:27,140 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,140 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,144 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:27,157 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:27,158 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:27,239 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:27,240 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:27,242 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,255 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:27,255 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:27,256 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,257 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,257 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:27,330 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:27,330 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:27,370 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:27,371 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:27,371 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,371 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,372 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:27,382 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:27,382 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:27,418 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:27,418 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:27,419 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,420 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,420 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:27,430 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:27,430 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:27,466 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:27,466 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:27,468 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,469 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:27,469 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:27,482 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:27,483 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:28,871 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:28,871 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:28,872 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:28,872 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751305166, 'iat': 1751303366}
2025-06-30 10:25:28,872 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:28,880 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:28,881 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:28,881 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDUxNjYsImlhdCI6MTc1MTMwMzM2Nn0.sior3g7CO7VBiQ7N2MWCA1j1PgpLKGUXm0543oDNK24
2025-06-30 10:25:28,898 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDUxNjYsImlhdCI6MTc1MTMwMzM2Nn0.sior3g7CO7VBiQ7N2MWCA1j1PgpLKGUXm0543oDNK24
2025-06-30 10:25:33,965 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 10:25:33,965 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 10:25:33,965 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 10:25:33,965 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 6, 30, 17, 55, 33, 965229), 'iat': datetime.datetime(2025, 6, 30, 17, 25, 33, 965239)}
2025-06-30 10:25:33,966 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 10:25:33,967 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5MDkxMzMsImlhdCI6MTc1MTMwNDMzM30.C8yynfMSqYRo69U4i4Rrf51TNAd1MPmjpjVZMPfTBMQ, Expiry (seconds): 604800
2025-06-30 10:25:33,972 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-30 10:25:35,267 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:35,267 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:35,268 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,268 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,268 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 10:25:35,268 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:35,268 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:35,269 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,269 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,269 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:35,278 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:35,279 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:35,279 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:35,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:35,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:35,291 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,292 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,292 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 10:25:35,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:35,292 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:35,293 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,293 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,294 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:35,302 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:35,303 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:35,303 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,304 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,304 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:35,308 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:35,308 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:35,309 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:35,316 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:35,317 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:35,656 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:35,657 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:35,657 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,657 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:35,657 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:35,661 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:35,662 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:36,034 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:36,034 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:36,035 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:36,164 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:36,165 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:36,165 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:36,166 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:36,166 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:36,175 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:36,175 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:25:37,812 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:25:37,813 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:25:37,814 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:37,814 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:25:37,815 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:25:37,824 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:25:37,826 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:26:37,149 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:26:37,150 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:26:37,150 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,150 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,150 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 10:26:37,151 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:26:37,151 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:26:37,151 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,152 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,152 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:26:37,160 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:26:37,160 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:26:37,161 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:26:37,173 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:26:37,173 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:26:37,174 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,174 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,174 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:26:37,182 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:26:37,183 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:26:37,212 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:26:37,213 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:26:37,213 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,214 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,214 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 10:26:37,214 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:26:37,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:26:37,214 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,215 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,215 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:26:37,223 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:26:37,223 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:26:37,224 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:26:37,793 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:26:37,793 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:26:37,794 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,794 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,794 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:26:37,802 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:26:37,803 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:26:37,934 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:26:37,934 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:26:37,935 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,936 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:37,937 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:26:37,965 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:26:37,966 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:26:38,137 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:26:38,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:26:38,139 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:38,143 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:26:38,146 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:26:38,189 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:26:38,189 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:26:38,454 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:26:38,455 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:26:38,456 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:27:30,551 - INFO - app.core.security - Closing Redis connection...
2025-06-30 10:27:30,553 - INFO - app.core.security - Redis connection closed.
2025-06-30 10:27:35,238 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 10:27:35,239 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 10:27:35,243 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 10:27:35,243 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 10:27:35,255 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 10:27:35,255 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 10:27:35,256 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 10:27:35,256 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 18, 2, 35, 255578), 'iat': datetime.datetime(2025, 6, 30, 17, 27, 35, 255591)}
2025-06-30 10:27:35,257 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 10:27:37,147 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:27:37,147 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:27:37,147 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:27:53,388 - INFO - app.core.security - Closing Redis connection...
2025-06-30 10:27:53,389 - INFO - app.core.security - Redis connection closed.
2025-06-30 10:27:58,115 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 10:27:58,115 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 10:27:58,119 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 10:27:58,119 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 10:27:58,124 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 10:27:58,124 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 10:27:58,124 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 10:27:58,125 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 6, 30, 18, 2, 58, 124851), 'iat': datetime.datetime(2025, 6, 30, 17, 27, 58, 124854)}
2025-06-30 10:27:58,125 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 10:28:00,342 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:00,346 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:00,348 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:00,349 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:00,349 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:28:00,356 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:00,356 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:00,357 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:00,358 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDYxMzMsImlhdCI6MTc1MTMwNDMzM30.QHroqf2O3_QVoFGqMSvdE1i-66IqCfeoFbOMV56MieU
2025-06-30 10:28:00,360 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:00,361 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:00,362 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:00,387 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDYxMzMsImlhdCI6MTc1MTMwNDMzM30.QHroqf2O3_QVoFGqMSvdE1i-66IqCfeoFbOMV56MieU
2025-06-30 10:28:00,793 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:28:00,794 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:28:05,761 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:05,762 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:05,762 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:05,763 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDYxMzMsImlhdCI6MTc1MTMwNDMzM30.QHroqf2O3_QVoFGqMSvdE1i-66IqCfeoFbOMV56MieU
2025-06-30 10:28:05,765 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTEzMDYxMzMsImlhdCI6MTc1MTMwNDMzM30.QHroqf2O3_QVoFGqMSvdE1i-66IqCfeoFbOMV56MieU
2025-06-30 10:28:09,450 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:09,450 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:09,451 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,452 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,452 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 10:28:09,452 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:09,452 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:09,453 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,453 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,453 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:28:09,467 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:28:09,467 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:28:09,467 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:28:09,515 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:09,516 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:09,516 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,516 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,517 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 10:28:09,517 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:09,517 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:09,517 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,517 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,518 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:28:09,525 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:28:09,525 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:28:09,525 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:28:09,535 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:09,536 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:09,536 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,537 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,537 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:28:09,547 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:28:09,547 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:28:09,843 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:09,843 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:09,844 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,844 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:09,844 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:28:09,857 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:28:09,857 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:28:10,015 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:10,016 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:10,017 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:10,017 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:10,017 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:28:10,025 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:28:10,026 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:28:10,414 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:10,414 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:10,415 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:10,415 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:10,416 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:28:10,425 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:28:10,426 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:28:10,652 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:10,652 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:10,653 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:29,338 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 10:28:29,339 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 10:28:29,340 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:29,340 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751306133, 'iat': 1751304333}
2025-06-30 10:28:29,340 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 10:28:29,347 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 10:28:29,347 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 10:29:00,046 - INFO - app.core.security - Closing Redis connection...
2025-06-30 10:29:00,049 - INFO - app.core.security - Redis connection closed.
2025-06-30 22:56:29,123 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 22:56:29,123 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 22:56:29,130 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 22:56:29,130 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 22:56:29,135 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 22:56:29,135 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 22:56:29,135 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 22:56:29,135 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 6, 31, 29, 135184), 'iat': datetime.datetime(2025, 7, 1, 5, 56, 29, 135186)}
2025-06-30 22:56:29,136 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 22:56:31,283 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:56:31,283 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:56:31,283 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:56:37,230 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:56:37,230 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:56:37,231 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:56:43,208 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:56:43,208 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:56:43,208 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:56:49,208 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:56:49,209 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:56:49,209 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:56:55,208 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:56:55,208 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:56:55,209 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:01,219 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:01,219 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:01,220 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:05,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:05,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:05,214 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:05,216 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:57:07,233 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:07,233 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:07,234 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:13,217 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:13,219 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:13,219 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:14,105 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:14,106 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:14,106 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:14,108 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:57:19,236 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:19,236 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:19,237 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:25,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:25,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:25,203 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:25,204 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:57:25,216 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:25,217 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:25,217 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:31,229 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:31,229 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:31,230 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:32,928 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:32,928 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:32,929 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:32,931 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:57:33,384 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:33,384 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:33,384 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:33,386 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:57:37,214 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:37,215 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:37,215 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:43,236 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:43,237 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:43,237 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:49,225 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:49,225 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:49,226 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:54,147 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:54,148 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:54,148 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:54,148 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:54,148 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:57:54,148 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:54,149 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:54,149 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:54,149 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:54,149 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:57:54,241 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:57:54,241 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:57:54,241 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:57:54,387 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:54,387 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:54,388 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:54,388 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:54,388 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:57:54,388 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:54,388 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:54,389 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:54,389 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:54,389 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:57:54,431 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:54,431 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:54,431 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:54,432 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:54,432 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:57:54,464 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:57:54,464 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:57:54,464 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:57:54,705 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:57:54,706 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:57:55,226 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:55,227 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:55,227 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:57:55,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:55,844 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:55,844 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:55,845 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:55,845 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:57:55,845 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:55,845 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:55,845 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:55,845 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:55,845 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:57:55,943 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:57:55,944 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:57:55,944 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:57:56,094 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:56,094 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:56,095 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:56,095 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:56,095 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:57:56,095 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:56,095 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:56,095 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:56,095 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:56,095 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:57:56,098 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:57:56,098 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:57:56,098 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:56,099 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:57:56,099 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:57:56,191 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:57:56,192 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:57:56,192 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:57:56,319 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:57:56,319 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:00,165 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:00,165 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:00,165 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:00,167 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:00,167 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:00,275 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:00,275 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:01,219 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:01,219 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:01,219 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:06,080 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:06,080 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:06,082 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:06,082 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:06,082 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:06,150 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:06,150 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:07,220 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:07,220 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:07,221 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:09,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:09,979 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:09,980 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:09,980 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:09,980 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:58:09,980 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:09,980 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:09,980 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:09,981 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:09,981 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:10,126 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:10,127 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:10,128 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:10,240 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:10,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:10,241 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:10,242 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:10,242 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:58:10,242 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:10,242 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:10,243 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:10,243 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:10,243 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:10,318 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:10,318 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:10,319 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:10,498 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:10,498 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:10,499 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:10,501 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351195, 'iat': 1751349395}
2025-06-30 22:58:10,501 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:10,585 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:10,586 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:13,224 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:13,224 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:13,224 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:19,251 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:19,251 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:19,252 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:19,813 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:19,813 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:19,814 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:19,814 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:19,814 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:58:19,814 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:19,814 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:19,814 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:19,814 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:19,814 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:20,031 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:20,031 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:20,032 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:20,085 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:20,086 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:20,086 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:20,089 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:58:20,198 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:20,198 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:20,199 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:20,199 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:20,200 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:58:20,200 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:20,200 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:20,200 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:20,201 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:20,201 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:20,205 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:20,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:20,206 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:20,207 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:20,207 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:20,275 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:20,275 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:20,281 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:20,281 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:20,282 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:25,236 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:25,236 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:25,237 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:26,212 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:26,213 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:26,213 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:26,213 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:26,214 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:26,393 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:26,393 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:27,693 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:27,693 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:27,693 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:27,694 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:27,694 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:58:27,694 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:27,694 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:27,694 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:27,694 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:27,694 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:27,964 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:27,965 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:27,965 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:28,151 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:28,151 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:28,152 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:28,152 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:28,152 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:58:28,152 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:28,152 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:28,153 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:28,153 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:28,153 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:28,158 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:28,158 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:28,159 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:28,159 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:28,159 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:28,238 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:28,238 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:28,238 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:28,247 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:28,247 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:31,237 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:31,237 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:31,238 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:32,214 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:32,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:32,215 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:32,217 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:58:34,837 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:34,837 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:34,838 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:34,838 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:34,838 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:34,926 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:34,926 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:36,476 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:36,476 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:36,477 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:36,480 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:58:37,227 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:37,227 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:37,228 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:38,914 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:38,915 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:38,915 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:38,919 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:58:40,739 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:40,739 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:40,739 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:40,740 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:58:40,740 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:58:40,833 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:58:40,833 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:58:43,224 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:43,224 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:43,224 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:49,219 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:49,219 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:49,219 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:49,221 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:58:49,229 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:49,229 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:49,230 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:58:55,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:58:55,213 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:58:55,213 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:01,224 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:01,224 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:01,225 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:07,217 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:07,218 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:07,218 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:13,045 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:13,046 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:13,046 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:13,046 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:13,046 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:13,241 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:13,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:13,242 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:13,301 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:13,302 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:18,056 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:18,056 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:18,057 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:18,057 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:18,057 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:18,126 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:18,126 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:19,235 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:19,235 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:19,236 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:25,257 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:25,258 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:25,258 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:29,276 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:29,277 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:29,277 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:29,277 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:29,277 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:29,349 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:29,350 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:31,241 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:31,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:31,242 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:31,443 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:31,443 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:31,443 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:31,443 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:31,444 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:31,576 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:31,576 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:34,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:34,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:34,904 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:34,905 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:59:37,232 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:37,232 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:37,233 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:40,772 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:40,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:40,773 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:40,775 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:59:43,606 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:43,606 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:43,606 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:45,186 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:45,187 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:45,187 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:45,187 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:45,187 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:59:45,187 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:45,187 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:45,188 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:45,188 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:45,188 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:45,258 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:45,258 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:45,258 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:45,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:45,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:45,290 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:45,291 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:45,291 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:59:45,291 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:45,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:45,291 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:45,292 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:45,292 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:45,371 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:45,371 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:45,371 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:46,134 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:46,134 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:46,135 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:46,135 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:46,135 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:59:46,136 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:46,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:46,139 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:46,139 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:46,139 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:46,202 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:46,202 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:46,209 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:46,301 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:46,301 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:46,301 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:46,301 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:46,301 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 22:59:46,301 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:46,301 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:46,302 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:46,302 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:46,302 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:46,364 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:46,364 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:46,364 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:46,428 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:46,428 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:46,429 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:46,429 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:46,429 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:46,506 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:46,506 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:47,902 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:47,902 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:47,903 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:47,906 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:59:49,237 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:49,237 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:49,238 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:50,397 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:50,397 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:50,398 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:50,398 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:50,398 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:50,509 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:50,509 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 22:59:53,900 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:53,901 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:53,901 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:53,904 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 22:59:55,216 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:55,216 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:55,216 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 22:59:56,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 22:59:56,631 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 22:59:56,631 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:56,632 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 22:59:56,632 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 22:59:56,749 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 22:59:56,749 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:00:01,222 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:01,222 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:01,222 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:05,205 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:05,205 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:05,206 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:05,207 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:00:07,249 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:07,249 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:07,250 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:13,215 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:13,216 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:13,216 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:19,232 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:19,232 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:19,232 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:25,264 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:25,264 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:25,265 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:31,231 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:31,231 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:31,231 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:37,242 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:37,243 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:37,243 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:40,210 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:40,210 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:40,210 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:40,211 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:00:43,239 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:43,239 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:43,240 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:46,066 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:46,067 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:46,067 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:46,078 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:00:49,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:49,213 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:49,213 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:53,210 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:53,210 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:53,210 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:53,211 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:00:55,046 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:55,046 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:55,046 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:55,046 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:55,046 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:00:55,046 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:55,046 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:55,046 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:55,046 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:55,046 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:00:55,113 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:00:55,114 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:00:55,114 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:00:55,185 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:55,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:55,185 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:55,185 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:55,185 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:00:55,185 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:55,185 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:55,185 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:55,185 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:55,185 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:00:55,225 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:55,225 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:55,225 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:00:55,252 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:00:55,252 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:00:55,252 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:00:56,114 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:56,115 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:56,115 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:56,115 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:56,115 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:00:56,255 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:00:56,256 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:00:59,673 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:59,674 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:59,674 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:59,674 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:59,675 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:00:59,675 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:59,675 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:59,675 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:59,675 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:59,675 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:00:59,747 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:00:59,747 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:00:59,747 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:00:59,817 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:59,817 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:59,817 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:59,817 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:59,817 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:00:59,817 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:00:59,817 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:00:59,818 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:59,818 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:00:59,818 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:00:59,894 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:00:59,894 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:00:59,894 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:00,015 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:00,015 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:00,016 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:01:00,016 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:01:00,016 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:01:00,100 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:01:00,100 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:01,236 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:01,236 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:01,236 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:01:04,945 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:04,946 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:04,946 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:01:04,946 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:01:04,946 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:01:05,013 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:01:05,013 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:05,259 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:05,259 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:05,260 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:01:05,415 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:05,416 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:05,416 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:01:05,416 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351298, 'iat': 1751349498}
2025-06-30 23:01:05,417 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:01:05,531 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:01:05,531 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:06,203 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:06,203 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:06,203 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:01:06,204 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:01:07,211 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:07,211 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:07,211 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:01:08,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:08,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:08,900 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:01:08,900 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:01:09,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:09,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:09,903 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:01:09,904 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:01:10,193 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:10,193 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:10,193 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:10,194 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:10,194 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:01:10,194 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:10,194 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:10,194 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:10,194 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:10,194 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:01:10,294 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:01:10,294 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:10,294 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:10,360 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:10,360 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:10,360 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:10,361 - INFO - app.core.security - Token payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:10,361 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:01:10,361 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:10,361 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:10,361 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:10,361 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:10,362 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:01:10,365 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:10,365 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:10,365 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:10,365 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:10,366 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:01:10,425 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:01:10,425 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:10,425 - INFO - app.core.security - Authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:10,845 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:01:10,845 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:13,227 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:13,227 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:13,228 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:01:16,846 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:16,847 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:16,848 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:16,848 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:16,849 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:01:16,919 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:01:16,920 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:17,160 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:17,160 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:17,160 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:21,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:21,896 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:21,896 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:21,897 - INFO - app.core.security - Token payload in get_current_user: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:21,897 - INFO - app.core.security - Looking up demo user with ID: 11
2025-06-30 23:01:21,967 - INFO - app.core.security - Found demo user - ID: 11, Type: demo
2025-06-30 23:01:21,967 - INFO - app.core.security - Successfully authenticated user - ID: 11, Type: demo, Class: DemoUser
2025-06-30 23:01:27,182 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:27,183 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:27,183 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:01:32,481 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:32,482 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:32,482 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:42,506 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:42,507 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:42,507 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:01:48,203 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:48,203 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:48,204 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:01:50,096 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:50,096 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:50,096 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:01:50,097 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:01:57,248 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:57,251 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:57,252 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:01:57,257 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:01:58,224 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:01:58,224 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:01:58,225 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:02:04,208 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:04,208 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:04,209 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:02:08,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:08,900 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:08,900 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:02:08,902 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:02:12,895 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:12,896 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:12,896 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:02:12,898 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:02:14,242 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:14,243 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:14,243 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:02:20,204 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:20,204 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:20,205 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:02:21,210 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:21,210 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:21,210 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:02:21,212 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:02:25,901 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:25,901 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:25,901 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:02:25,902 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:02:30,234 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:30,234 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:30,234 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:02:36,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:36,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:36,202 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:02:36,223 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:36,223 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:36,224 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:02:46,254 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:46,254 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:46,255 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:02:52,206 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:52,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:52,207 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:02:56,108 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:02:56,108 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:02:56,108 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:02:56,109 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:03:02,231 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:02,231 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:02,231 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:03:08,196 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:08,196 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:08,196 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:03:14,221 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:14,222 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:14,222 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:03:14,224 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:03:15,893 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:15,893 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:15,893 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:03:15,894 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:03:18,223 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:18,223 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:18,224 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:03:24,214 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:24,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:24,214 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:03:24,231 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:24,231 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:24,232 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:03:24,905 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:24,905 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:24,906 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:03:24,906 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:03:34,253 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:34,253 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:34,253 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:03:37,215 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:37,215 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:37,215 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:03:37,216 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:03:40,220 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:40,220 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:40,220 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:03:44,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:44,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:44,904 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:03:44,905 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:03:50,254 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:50,254 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:50,254 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:03:56,198 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:03:56,198 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:03:56,198 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:04:00,313 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:00,313 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:00,313 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:04:00,314 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:04:06,226 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:06,226 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:06,227 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:04:12,208 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:12,208 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:12,209 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:04:19,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:19,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:19,903 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:04:19,904 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:04:22,248 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:22,248 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:22,248 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:04:28,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:28,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:28,202 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:04:28,218 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:28,218 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:28,218 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:04:30,362 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:30,362 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:30,363 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:04:30,363 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:04:38,240 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:38,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:38,241 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:04:41,902 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:41,902 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:41,902 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:04:41,903 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:04:44,206 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:44,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:44,206 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:04:54,207 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:54,207 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:54,207 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:04:54,208 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:04:54,224 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:04:54,224 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:04:54,225 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:00,217 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:00,217 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:00,217 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:00,326 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:00,326 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:00,326 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:05:00,892 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:00,892 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:00,892 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:00,893 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:05:03,012 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:03,012 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:03,013 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:03,014 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:05:10,359 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:10,359 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:10,359 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:16,201 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:16,201 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:16,201 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:16,216 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:16,216 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:16,217 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '11', 'user_type': 'demo', 'account_number': 'GQ6YE', 'exp': 1751351469, 'iat': 1751349669}
2025-06-30 23:05:22,554 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:22,554 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:22,555 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:22,687 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:22,687 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:22,688 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:23,147 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:23,147 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:23,147 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:23,149 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:05:27,891 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:27,892 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:27,892 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:32,272 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:32,272 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:32,272 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:32,273 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:05:32,280 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:32,280 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:32,280 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:32,282 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:05:32,287 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:32,287 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:32,287 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:32,288 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:05:32,295 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:32,295 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:32,295 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:32,297 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:05:32,305 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:32,306 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:32,306 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:32,307 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:05:32,315 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:32,315 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:32,316 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:32,320 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:32,320 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:32,321 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:34,205 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:34,205 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:34,206 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:40,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:40,213 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:40,213 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:46,206 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:46,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:46,206 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:46,972 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:05:46,973 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:05:46,973 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:05:46,973 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 1, 6, 35, 46, 972827), 'iat': datetime.datetime(2025, 7, 1, 6, 5, 46, 972832)}
2025-06-30 23:05:46,973 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:05:46,973 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NTQ3NDYsImlhdCI6MTc1MTM0OTk0Nn0.DqQ0x2vQSy96qFWJrwK4D14BCytlRwH_QmHZyBzq_sA, Expiry (seconds): 604800
2025-06-30 23:05:46,974 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:46,974 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:46,974 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:46,975 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:05:46,979 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 23:05:48,289 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:48,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:48,290 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,290 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,290 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:05:48,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:48,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:48,290 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,290 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,290 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:05:48,389 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:05:48,389 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:05:48,389 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:05:48,450 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:48,450 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:48,450 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,450 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,450 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:05:48,556 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:48,556 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:48,557 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,557 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,557 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:05:48,557 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:48,557 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:48,557 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,557 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,557 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:05:48,575 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:05:48,575 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:05:48,620 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:05:48,621 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:05:48,621 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:05:48,739 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:48,739 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:48,739 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,740 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:48,740 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:05:48,822 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:05:48,822 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:05:52,210 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:52,210 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:52,211 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:54,039 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:54,039 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:54,039 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:54,039 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:54,039 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:05:54,093 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:05:54,093 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:05:54,350 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:54,350 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:54,351 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:05:57,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:05:57,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:05:57,899 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:05:57,900 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:06:00,231 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:00,231 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:00,232 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:06:00,232 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:06:00,232 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:06:00,295 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:06:00,295 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:06:04,378 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:04,378 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:04,378 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:06:06,388 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:06,389 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:06,389 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:06:06,390 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:06:09,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:09,896 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:09,896 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:06:09,897 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:06:12,816 - INFO - app.core.security - Closing Redis connection...
2025-06-30 23:06:12,817 - INFO - app.core.security - Redis connection closed.
2025-06-30 23:06:19,959 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 23:06:19,959 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 23:06:19,962 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 23:06:19,962 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 23:06:19,981 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:06:19,981 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:06:19,981 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:06:19,981 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 6, 41, 19, 981520), 'iat': datetime.datetime(2025, 7, 1, 6, 6, 19, 981523)}
2025-06-30 23:06:19,982 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:06:22,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:22,292 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:22,292 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:06:26,563 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:26,563 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:26,563 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351746, 'iat': 1751349946}
2025-06-30 23:06:28,206 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:28,207 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:28,207 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:06:28,207 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:06:36,594 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:36,594 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:36,595 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:06:42,203 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:42,203 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:42,204 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:06:48,309 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:06:48,310 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:06:48,310 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:06:48,310 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 1, 6, 36, 48, 309844), 'iat': datetime.datetime(2025, 7, 1, 6, 6, 48, 309851)}
2025-06-30 23:06:48,310 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:06:48,310 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NTQ4MDgsImlhdCI6MTc1MTM1MDAwOH0.0ZMuGTWlB5luzoeZhPZSCCmXqj5BgGHBPZ8KEbfMgds, Expiry (seconds): 604800
2025-06-30 23:06:48,313 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 23:06:48,316 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:48,316 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:48,317 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:06:49,572 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:49,572 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:49,573 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:49,573 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:49,573 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:06:49,573 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:49,574 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:49,574 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:49,574 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:49,574 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:06:49,684 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:06:49,684 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:06:49,685 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:06:49,773 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:49,774 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:49,774 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:49,774 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:49,774 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:06:49,775 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:49,775 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:49,775 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:49,775 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:49,775 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:06:49,895 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:06:49,896 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:06:49,896 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:06:50,082 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:50,082 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:50,083 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:50,083 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:50,083 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:06:50,308 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:06:50,308 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:06:51,732 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:51,732 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:51,733 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:51,733 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:51,733 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:06:51,869 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:06:51,869 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:06:54,217 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:54,217 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:54,218 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:06:56,379 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:56,379 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:56,380 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:56,380 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:06:56,380 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:06:56,480 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:06:56,481 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:06:56,694 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:06:56,694 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:06:56,694 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:07:04,077 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:04,078 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:04,078 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:07:04,078 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:07:04,078 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:07:04,331 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:07:04,331 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:07:04,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:04,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:04,904 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:04,904 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:07:06,717 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:06,717 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:06,717 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:10,364 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:10,364 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:10,364 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:10,366 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:07:12,214 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:12,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:12,214 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:12,247 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:12,247 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:12,247 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:07:13,897 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:13,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:13,897 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:13,899 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:07:22,269 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:22,269 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:22,269 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:24,897 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:24,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:24,897 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:24,898 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:07:28,205 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:28,205 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:28,205 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:07:33,201 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:33,201 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:33,201 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:33,202 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:07:33,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:33,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:33,899 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:33,900 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:07:38,233 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:38,233 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:38,233 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:44,200 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:44,200 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:44,200 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:07:44,215 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:44,215 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:44,216 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:07:54,247 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:07:54,247 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:07:54,248 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:00,093 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:00,094 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:00,095 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:00,096 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNTE4MDgsImlhdCI6MTc1MTM1MDAwOH0.3OxV9jzlh5qvzaqpebpkqgx1ith-d-SYsLlw1zzGYOI
2025-06-30 23:08:00,097 - INFO - app.core.security - No refresh token data found in Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNTE4MDgsImlhdCI6MTc1MTM1MDAwOH0.3OxV9jzlh5qvzaqpebpkqgx1ith-d-SYsLlw1zzGYOI
2025-06-30 23:08:00,223 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:00,223 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:00,223 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:05,729 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:05,729 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:05,733 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:05,733 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:05,733 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:08:05,939 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:08:05,940 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:08:09,784 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:09,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:09,787 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:09,942 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:09,943 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:09,943 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:09,943 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:09,943 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:08:09,944 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:09,944 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:09,944 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:09,945 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:09,945 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:08:10,024 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:10,024 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:10,025 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:10,025 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:10,025 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:08:10,097 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:08:10,101 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:08:10,101 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:08:10,256 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:10,256 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:10,257 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:10,257 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:10,261 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:08:10,261 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:10,261 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:10,263 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:10,263 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:10,263 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:08:10,351 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:08:10,353 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:08:10,353 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:08:10,454 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:08:10,455 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:08:10,574 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:10,574 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:10,575 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:10,575 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:10,575 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:08:10,658 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:08:10,659 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:08:17,287 - INFO - app.core.security - Closing Redis connection...
2025-06-30 23:08:17,290 - INFO - app.core.security - Redis connection closed.
2025-06-30 23:08:20,103 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 23:08:20,104 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 23:08:20,106 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 23:08:20,106 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 23:08:20,110 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:08:20,110 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:08:20,110 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:08:20,110 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 6, 43, 20, 110197), 'iat': datetime.datetime(2025, 7, 1, 6, 8, 20, 110200)}
2025-06-30 23:08:20,110 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:08:21,869 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:21,869 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:21,870 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:21,872 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:08:21,877 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:21,877 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:21,877 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:21,877 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:21,877 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:08:21,882 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:21,883 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:21,883 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:21,895 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:21,896 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:21,896 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:21,897 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:08:21,901 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:21,901 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:21,901 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:22,781 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:08:22,781 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:08:28,835 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:28,835 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:28,835 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:28,835 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:28,836 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:08:29,384 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:08:29,384 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:08:31,921 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:31,921 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:31,921 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:32,283 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:32,283 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:32,284 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:32,286 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:08:36,893 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:36,894 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:36,894 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:36,896 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:08:38,207 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:38,207 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:38,208 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351808, 'iat': 1751350008}
2025-06-30 23:08:38,892 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:38,892 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:38,892 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:38,893 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:08:48,238 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:48,238 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:48,238 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:48,897 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:48,897 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:48,898 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:08:48,899 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-06-30 23:08:54,219 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:08:54,220 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:08:54,220 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:09:00,225 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:00,226 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:00,227 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:09:00,707 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:09:00,708 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:09:00,708 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:09:00,708 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 1, 6, 39, 0, 707909), 'iat': datetime.datetime(2025, 7, 1, 6, 9, 0, 707915)}
2025-06-30 23:09:00,708 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:09:00,709 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NTQ5NDAsImlhdCI6MTc1MTM1MDE0MH0.2GqmNoYh47Gy3DbOwN3l9b0gBjVg8S8wFVRiAZOgBW8, Expiry (seconds): 604800
2025-06-30 23:09:00,714 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 23:09:02,114 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:02,114 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:02,114 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:02,114 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:02,115 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:09:02,115 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:02,115 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:02,115 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:02,116 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:02,116 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:02,204 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:02,204 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:02,205 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:02,324 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:02,324 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:02,325 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:02,325 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:02,325 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:09:02,325 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:02,325 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:02,326 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:02,326 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:02,326 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:02,329 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:02,329 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:02,330 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:02,330 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:02,330 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:02,389 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:02,389 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:02,389 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:02,713 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:02,714 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:04,365 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:04,365 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:04,366 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:04,366 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:04,367 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:04,537 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:04,537 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:06,222 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:06,222 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:06,222 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-06-30 23:09:10,486 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:10,487 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:10,487 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:10,487 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:10,488 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:10,545 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:10,545 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:10,796 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:10,796 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:10,796 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:16,012 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:16,012 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:16,012 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:16,012 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:16,012 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:16,065 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:16,065 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:35,369 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:35,369 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:35,370 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:35,370 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:35,370 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:09:35,370 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:35,370 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:35,371 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:35,371 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:35,371 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:35,492 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:35,492 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:35,492 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:35,674 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:35,674 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:35,675 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:35,675 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:35,675 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:09:35,675 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:35,676 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:35,677 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:35,677 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:35,677 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:35,792 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:35,793 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:35,793 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:35,946 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:35,946 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:35,946 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:35,946 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:35,946 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:36,076 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:36,076 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:37,524 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:37,525 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:37,526 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:37,526 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:37,526 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:37,582 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:37,583 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:40,368 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:40,368 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:40,371 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:40,371 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351940, 'iat': 1751350140}
2025-06-30 23:09:40,371 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:40,597 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:40,597 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:40,598 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNTE5NDAsImlhdCI6MTc1MTM1MDE0MH0.ntZYTERvPT4l31vj8BGuvfl0YhNIgABQoLZsVC4YMUI
2025-06-30 23:09:40,616 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNTE5NDAsImlhdCI6MTc1MTM1MDE0MH0.ntZYTERvPT4l31vj8BGuvfl0YhNIgABQoLZsVC4YMUI
2025-06-30 23:09:53,289 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:09:53,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:09:53,290 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:09:53,290 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 1, 6, 39, 53, 289869), 'iat': datetime.datetime(2025, 7, 1, 6, 9, 53, 289875)}
2025-06-30 23:09:53,290 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:09:53,290 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NTQ5OTMsImlhdCI6MTc1MTM1MDE5M30.w5PkMd7l1Tf6Z46y7JiLlmPeEZPxR9BDjZ5co09dbx8, Expiry (seconds): 604800
2025-06-30 23:09:53,294 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 23:09:54,534 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:54,534 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:54,535 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:54,535 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:54,535 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:09:54,535 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:54,536 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:54,536 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:54,536 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:54,536 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:54,732 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:54,732 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:54,732 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:54,923 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:54,923 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:54,923 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:54,923 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:54,923 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:09:54,924 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:54,924 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:54,924 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:54,925 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:54,925 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:54,989 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:54,989 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:54,990 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:55,237 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:55,237 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:55,238 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:55,238 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:55,238 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:55,343 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:55,343 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:09:56,864 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:09:56,865 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:09:56,865 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:56,865 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:09:56,865 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:09:56,934 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:09:56,934 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:10:02,397 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:10:02,397 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:10:02,398 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:10:02,398 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:10:02,398 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:10:02,502 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:10:02,502 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:10:02,710 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:10:02,710 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:10:02,710 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:10:10,603 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:10:10,604 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:10:10,604 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:10:10,604 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:10:10,605 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:10:10,805 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:10:10,805 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:10:18,033 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:10:18,034 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:10:18,034 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:10:33,354 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:10:33,354 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:10:33,354 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:10:49,226 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:10:49,226 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:10:49,227 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:10:53,543 - INFO - app.core.security - Closing Redis connection...
2025-06-30 23:10:53,546 - INFO - app.core.security - Redis connection closed.
2025-06-30 23:11:43,745 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 23:11:43,745 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 23:11:43,748 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 23:11:43,749 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 23:11:43,784 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:11:43,784 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:11:43,784 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:11:43,784 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 6, 46, 43, 784235), 'iat': datetime.datetime(2025, 7, 1, 6, 11, 43, 784237)}
2025-06-30 23:11:43,784 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:12:04,191 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:04,191 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:04,191 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,192 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,192 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:12:04,192 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:04,192 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:04,192 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,192 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,192 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:04,193 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:04,193 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:04,194 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,194 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,194 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:04,197 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:04,197 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:04,197 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:04,206 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:04,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:04,206 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,206 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,207 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:12:04,207 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:04,207 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:04,207 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,207 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,207 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:04,208 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:04,208 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:04,211 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:04,211 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:04,211 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:04,415 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:04,415 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:04,416 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,416 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,416 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:04,418 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:04,418 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:04,610 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:04,611 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:04,611 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,611 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,611 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:04,614 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:04,614 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:04,710 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:04,710 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:04,710 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,710 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:04,710 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:04,714 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:04,714 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:04,927 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:04,927 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:04,927 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:06,403 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:06,403 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:06,403 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:06,404 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751351993, 'iat': 1751350193}
2025-06-30 23:12:06,404 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:06,407 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:06,408 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:06,408 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNTE5OTMsImlhdCI6MTc1MTM1MDE5M30.hXM_cgg0KhTYGTAx4-LL2iPhnBVXO4VGuCnR2s-1x-E
2025-06-30 23:12:06,409 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNTE5OTMsImlhdCI6MTc1MTM1MDE5M30.hXM_cgg0KhTYGTAx4-LL2iPhnBVXO4VGuCnR2s-1x-E
2025-06-30 23:12:21,227 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:12:21,227 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:12:21,227 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:12:21,227 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 1, 6, 42, 21, 227145), 'iat': datetime.datetime(2025, 7, 1, 6, 12, 21, 227153)}
2025-06-30 23:12:21,229 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:12:21,229 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE5NTUxNDEsImlhdCI6MTc1MTM1MDM0MX0.bVWa6rHd2dwAkuIzBgRnL3KlS5Tr4LH7qE_lwglY7og, Expiry (seconds): 604800
2025-06-30 23:12:21,230 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-06-30 23:12:22,310 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:22,310 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:22,310 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,310 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,310 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:12:22,310 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:22,310 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:22,311 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,311 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,311 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:22,314 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:22,314 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:22,314 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:22,320 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:22,320 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:22,321 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,321 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,321 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:12:22,321 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:22,321 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:22,321 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,321 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,321 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:22,323 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:22,323 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:22,323 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:22,339 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:22,339 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:22,340 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,340 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,340 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:22,342 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:22,343 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:22,438 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:22,438 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:22,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,438 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,438 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:22,440 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:22,440 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:22,530 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:22,530 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:22,530 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,530 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,530 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:22,532 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:22,532 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:22,597 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:22,597 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:22,598 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,598 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:22,598 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:22,605 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:22,605 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:22,757 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:22,757 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:22,757 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,633 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:54,633 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:54,633 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,633 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,634 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:12:54,634 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:54,634 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:54,634 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,634 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,634 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:54,636 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:54,636 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:54,636 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:54,640 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:54,640 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:54,640 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,640 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,641 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:12:54,641 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:54,641 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:54,641 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,641 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,641 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:54,643 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:54,643 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:54,643 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:54,645 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:54,645 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:54,645 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,645 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,645 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:54,647 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:54,648 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:54,739 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:54,739 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:54,740 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,740 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,740 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:54,742 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:54,742 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:54,835 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:54,835 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:54,835 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,836 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:54,836 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:54,837 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:54,837 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:55,046 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:55,046 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:55,046 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:58,971 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:12:58,971 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:12:58,971 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:58,971 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751352141, 'iat': 1751350341}
2025-06-30 23:12:58,971 - INFO - app.core.security - Looking up demo user with ID: 1
2025-06-30 23:12:58,976 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-06-30 23:12:58,976 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-06-30 23:12:58,977 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNTIxNDEsImlhdCI6MTc1MTM1MDM0MX0.S72f1gtil10rgQEyuNEUjeqeW-PgZMYoE9xd_6Pqz9Q
2025-06-30 23:12:58,977 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTEzNTIxNDEsImlhdCI6MTc1MTM1MDM0MX0.S72f1gtil10rgQEyuNEUjeqeW-PgZMYoE9xd_6Pqz9Q
2025-06-30 23:15:44,404 - INFO - app.core.security - Closing Redis connection...
2025-06-30 23:15:44,405 - INFO - app.core.security - Redis connection closed.
2025-06-30 23:15:47,090 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 23:15:47,091 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 23:15:47,093 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 23:15:47,093 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 23:15:47,097 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:15:47,097 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:15:47,097 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:15:47,097 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 6, 50, 47, 96998), 'iat': datetime.datetime(2025, 7, 1, 6, 15, 47, 97000)}
2025-06-30 23:15:47,097 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:16:02,634 - INFO - app.core.security - Closing Redis connection...
2025-06-30 23:16:02,635 - INFO - app.core.security - Redis connection closed.
2025-06-30 23:16:04,868 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 23:16:04,868 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 23:16:04,870 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 23:16:04,870 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 23:16:04,873 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:16:04,873 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:16:04,873 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:16:04,873 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 6, 51, 4, 873777), 'iat': datetime.datetime(2025, 7, 1, 6, 16, 4, 873779)}
2025-06-30 23:16:04,874 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:17:15,648 - INFO - app.core.security - Closing Redis connection...
2025-06-30 23:17:15,650 - INFO - app.core.security - Redis connection closed.
2025-06-30 23:17:48,657 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 23:17:48,658 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 23:17:48,660 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 23:17:48,660 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 23:17:48,664 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:17:48,664 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:17:48,664 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:17:48,664 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 6, 52, 48, 664073), 'iat': datetime.datetime(2025, 7, 1, 6, 17, 48, 664075)}
2025-06-30 23:17:48,664 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:17:58,585 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:17:58,585 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:17:58,585 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:17:58,585 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 1, 6, 47, 58, 585025), 'iat': datetime.datetime(2025, 7, 1, 6, 17, 58, 585032)}
2025-06-30 23:17:58,585 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:17:58,586 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE5NTU0NzgsImlhdCI6MTc1MTM1MDY3OH0.__Tl4MPTC-Oypnu7weKncgT-l_wxSqDzCoBcmzIJj5U, Expiry (seconds): 604800
2025-06-30 23:17:58,588 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-06-30 23:17:59,800 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:17:59,801 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:17:59,801 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:17:59,801 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:17:59,801 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:17:59,801 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:17:59,801 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:17:59,802 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:17:59,802 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:17:59,802 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 23:17:59,807 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 23:17:59,807 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 23:17:59,807 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 23:17:59,813 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:17:59,814 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:17:59,814 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:17:59,814 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:17:59,814 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-06-30 23:17:59,814 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:17:59,814 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:17:59,815 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:17:59,815 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:17:59,815 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 23:17:59,817 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:17:59,817 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:17:59,818 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:17:59,818 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:17:59,818 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 23:17:59,836 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 23:17:59,836 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 23:17:59,836 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-06-30 23:17:59,851 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 23:17:59,851 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 23:18:00,147 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:18:00,148 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:18:00,148 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:18:00,148 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:18:00,148 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 23:18:00,152 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 23:18:00,153 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 23:18:00,382 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:18:00,383 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:18:00,383 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:18:00,383 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:18:00,383 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 23:18:00,388 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 23:18:00,388 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 23:18:00,470 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:18:00,470 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:18:00,470 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:18:53,843 - INFO - app.core.security - Closing Redis connection...
2025-06-30 23:18:53,846 - INFO - app.core.security - Redis connection closed.
2025-06-30 23:21:31,132 - INFO - app.core.security - Attempting to connect to Redis...
2025-06-30 23:21:31,132 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-06-30 23:21:31,135 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-06-30 23:21:31,135 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-06-30 23:21:31,138 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-06-30 23:21:31,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-06-30 23:21:31,138 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-06-30 23:21:31,138 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 1, 6, 56, 31, 138672), 'iat': datetime.datetime(2025, 7, 1, 6, 21, 31, 138674)}
2025-06-30 23:21:31,139 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-06-30 23:21:38,221 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:21:38,221 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:21:38,222 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352478, 'iat': 1751350678}
2025-06-30 23:22:52,302 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-06-30 23:22:52,303 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-06-30 23:22:52,303 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352735, 'iat': 1751350935}
2025-06-30 23:22:52,303 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751352735, 'iat': 1751350935}
2025-06-30 23:22:52,303 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-06-30 23:22:52,307 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-06-30 23:22:52,307 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-06-30 23:24:20,495 - INFO - app.core.security - Closing Redis connection...
2025-06-30 23:24:20,497 - INFO - app.core.security - Redis connection closed.
2025-07-02 03:20:07,647 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-02 03:20:07,647 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-02 03:20:07,653 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-02 03:20:07,653 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-02 03:20:07,660 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 03:20:07,660 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 03:20:07,660 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 03:20:07,660 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 2, 10, 55, 7, 659995), 'iat': datetime.datetime(2025, 7, 2, 10, 20, 7, 659997)}
2025-07-02 03:20:07,660 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 03:20:20,953 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 03:20:20,953 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 03:20:20,953 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 03:20:20,953 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 2, 10, 50, 20, 953348), 'iat': datetime.datetime(2025, 7, 2, 10, 20, 20, 953361)}
2025-07-02 03:20:20,954 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 03:20:20,954 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIwNTY0MjAsImlhdCI6MTc1MTQ1MTYyMH0.3y0uE9EWgwiUKSqq0D-SvZFtMZg2NQF-U2rZABq1xPA, Expiry (seconds): 604800
2025-07-02 03:20:20,956 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-02 03:20:22,121 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:20:22,121 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:20:22,122 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:22,122 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:22,122 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 03:20:22,122 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:20:22,122 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:20:22,122 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:22,123 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:22,123 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:20:22,128 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:20:22,128 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:20:22,128 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:20:22,136 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:20:22,136 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:20:22,137 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:22,137 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:22,137 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 03:20:22,137 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:20:22,137 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:20:22,137 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:22,138 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:22,138 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:20:22,142 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:20:22,143 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:20:22,143 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:20:22,145 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:20:22,145 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:20:22,146 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:22,146 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:22,146 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:20:22,151 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:20:22,151 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:20:22,384 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:20:22,384 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:20:22,384 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:22,384 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:22,385 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:20:22,389 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:20:22,390 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:20:22,695 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:20:22,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:20:22,696 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:22,816 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:20:22,817 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:20:22,817 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:22,817 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:22,817 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:20:22,828 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:20:22,828 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:20:40,583 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:20:40,583 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:20:40,583 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:40,583 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:40,583 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 03:20:40,583 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:20:40,583 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:20:40,583 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:40,583 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:40,583 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:20:40,585 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:20:40,585 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:20:40,586 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:20:40,591 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:20:40,591 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:20:40,591 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:40,591 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:40,591 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 03:20:40,591 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:20:40,591 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:20:40,592 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:40,592 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:40,592 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:20:40,594 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:20:40,594 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:20:40,594 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:20:40,602 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:20:40,602 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:20:40,603 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:40,603 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:40,603 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:20:40,607 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:20:40,608 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:20:40,767 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:20:40,767 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:20:40,767 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:40,767 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:40,767 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:20:40,769 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:20:40,770 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:20:41,140 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:20:41,141 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:20:41,141 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:41,142 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:20:41,142 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:20:41,146 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:20:41,146 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:20:41,409 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:20:41,409 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:20:41,409 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:21:14,033 - INFO - app.core.security - Closing Redis connection...
2025-07-02 03:21:14,033 - INFO - app.core.security - Redis connection closed.
2025-07-02 03:42:35,852 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-02 03:42:35,852 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-02 03:42:35,868 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-02 03:42:35,868 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-02 03:42:35,872 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 03:42:35,872 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 03:42:35,872 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 03:42:35,872 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 2, 11, 17, 35, 872466), 'iat': datetime.datetime(2025, 7, 2, 10, 42, 35, 872468)}
2025-07-02 03:42:35,873 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 03:42:42,797 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:42:42,797 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:42:42,798 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751453420, 'iat': 1751451620}
2025-07-02 03:46:01,467 - INFO - app.core.security - Closing Redis connection...
2025-07-02 03:46:01,468 - INFO - app.core.security - Redis connection closed.
2025-07-02 03:56:03,528 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-02 03:56:03,528 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-02 03:56:03,535 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-02 03:56:03,535 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-02 03:56:03,538 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 03:56:03,538 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 03:56:03,538 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 03:56:03,538 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 2, 11, 31, 3, 538602), 'iat': datetime.datetime(2025, 7, 2, 10, 56, 3, 538603)}
2025-07-02 03:56:03,538 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 03:56:05,763 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:56:05,763 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:56:05,764 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-02 03:56:07,367 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:56:07,367 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:56:07,367 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752056420, 'iat': 1751451620}
2025-07-02 03:56:07,367 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIwNTY0MjAsImlhdCI6MTc1MTQ1MTYyMH0.3y0uE9EWgwiUKSqq0D-SvZFtMZg2NQF-U2rZABq1xPA
2025-07-02 03:56:07,374 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIwNTY0MjAsImlhdCI6MTc1MTQ1MTYyMH0.3y0uE9EWgwiUKSqq0D-SvZFtMZg2NQF-U2rZABq1xPA
2025-07-02 03:56:07,375 - INFO - app.core.security - Refresh token deleted from Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIwNTY0MjAsImlhdCI6MTc1MTQ1MTYyMH0.3y0uE9EWgwiUKSqq0D-SvZFtMZg2NQF-U2rZABq1xPA
2025-07-02 03:56:09,151 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:56:09,151 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:56:09,152 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-02 03:56:09,154 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-02 03:56:20,021 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 03:56:20,021 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 03:56:20,022 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 03:56:20,022 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 2, 11, 26, 20, 20755), 'iat': datetime.datetime(2025, 7, 2, 10, 56, 20, 20779)}
2025-07-02 03:56:20,022 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 03:56:20,023 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIwNTg1ODAsImlhdCI6MTc1MTQ1Mzc4MH0.7YXpDZteGENJgor5FvJ1wHMDOfBAe9RX3pE14TV2xUQ, Expiry (seconds): 604800
2025-07-02 03:56:20,034 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-02 03:56:21,227 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:56:21,227 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:56:21,227 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:21,228 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:21,228 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 03:56:21,228 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:56:21,228 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:56:21,228 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:21,228 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:21,228 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:56:21,232 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:56:21,232 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:56:21,232 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:56:21,247 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:56:21,247 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:56:21,247 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:21,247 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:21,247 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 03:56:21,248 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:56:21,248 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:56:21,248 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:21,248 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:21,265 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:56:21,286 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:56:21,286 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:56:21,287 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:21,287 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:21,287 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:56:21,291 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:56:21,292 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:56:21,292 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:56:21,312 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:56:21,313 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:56:21,636 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:56:21,636 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:56:21,637 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:21,637 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:21,637 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:56:21,643 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:56:21,643 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:56:21,951 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:56:21,951 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:56:21,952 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:22,107 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:56:22,107 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:56:22,108 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:22,108 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:22,108 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:56:22,114 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:56:22,114 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:56:39,776 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:56:39,776 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:56:39,777 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:39,777 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:39,777 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 03:56:39,777 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:56:39,777 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:56:39,777 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:39,777 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:39,777 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:56:39,779 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:56:39,779 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:56:39,779 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:56:39,799 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:56:39,799 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:56:39,800 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:39,800 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:39,800 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 03:56:39,800 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:56:39,800 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:56:39,800 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:39,800 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:39,800 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:56:39,803 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:56:39,804 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:56:39,804 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:56:40,141 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:56:40,141 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:56:40,142 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:40,146 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:40,146 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:56:40,154 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:56:40,154 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:56:40,474 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:56:40,474 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:56:40,474 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:40,474 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:40,475 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:56:40,478 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:56:40,479 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:56:40,703 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:56:40,703 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:56:40,703 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:40,703 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:56:40,704 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:56:40,708 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:56:40,709 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:56:40,785 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:56:40,785 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:56:40,785 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:57:37,554 - INFO - app.core.security - Closing Redis connection...
2025-07-02 03:57:37,555 - INFO - app.core.security - Redis connection closed.
2025-07-02 03:58:19,559 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-02 03:58:19,559 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-02 03:58:19,563 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-02 03:58:19,563 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-02 03:58:19,569 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 03:58:19,569 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 03:58:19,569 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 03:58:19,569 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 2, 11, 33, 19, 569330), 'iat': datetime.datetime(2025, 7, 2, 10, 58, 19, 569332)}
2025-07-02 03:58:19,569 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 03:58:21,502 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:58:21,502 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:58:21,502 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:58:22,472 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:58:22,473 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:58:22,473 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:58:22,473 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:58:22,473 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 03:58:22,473 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:58:22,473 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:58:22,474 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:58:22,474 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:58:22,474 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:58:22,478 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:58:22,478 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:58:22,478 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:58:22,503 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:58:22,503 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:58:22,504 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:58:22,504 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:58:22,504 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 03:58:22,504 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:58:22,504 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:58:22,504 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:58:22,504 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:58:22,504 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:58:22,507 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:58:22,507 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:58:22,507 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:58:22,736 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:58:22,736 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:58:22,737 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:58:22,737 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:58:22,737 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:58:22,742 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:58:22,742 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:58:22,937 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:58:22,937 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:58:22,938 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:58:22,938 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:58:22,938 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:58:22,941 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:58:22,941 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:58:23,080 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:58:23,080 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:58:23,081 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:58:23,081 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:58:23,081 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 03:58:23,083 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 03:58:23,083 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 03:58:23,250 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 03:58:23,250 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 03:58:23,251 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 03:59:30,646 - INFO - app.core.security - Closing Redis connection...
2025-07-02 03:59:30,647 - INFO - app.core.security - Redis connection closed.
2025-07-02 04:02:54,477 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-02 04:02:54,477 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-02 04:02:54,480 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-02 04:02:54,480 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-02 04:02:54,483 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 04:02:54,483 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 04:02:54,483 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 04:02:54,483 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 2, 11, 37, 54, 483578), 'iat': datetime.datetime(2025, 7, 2, 11, 2, 54, 483580)}
2025-07-02 04:02:54,483 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 04:02:57,079 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:02:57,079 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:02:57,079 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:02:57,080 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:02:57,080 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:02:57,080 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:02:57,080 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:02:57,080 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:02:57,080 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:02:57,080 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:02:57,084 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:02:57,084 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:02:57,084 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:02:57,092 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:02:57,092 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:02:57,092 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:02:57,092 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:02:57,092 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:02:57,092 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:02:57,092 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:02:57,092 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:02:57,092 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:02:57,092 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:02:57,094 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:02:57,094 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:02:57,094 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:02:57,098 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:02:57,098 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:02:57,098 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:02:57,098 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:02:57,099 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:02:57,100 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:02:57,100 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:02:57,180 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:02:57,180 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:02:57,180 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:02:57,180 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:02:57,180 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:02:57,182 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:02:57,182 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:02:57,269 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:02:57,270 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:02:57,270 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:02:57,270 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:02:57,270 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:02:57,271 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:02:57,271 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:03:02,430 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:03:02,430 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:03:02,431 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:05:26,167 - INFO - app.core.security - Closing Redis connection...
2025-07-02 04:05:26,168 - INFO - app.core.security - Redis connection closed.
2025-07-02 04:05:28,549 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-02 04:05:28,549 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-02 04:05:28,552 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-02 04:05:28,552 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-02 04:05:28,556 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 04:05:28,556 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 04:05:28,556 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 04:05:28,556 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 2, 11, 40, 28, 556049), 'iat': datetime.datetime(2025, 7, 2, 11, 5, 28, 556052)}
2025-07-02 04:05:28,556 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 04:10:50,233 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-02 04:10:50,233 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-02 04:10:50,237 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-02 04:10:50,237 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-02 04:10:50,240 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 04:10:50,240 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 04:10:50,240 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 04:10:50,240 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 2, 11, 45, 50, 240081), 'iat': datetime.datetime(2025, 7, 2, 11, 10, 50, 240083)}
2025-07-02 04:10:50,240 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 04:10:52,122 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:10:52,122 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:10:52,123 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:10:58,004 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:10:58,004 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:10:58,005 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:10:58,005 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:10:58,005 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:10:58,005 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:10:58,005 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:10:58,005 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:10:58,005 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:10:58,006 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:10:58,010 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:10:58,010 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:10:58,011 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:10:58,028 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:10:58,029 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:10:58,029 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:10:58,029 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:10:58,029 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:10:58,029 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:10:58,029 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:10:58,029 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:10:58,030 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:10:58,030 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:10:58,034 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:10:58,034 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:10:58,034 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:10:58,409 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:10:58,410 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:10:58,410 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:10:58,410 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:10:58,410 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:10:58,416 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:10:58,416 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:10:58,684 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:10:58,685 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:10:58,685 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:10:58,685 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:10:58,685 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:10:58,691 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:10:58,691 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:10:58,908 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:10:58,908 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:10:58,909 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:10:58,909 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:10:58,909 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:10:58,913 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:10:58,913 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:10:58,993 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:10:58,993 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:10:58,994 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:12:07,704 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:12:07,704 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:12:07,705 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:12:07,705 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:12:07,705 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:12:07,705 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:12:07,705 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:12:07,705 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:12:07,705 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:12:07,706 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:12:07,708 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:12:07,709 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:12:07,709 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:12:07,710 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:12:07,710 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:12:07,710 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:12:07,710 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:12:07,710 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:12:07,711 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:12:07,711 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:12:07,720 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:12:07,727 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:12:07,727 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:12:07,737 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:12:07,737 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:12:07,737 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:12:07,767 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:12:07,768 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:12:07,770 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:12:07,773 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:12:07,773 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:12:07,787 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:12:07,787 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:12:07,811 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:12:07,811 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:12:07,812 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:12:07,812 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:12:07,812 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:12:07,839 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:12:07,839 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:12:08,439 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:12:08,440 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:12:08,441 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:12:08,441 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:12:08,442 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:12:08,455 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:12:08,456 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:12:09,005 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:12:09,005 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:12:09,006 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751455580, 'iat': 1751453780}
2025-07-02 04:12:31,439 - INFO - app.core.security - Closing Redis connection...
2025-07-02 04:12:31,441 - INFO - app.core.security - Redis connection closed.
2025-07-02 04:32:44,983 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-02 04:32:44,983 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-02 04:32:44,988 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-02 04:32:44,989 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-02 04:32:44,995 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 04:32:44,995 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 04:32:44,995 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 04:32:44,995 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 2, 12, 7, 44, 995181), 'iat': datetime.datetime(2025, 7, 2, 11, 32, 44, 995184)}
2025-07-02 04:32:44,996 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 04:32:47,151 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:32:47,151 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:32:47,152 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-02 04:32:51,247 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:32:51,247 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:32:51,247 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-02 04:32:51,248 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-02 04:32:51,261 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:32:51,261 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:32:51,262 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-02 04:32:51,263 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-02 04:32:51,367 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:32:51,367 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:32:51,367 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-02 04:32:51,369 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-02 04:32:51,383 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:32:51,384 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:32:51,384 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-02 04:32:51,386 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-02 04:33:03,192 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 04:33:03,193 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 04:33:03,193 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 04:33:03,193 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 2, 12, 3, 3, 192841), 'iat': datetime.datetime(2025, 7, 2, 11, 33, 3, 192846)}
2025-07-02 04:33:03,193 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 04:33:03,193 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIwNjA3ODMsImlhdCI6MTc1MTQ1NTk4M30.NLlhIStVXWTTq0aqh4mKEi73cwj8cb7tlQzaIr9xY-g, Expiry (seconds): 604800
2025-07-02 04:33:03,194 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-02 04:33:04,291 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:33:04,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:33:04,291 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:04,291 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:04,291 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:33:04,291 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:33:04,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:33:04,292 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:04,292 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:04,292 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:33:04,295 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:33:04,296 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:33:04,296 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:33:04,302 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:33:04,303 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:33:04,303 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:04,303 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:04,303 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:33:04,303 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:33:04,303 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:33:04,303 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:04,303 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:04,303 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:33:04,307 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:33:04,307 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:33:04,307 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:33:04,315 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:33:04,315 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:33:04,315 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:04,315 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:04,315 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:33:04,322 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:33:04,322 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:33:04,461 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:33:04,461 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:33:04,462 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:04,462 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:04,462 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:33:04,464 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:33:04,464 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:33:04,773 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:33:04,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:33:04,773 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:04,912 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:33:04,912 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:33:04,913 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:04,913 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:04,913 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:33:04,926 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:33:04,927 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:33:23,795 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:33:23,795 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:33:23,795 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:23,795 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:23,795 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:33:23,795 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:33:23,795 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:33:23,795 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:23,795 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:23,795 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:33:23,798 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:33:23,798 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:33:23,798 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:33:24,402 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:33:24,402 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:33:24,403 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:24,403 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:24,403 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:33:24,403 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:33:24,403 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:33:24,403 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:24,404 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:24,404 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:33:24,408 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:33:24,408 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:33:24,408 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:33:27,529 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:33:27,529 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:33:27,530 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:27,530 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:27,530 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:33:27,534 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:33:27,534 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:33:30,188 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:33:30,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:33:30,189 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:30,189 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:33:30,189 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:33:30,197 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:33:30,198 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:33:41,653 - INFO - app.core.security - Closing Redis connection...
2025-07-02 04:33:41,655 - INFO - app.core.security - Redis connection closed.
2025-07-02 04:34:43,585 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-02 04:34:43,586 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-02 04:34:43,589 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-02 04:34:43,589 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-02 04:34:43,592 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 04:34:43,592 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 04:34:43,592 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 04:34:43,592 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 2, 12, 9, 43, 592612), 'iat': datetime.datetime(2025, 7, 2, 11, 34, 43, 592614)}
2025-07-02 04:34:43,592 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 04:34:47,088 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:34:47,088 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:34:47,088 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:34:47,089 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457783, 'iat': 1751455983}
2025-07-02 04:34:47,089 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:34:47,096 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:34:47,096 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:34:47,096 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE0NTc3ODMsImlhdCI6MTc1MTQ1NTk4M30.cqnFrdQjNIOqPMo1PvLh2hDsG1uvAFc_6Y0Td0CTb5k
2025-07-02 04:34:47,097 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE0NTc3ODMsImlhdCI6MTc1MTQ1NTk4M30.cqnFrdQjNIOqPMo1PvLh2hDsG1uvAFc_6Y0Td0CTb5k
2025-07-02 04:34:58,785 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 04:34:58,785 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 04:34:58,785 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 04:34:58,785 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 2, 12, 4, 58, 785086), 'iat': datetime.datetime(2025, 7, 2, 11, 34, 58, 785102)}
2025-07-02 04:34:58,786 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 04:34:58,786 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIwNjA4OTgsImlhdCI6MTc1MTQ1NjA5OH0.Qx3nqtJvtu2ztffuptcSBnb_WQkqOBkyjfSa75qofjw, Expiry (seconds): 604800
2025-07-02 04:34:58,797 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-02 04:34:59,909 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:34:59,915 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:34:59,921 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:34:59,922 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:34:59,922 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:34:59,923 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:34:59,923 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:34:59,923 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:34:59,923 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:34:59,923 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:34:59,930 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:34:59,931 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:34:59,931 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:34:59,945 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:34:59,945 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:34:59,945 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:34:59,945 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:34:59,946 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:34:59,946 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:34:59,946 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:34:59,946 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:34:59,946 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:34:59,946 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:34:59,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:34:59,949 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:34:59,949 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:34:59,949 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:34:59,949 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:34:59,954 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:34:59,955 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:34:59,955 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:34:59,974 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:34:59,975 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:35:00,399 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:35:00,399 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:35:00,399 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:35:00,400 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:35:00,400 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:35:00,403 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:35:00,403 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:35:00,629 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:35:00,629 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:35:00,630 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:35:00,630 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:35:00,630 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:35:00,634 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:35:00,634 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:35:00,932 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:35:00,932 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:35:00,933 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:35:08,728 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:35:08,729 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:35:08,729 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:35:08,729 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:35:08,730 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:35:08,730 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:35:08,730 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:35:08,730 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:35:08,731 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:35:08,731 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:35:08,734 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:35:08,735 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:35:08,735 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:35:11,421 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:35:11,421 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:35:11,421 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:35:11,422 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:35:11,422 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:35:11,422 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:35:11,422 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:35:11,422 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:35:11,422 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:35:11,422 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:35:11,428 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:35:11,429 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:35:11,429 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:35:14,807 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:35:14,807 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:35:14,808 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:35:14,808 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:35:14,809 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:35:14,822 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:35:14,822 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:35:18,106 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:35:18,107 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:35:18,107 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:35:18,107 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:35:18,108 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:35:18,116 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:35:18,116 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:35:24,731 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:35:24,731 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:35:24,732 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:35:24,732 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751457898, 'iat': 1751456098}
2025-07-02 04:35:24,733 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 04:35:24,738 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 04:35:24,738 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 04:35:24,738 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE0NTc4OTgsImlhdCI6MTc1MTQ1NjA5OH0.ho-wKGflgilxMY_Diq3RZCBFjqX6rHwYlw-Dv71pOg0
2025-07-02 04:35:24,740 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE0NTc4OTgsImlhdCI6MTc1MTQ1NjA5OH0.ho-wKGflgilxMY_Diq3RZCBFjqX6rHwYlw-Dv71pOg0
2025-07-02 04:35:37,011 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 04:35:37,012 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 04:35:37,013 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 04:35:37,013 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 2, 12, 5, 37, 11703), 'iat': datetime.datetime(2025, 7, 2, 11, 35, 37, 11737)}
2025-07-02 04:35:37,014 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 04:35:37,015 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIwNjA5MzcsImlhdCI6MTc1MTQ1NjEzN30.LhMV4SnWqTRtDM3f3spLBLRWzMVX1iYPipcKl7-aaUo, Expiry (seconds): 604800
2025-07-02 04:35:37,021 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-02 04:35:38,165 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:35:38,166 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:35:38,166 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:35:38,166 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:35:38,166 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:35:38,166 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:35:38,166 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:35:38,166 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:35:38,166 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:35:38,167 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:35:38,172 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:35:38,172 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:35:38,172 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:35:38,179 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:35:38,179 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:35:38,180 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:35:38,180 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:35:38,180 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:35:38,180 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:35:38,180 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:35:38,181 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:35:38,181 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:35:38,181 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:35:38,185 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:35:38,185 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:35:38,185 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:35:38,187 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:35:38,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:35:38,188 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:35:38,188 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:35:38,188 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:35:38,195 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:35:38,195 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:35:38,475 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:35:38,475 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:35:38,475 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:35:38,475 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:35:38,475 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:35:38,481 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:35:38,481 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:35:38,724 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:35:38,724 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:35:38,724 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:35:38,724 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:35:38,724 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:35:38,731 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:35:38,731 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:35:38,985 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:35:38,985 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:35:38,986 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:35:48,966 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:35:48,966 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:35:48,967 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:35:48,967 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:35:48,967 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:35:48,977 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:35:48,977 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:36:03,063 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:36:03,063 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:36:03,064 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:36:03,064 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:36:03,065 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:36:03,072 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:36:03,073 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:36:06,393 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:36:06,394 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:36:06,394 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:36:06,394 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:36:06,394 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:36:06,400 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:36:06,401 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:36:55,399 - INFO - app.core.security - Closing Redis connection...
2025-07-02 04:36:55,400 - INFO - app.core.security - Redis connection closed.
2025-07-02 04:38:25,758 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-02 04:38:25,758 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-02 04:38:25,763 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-02 04:38:25,763 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-02 04:38:25,769 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 04:38:25,769 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 04:38:25,769 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 04:38:25,769 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 2, 12, 13, 25, 769778), 'iat': datetime.datetime(2025, 7, 2, 11, 38, 25, 769782)}
2025-07-02 04:38:25,770 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 04:38:27,983 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:38:27,983 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:38:27,983 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:38:29,588 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:38:29,588 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:38:29,588 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:38:29,588 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:38:29,588 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:38:29,589 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:38:29,589 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:38:29,589 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:38:29,589 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:38:29,589 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:38:29,594 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:38:29,595 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:38:29,595 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:38:29,615 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:38:29,615 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:38:29,615 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:38:29,615 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:38:29,615 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:38:29,616 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:38:29,616 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:38:29,616 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:38:29,616 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:38:29,616 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:38:29,622 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:38:29,622 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:38:29,622 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:38:29,839 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:38:29,839 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:38:29,840 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:38:29,841 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:38:29,841 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:38:29,845 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:38:29,845 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:38:30,138 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:38:30,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:38:30,139 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:38:30,139 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:38:30,139 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:38:30,144 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:38:30,144 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:38:30,388 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:38:30,389 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:38:30,389 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:38:30,389 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:38:30,389 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:38:30,394 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:38:30,394 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:38:30,451 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:38:30,452 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:38:30,452 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:38:47,162 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:38:47,162 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:38:47,162 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:38:47,163 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:38:47,163 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:38:47,167 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:38:47,167 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:38:58,390 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:38:58,390 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:38:58,390 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:38:58,390 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:38:58,390 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:38:58,396 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:38:58,396 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:39:02,576 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:39:02,576 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:39:02,576 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:39:02,576 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:39:02,576 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:39:02,597 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:39:02,597 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:39:11,579 - INFO - app.core.security - Closing Redis connection...
2025-07-02 04:39:11,580 - INFO - app.core.security - Redis connection closed.
2025-07-02 04:44:43,251 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-02 04:44:43,252 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-02 04:44:43,269 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-02 04:44:43,270 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-02 04:44:43,278 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 04:44:43,278 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 04:44:43,278 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 04:44:43,278 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 2, 12, 19, 43, 278576), 'iat': datetime.datetime(2025, 7, 2, 11, 44, 43, 278582)}
2025-07-02 04:44:43,279 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 04:44:46,938 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:44:46,938 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:44:46,938 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:44:46,938 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:44:46,938 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:44:46,938 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:44:46,938 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:44:46,939 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:44:46,939 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:44:46,939 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:44:46,946 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:44:46,946 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:44:46,946 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:44:46,954 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:44:46,954 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:44:46,955 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:44:46,955 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:44:46,955 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:44:46,955 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:44:46,955 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:44:46,956 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:44:46,956 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:44:46,956 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:44:46,959 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:44:46,959 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:44:46,960 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:44:46,961 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:44:46,961 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:44:46,962 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:44:46,962 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:44:46,962 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:44:46,964 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:44:46,965 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:44:47,087 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:44:47,087 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:44:47,087 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:44:47,087 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:44:47,088 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:44:47,090 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:44:47,090 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:44:47,227 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:44:47,227 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:44:47,227 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:44:47,227 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:44:47,227 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:44:47,230 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:44:47,230 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:44:48,471 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:44:48,471 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:44:48,472 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:44:53,911 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:44:53,911 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:44:53,912 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:44:53,912 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:44:53,912 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:44:53,915 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:44:53,915 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:46:57,282 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:46:57,282 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:46:57,282 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:46:57,282 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:46:57,282 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:46:57,292 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:46:57,292 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:47:16,365 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:47:16,365 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:47:16,366 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:47:16,366 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:47:16,366 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:47:16,373 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:47:16,373 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:47:28,162 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:47:28,162 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:47:28,163 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:47:28,163 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:47:28,163 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:47:28,164 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:47:28,165 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:47:34,479 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:47:34,479 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:47:34,479 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:47:34,479 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:47:34,479 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:47:34,493 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:47:34,493 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:48:21,653 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:48:21,653 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:48:21,653 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:48:21,654 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:48:21,654 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:48:21,654 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:48:21,654 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:48:21,654 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:48:21,654 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:48:21,655 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:48:21,659 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:48:21,659 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:48:21,659 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:48:27,405 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:48:27,406 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:48:27,406 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:48:27,406 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:48:27,407 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:48:27,413 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:48:27,414 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:51:56,258 - INFO - app.core.security - Closing Redis connection...
2025-07-02 04:51:56,260 - INFO - app.core.security - Redis connection closed.
2025-07-02 04:51:58,297 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-02 04:51:58,298 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-02 04:51:58,300 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-02 04:51:58,300 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-02 04:51:58,303 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 04:51:58,303 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 04:51:58,303 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 04:51:58,303 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 2, 12, 26, 58, 303578), 'iat': datetime.datetime(2025, 7, 2, 11, 51, 58, 303580)}
2025-07-02 04:51:58,303 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 04:52:00,138 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:52:00,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:52:00,138 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:52:23,840 - INFO - app.core.security - Closing Redis connection...
2025-07-02 04:52:23,841 - INFO - app.core.security - Redis connection closed.
2025-07-02 04:52:28,633 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-02 04:52:28,633 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-02 04:52:28,637 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-02 04:52:28,637 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-02 04:52:28,641 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 04:52:28,641 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 04:52:28,641 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 04:52:28,641 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 2, 12, 27, 28, 641645), 'iat': datetime.datetime(2025, 7, 2, 11, 52, 28, 641647)}
2025-07-02 04:52:28,642 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 04:52:30,646 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:52:30,646 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:52:30,646 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:52:36,706 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:52:36,706 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:52:36,706 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:52:36,706 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:52:36,706 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:52:36,711 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:52:36,711 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:52:41,171 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:52:41,171 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:52:41,172 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:52:41,172 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:52:41,172 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:52:41,176 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:52:41,177 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:54:06,644 - INFO - app.core.security - Closing Redis connection...
2025-07-02 04:54:06,647 - INFO - app.core.security - Redis connection closed.
2025-07-02 04:55:47,711 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-02 04:55:47,711 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-02 04:55:47,713 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-02 04:55:47,713 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-02 04:55:47,716 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 04:55:47,716 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 04:55:47,716 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 04:55:47,716 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 2, 12, 30, 47, 716405), 'iat': datetime.datetime(2025, 7, 2, 11, 55, 47, 716407)}
2025-07-02 04:55:47,716 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 04:55:52,520 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:55:52,520 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:55:52,521 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:55:52,521 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:55:52,521 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:55:52,521 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:55:52,521 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:55:52,521 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:55:52,521 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:55:52,521 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:55:52,531 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:55:52,531 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:55:52,531 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:55:52,547 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:55:52,548 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:55:52,548 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:55:52,548 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:55:52,548 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:55:52,549 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:55:52,549 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:55:52,549 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:55:52,549 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:55:52,550 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:55:52,554 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:55:52,554 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:55:52,556 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:55:52,556 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:55:52,556 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:55:52,560 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:55:52,561 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:55:52,561 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:55:52,570 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:55:52,570 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:55:52,769 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:55:52,769 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:55:52,769 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:55:52,770 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:55:52,770 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:55:52,774 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:55:52,774 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:55:52,885 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:55:52,889 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:55:52,891 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:55:52,891 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:55:52,891 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:55:52,901 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:55:52,901 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:55:53,303 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:55:53,303 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:55:53,304 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:55:56,569 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:55:56,569 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:55:56,569 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:55:56,571 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:55:56,571 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:55:56,579 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:55:56,579 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:55:59,299 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:55:59,299 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:55:59,300 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:55:59,300 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:55:59,301 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:55:59,310 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:55:59,310 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:56:15,780 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:56:15,780 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:56:15,781 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:56:15,781 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:56:15,781 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:56:15,781 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:56:15,781 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:56:15,781 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:56:15,781 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:56:15,781 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:56:15,787 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:56:15,787 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:56:15,787 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:56:15,793 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:56:15,793 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:56:15,793 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:56:15,793 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:56:15,793 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 04:56:15,794 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:56:15,794 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:56:15,794 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:56:15,794 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:56:15,794 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:56:15,798 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:56:15,799 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:56:15,799 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:56:15,804 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:56:15,804 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:56:15,804 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:56:15,804 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:56:15,805 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:56:15,809 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:56:15,810 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:56:16,073 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:56:16,074 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:56:16,074 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:56:16,074 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:56:16,075 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:56:16,079 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:56:16,079 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:56:16,666 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:56:16,666 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:56:16,667 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:56:16,667 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:56:16,667 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:56:16,672 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:56:16,672 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:56:16,743 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:56:16,743 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:56:16,744 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:56:35,436 - INFO - app.core.security - Closing Redis connection...
2025-07-02 04:56:35,437 - INFO - app.core.security - Redis connection closed.
2025-07-02 04:56:55,734 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-02 04:56:55,734 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-02 04:56:55,737 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-02 04:56:55,738 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-02 04:56:55,745 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 04:56:55,745 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 04:56:55,745 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 04:56:55,745 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 2, 12, 31, 55, 745602), 'iat': datetime.datetime(2025, 7, 2, 11, 56, 55, 745605)}
2025-07-02 04:56:55,746 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 04:56:57,212 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:56:57,212 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:56:57,212 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:57:33,998 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 04:57:33,998 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 04:57:33,998 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:57:33,998 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 04:57:33,998 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 04:57:34,000 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 04:57:34,000 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 04:57:57,969 - INFO - app.core.security - Closing Redis connection...
2025-07-02 04:57:57,970 - INFO - app.core.security - Redis connection closed.
2025-07-02 05:00:09,233 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-02 05:00:09,233 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-02 05:00:09,238 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-02 05:00:09,238 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-02 05:00:09,243 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 05:00:09,243 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 05:00:09,243 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 05:00:09,243 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 2, 12, 35, 9, 243091), 'iat': datetime.datetime(2025, 7, 2, 12, 0, 9, 243097)}
2025-07-02 05:00:09,243 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 05:00:13,147 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 05:00:13,147 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 05:00:13,147 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 05:00:16,832 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 05:00:16,833 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 05:00:16,833 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 05:00:16,833 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 05:00:16,834 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 05:00:16,841 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 05:00:16,841 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 05:00:23,069 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 05:00:23,069 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 05:00:23,069 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 05:00:23,069 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751457937, 'iat': 1751456137}
2025-07-02 05:00:23,069 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 05:00:23,070 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 05:00:23,071 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 05:00:34,731 - INFO - app.core.security - Closing Redis connection...
2025-07-02 05:00:34,733 - INFO - app.core.security - Redis connection closed.
2025-07-02 23:08:41,166 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-02 23:08:41,166 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-02 23:08:41,170 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-02 23:08:41,170 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-02 23:08:41,173 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 23:08:41,173 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 23:08:41,173 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 23:08:41,173 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 6, 43, 41, 173600), 'iat': datetime.datetime(2025, 7, 3, 6, 8, 41, 173603)}
2025-07-02 23:08:41,174 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 23:08:43,678 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:08:43,678 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:08:43,678 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1752124706, 'iat': 1751519906}
2025-07-02 23:08:43,678 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIxMjQ3MDYsImlhdCI6MTc1MTUxOTkwNn0.IUD5kfz9syhYAzSvfLVe8NfbNIHbRQyjRXIYqrhnSAU
2025-07-02 23:08:43,683 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 23:08:43,683 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 23:08:43,683 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 23:08:43,683 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 3, 6, 38, 43, 683650), 'iat': datetime.datetime(2025, 7, 3, 6, 8, 43, 683653)}
2025-07-02 23:08:43,683 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 23:08:43,684 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIxMjc3MjMsImlhdCI6MTc1MTUyMjkyM30.mGBJLPTGjiv0AQHH1kkbfdWv2AohcNHDEMUaII7qi9I, Expiry (seconds): 604800
2025-07-02 23:08:43,684 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-02 23:08:43,733 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:08:43,733 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:08:43,733 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-02 23:08:45,018 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:08:45,018 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:08:45,019 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524723, 'iat': 1751522923}
2025-07-02 23:08:45,019 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524723, 'iat': 1751522923}
2025-07-02 23:08:45,019 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:08:45,023 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:08:45,023 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:08:45,024 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1MjQ3MjMsImlhdCI6MTc1MTUyMjkyM30.PIXFobeJgW01teNetoXWN_Eo5R5pJc6thm4zMTaoTJ0
2025-07-02 23:08:45,024 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1MjQ3MjMsImlhdCI6MTc1MTUyMjkyM30.PIXFobeJgW01teNetoXWN_Eo5R5pJc6thm4zMTaoTJ0
2025-07-02 23:08:58,860 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 23:08:58,860 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 23:08:58,861 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 23:08:58,861 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 3, 6, 38, 58, 860290), 'iat': datetime.datetime(2025, 7, 3, 6, 8, 58, 860301)}
2025-07-02 23:08:58,861 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 23:08:58,861 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIxMjc3MzgsImlhdCI6MTc1MTUyMjkzOH0.Lbe4xObU0sA2DEvqIb9y7ejT0QBd74uCMefeZqrGuR4, Expiry (seconds): 604800
2025-07-02 23:08:58,863 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-02 23:08:59,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:08:59,949 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:08:59,949 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:08:59,949 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:08:59,949 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:08:59,949 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:08:59,949 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:08:59,950 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:08:59,950 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:08:59,950 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 23:08:59,953 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 23:08:59,953 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:08:59,953 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:08:59,969 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:08:59,969 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:08:59,970 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:08:59,970 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:08:59,970 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:08:59,970 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:08:59,970 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:08:59,971 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:08:59,971 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:08:59,971 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 23:08:59,976 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 23:08:59,976 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:08:59,976 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:08:59,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:08:59,979 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:08:59,979 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:08:59,980 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:08:59,980 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 23:08:59,983 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 23:08:59,983 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:09:00,150 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:09:00,151 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:09:00,151 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:00,151 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:00,151 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 23:09:00,154 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 23:09:00,154 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:09:00,288 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:09:00,288 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:09:00,289 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:00,289 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:00,289 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 23:09:00,291 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 23:09:00,291 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:09:00,460 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:09:00,460 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:09:00,460 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:04,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:09:04,904 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:09:04,904 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:04,904 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:04,904 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:09:04,904 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:09:04,904 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:09:04,904 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:04,904 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:04,904 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 23:09:04,907 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 23:09:04,907 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:09:04,907 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:09:05,792 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:09:05,792 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:09:05,792 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:05,793 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:05,793 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:09:05,793 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:09:05,793 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:09:05,793 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:05,793 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:05,793 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 23:09:05,798 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 23:09:05,798 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:09:05,798 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:09:06,348 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:09:06,348 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:09:06,348 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:06,348 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:06,348 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:09:06,349 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:09:06,349 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:09:06,349 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:06,349 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:06,349 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 23:09:06,353 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 23:09:06,353 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:09:06,354 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:09:10,058 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:09:10,058 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:09:10,058 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:10,058 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:10,058 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 23:09:10,061 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 23:09:10,061 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:09:14,544 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:09:14,544 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:09:14,545 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:14,545 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:09:14,545 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 23:09:14,592 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 23:09:14,592 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:10:08,269 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:10:08,269 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:10:08,269 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:10:08,269 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751524738, 'iat': 1751522938}
2025-07-02 23:10:08,269 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 23:10:08,271 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 23:10:08,271 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:10:08,271 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE1MjQ3MzgsImlhdCI6MTc1MTUyMjkzOH0.3ix9U8wgwx6q1BK-6TPPCt8eE-PzeQ_Ic-KEl1vgCV4
2025-07-02 23:10:08,271 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE1MjQ3MzgsImlhdCI6MTc1MTUyMjkzOH0.3ix9U8wgwx6q1BK-6TPPCt8eE-PzeQ_Ic-KEl1vgCV4
2025-07-02 23:10:18,076 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 23:10:18,076 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 23:10:18,076 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 23:10:18,076 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 3, 6, 40, 18, 76334), 'iat': datetime.datetime(2025, 7, 3, 6, 10, 18, 76339)}
2025-07-02 23:10:18,077 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 23:10:18,077 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIxMjc4MTgsImlhdCI6MTc1MTUyMzAxOH0.uwPQwcdRjw0N94yj2xDYcAipBO37pwFIdqYim5KaY2Y, Expiry (seconds): 604800
2025-07-02 23:10:18,081 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-02 23:10:19,188 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:10:19,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:10:19,188 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524818, 'iat': 1751523018}
2025-07-02 23:10:19,188 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524818, 'iat': 1751523018}
2025-07-02 23:10:19,188 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:10:19,188 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:10:19,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:10:19,188 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524818, 'iat': 1751523018}
2025-07-02 23:10:19,188 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524818, 'iat': 1751523018}
2025-07-02 23:10:19,188 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:10:19,192 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:10:19,192 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:10:19,192 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:10:19,197 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:10:19,197 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:10:19,198 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524818, 'iat': 1751523018}
2025-07-02 23:10:19,198 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524818, 'iat': 1751523018}
2025-07-02 23:10:19,198 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:10:19,198 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:10:19,198 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:10:19,198 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524818, 'iat': 1751523018}
2025-07-02 23:10:19,198 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524818, 'iat': 1751523018}
2025-07-02 23:10:19,198 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:10:19,200 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:10:19,200 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:10:19,200 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524818, 'iat': 1751523018}
2025-07-02 23:10:19,200 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524818, 'iat': 1751523018}
2025-07-02 23:10:19,200 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:10:19,201 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:10:19,201 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:10:19,201 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:10:19,206 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:10:19,206 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:10:19,371 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:10:19,371 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:10:19,371 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524818, 'iat': 1751523018}
2025-07-02 23:10:19,371 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524818, 'iat': 1751523018}
2025-07-02 23:10:19,371 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:10:19,374 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:10:19,374 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:10:19,491 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:10:19,491 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:10:19,491 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524818, 'iat': 1751523018}
2025-07-02 23:10:19,491 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524818, 'iat': 1751523018}
2025-07-02 23:10:19,491 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:10:19,494 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:10:19,494 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:10:19,677 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:10:19,677 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:10:19,677 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524818, 'iat': 1751523018}
2025-07-02 23:10:29,669 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:10:29,669 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:10:29,670 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524818, 'iat': 1751523018}
2025-07-02 23:10:29,670 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524818, 'iat': 1751523018}
2025-07-02 23:10:29,670 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:10:29,672 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:10:29,672 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:11:10,966 - INFO - app.core.security - Closing Redis connection...
2025-07-02 23:11:10,968 - INFO - app.core.security - Redis connection closed.
2025-07-02 23:35:40,524 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-02 23:35:40,524 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-02 23:35:40,529 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-02 23:35:40,529 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-02 23:35:40,534 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 23:35:40,534 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 23:35:40,534 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 23:35:40,534 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 7, 10, 40, 534463), 'iat': datetime.datetime(2025, 7, 3, 6, 35, 40, 534464)}
2025-07-02 23:35:40,534 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 23:35:44,584 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:35:44,584 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:35:44,585 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524818, 'iat': 1751523018}
2025-07-02 23:35:45,107 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:35:45,107 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:35:45,107 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524818, 'iat': 1751523018}
2025-07-02 23:35:45,107 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751524818, 'iat': 1751523018}
2025-07-02 23:35:45,108 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:35:45,112 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:35:45,112 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:35:45,112 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1MjQ4MTgsImlhdCI6MTc1MTUyMzAxOH0.AyzDQM0xsYKqg5x7u3bi5-yJ8ttETHPcldAWi56MO_U
2025-07-02 23:35:45,113 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1MjQ4MTgsImlhdCI6MTc1MTUyMzAxOH0.AyzDQM0xsYKqg5x7u3bi5-yJ8ttETHPcldAWi56MO_U
2025-07-02 23:35:58,911 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 23:35:58,911 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 23:35:58,911 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 23:35:58,911 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 3, 7, 5, 58, 911512), 'iat': datetime.datetime(2025, 7, 3, 6, 35, 58, 911520)}
2025-07-02 23:35:58,912 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 23:35:58,912 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIxMjkzNTgsImlhdCI6MTc1MTUyNDU1OH0.pWGYNTeCqmVUkRZ2I6gplXimGBHpQ20__QA4_k7bkqc, Expiry (seconds): 604800
2025-07-02 23:35:58,936 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-02 23:36:00,044 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:36:00,044 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:36:00,044 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751526358, 'iat': 1751524558}
2025-07-02 23:36:00,044 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751526358, 'iat': 1751524558}
2025-07-02 23:36:00,045 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:36:00,045 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:36:00,045 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:36:00,045 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751526358, 'iat': 1751524558}
2025-07-02 23:36:00,045 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751526358, 'iat': 1751524558}
2025-07-02 23:36:00,045 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:36:00,048 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:36:00,049 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:36:00,049 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:36:00,052 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:36:00,053 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:36:00,053 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751526358, 'iat': 1751524558}
2025-07-02 23:36:00,053 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751526358, 'iat': 1751524558}
2025-07-02 23:36:00,053 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:36:00,053 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:36:00,054 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:36:00,054 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751526358, 'iat': 1751524558}
2025-07-02 23:36:00,054 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751526358, 'iat': 1751524558}
2025-07-02 23:36:00,054 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:36:00,058 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:36:00,058 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:36:00,058 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751526358, 'iat': 1751524558}
2025-07-02 23:36:00,058 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751526358, 'iat': 1751524558}
2025-07-02 23:36:00,058 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:36:00,061 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:36:00,061 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:36:00,061 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:36:00,063 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:36:00,063 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:36:00,223 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:36:00,223 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:36:00,223 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751526358, 'iat': 1751524558}
2025-07-02 23:36:00,223 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751526358, 'iat': 1751524558}
2025-07-02 23:36:00,224 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:36:00,227 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:36:00,228 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:36:00,544 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:36:00,544 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:36:00,544 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751526358, 'iat': 1751524558}
2025-07-02 23:36:00,619 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:36:00,619 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:36:00,619 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751526358, 'iat': 1751524558}
2025-07-02 23:36:00,619 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751526358, 'iat': 1751524558}
2025-07-02 23:36:00,619 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:36:00,634 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:36:00,635 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:36:07,543 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:36:07,543 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:36:07,543 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751526358, 'iat': 1751524558}
2025-07-02 23:36:07,543 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751526358, 'iat': 1751524558}
2025-07-02 23:36:07,543 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:36:07,546 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:36:07,546 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:36:36,406 - INFO - app.core.security - Closing Redis connection...
2025-07-02 23:36:36,409 - INFO - app.core.security - Redis connection closed.
2025-07-02 23:48:32,752 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-02 23:48:32,752 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-02 23:48:32,760 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-02 23:48:32,760 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-02 23:48:32,767 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 23:48:32,767 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 23:48:32,767 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 23:48:32,767 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 7, 23, 32, 767199), 'iat': datetime.datetime(2025, 7, 3, 6, 48, 32, 767202)}
2025-07-02 23:48:32,769 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 23:48:38,880 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:48:38,881 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:48:38,882 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751526358, 'iat': 1751524558}
2025-07-02 23:48:54,602 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:48:54,602 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:48:54,602 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751526358, 'iat': 1751524558}
2025-07-02 23:48:54,603 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751526358, 'iat': 1751524558}
2025-07-02 23:48:54,603 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:48:54,608 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:48:54,609 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:48:54,609 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1MjYzNTgsImlhdCI6MTc1MTUyNDU1OH0.W3I8BS5Blb-M4_bMosYwgcy2GQBTFOtCLNr-Q_KCI28
2025-07-02 23:48:54,611 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1MjYzNTgsImlhdCI6MTc1MTUyNDU1OH0.W3I8BS5Blb-M4_bMosYwgcy2GQBTFOtCLNr-Q_KCI28
2025-07-02 23:49:05,931 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 23:49:05,931 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 23:49:05,931 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 23:49:05,931 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 3, 7, 19, 5, 931003), 'iat': datetime.datetime(2025, 7, 3, 6, 49, 5, 931015)}
2025-07-02 23:49:05,932 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 23:49:05,932 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIxMzAxNDUsImlhdCI6MTc1MTUyNTM0NX0.ObOC8cFVQ1fMtuDjqlYRXNottj-ReR2n5esIKrbimfk, Expiry (seconds): 604800
2025-07-02 23:49:05,937 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-02 23:49:07,084 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:49:07,084 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:49:07,085 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:07,085 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:07,085 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:49:07,085 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:49:07,085 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:49:07,085 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:07,085 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:07,086 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:49:07,090 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:49:07,090 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:49:07,090 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:49:07,099 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:49:07,099 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:49:07,100 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:07,100 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:07,100 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:49:07,100 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:49:07,100 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:49:07,101 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:07,101 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:07,101 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:49:07,105 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:49:07,105 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:49:07,105 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:49:07,109 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:49:07,109 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:49:07,109 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:07,109 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:07,109 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:49:07,115 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:49:07,115 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:49:07,343 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:49:07,344 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:49:07,344 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:07,344 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:07,344 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:49:07,348 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:49:07,348 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:49:07,732 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:49:07,733 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:49:07,733 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:07,733 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:07,733 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:49:07,740 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:49:07,740 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:49:07,870 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:49:07,870 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:49:07,871 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:15,463 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:49:15,463 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:49:15,463 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:15,463 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:15,463 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:49:15,463 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:49:15,463 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:49:15,464 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:15,464 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:15,464 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:49:15,467 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:49:15,468 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:49:15,468 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:49:16,025 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:49:16,025 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:49:16,026 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:16,026 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:16,026 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:49:16,026 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:49:16,026 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:49:16,026 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:16,027 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:16,027 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:49:16,032 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:49:16,033 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:49:16,033 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:49:16,582 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:49:16,582 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:49:16,583 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:16,583 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:16,583 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:49:16,583 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:49:16,583 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:49:16,584 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:16,584 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:49:16,584 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:49:16,589 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:49:16,589 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:49:16,590 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:50:00,984 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:50:00,984 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:50:00,984 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:50:00,985 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:50:00,985 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:50:00,992 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:50:00,992 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:50:06,388 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:50:06,389 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:50:06,390 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:50:06,390 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:50:06,390 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:50:06,398 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:50:06,398 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:50:11,934 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:50:11,934 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:50:11,935 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:50:11,935 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:50:11,935 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:50:11,935 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:50:11,935 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:50:11,936 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:50:11,936 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:50:11,936 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:50:11,941 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:50:11,941 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:50:11,942 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:54:01,519 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:54:01,519 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:54:01,519 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:54:01,519 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527145, 'iat': 1751525345}
2025-07-02 23:54:01,519 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:54:01,521 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:54:01,521 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:54:01,522 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1MjcxNDUsImlhdCI6MTc1MTUyNTM0NX0.HJElaLIXW6ezlWBI4jdeHJlxDN1VTPj8BuOW3oNXsx8
2025-07-02 23:54:01,522 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1MjcxNDUsImlhdCI6MTc1MTUyNTM0NX0.HJElaLIXW6ezlWBI4jdeHJlxDN1VTPj8BuOW3oNXsx8
2025-07-02 23:54:15,278 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 23:54:15,279 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 23:54:15,279 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 23:54:15,279 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 3, 7, 24, 15, 278345), 'iat': datetime.datetime(2025, 7, 3, 6, 54, 15, 278368)}
2025-07-02 23:54:15,280 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 23:54:15,281 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIxMzA0NTUsImlhdCI6MTc1MTUyNTY1NX0.xTrgRyRKvfdXXJuke59IlgtibX_5o-sc_0ukqFYwRDA, Expiry (seconds): 604800
2025-07-02 23:54:15,285 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-02 23:54:16,430 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:54:16,431 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:54:16,431 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:16,431 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:16,431 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:54:16,431 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:54:16,431 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:54:16,432 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:16,432 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:16,432 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 23:54:16,436 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 23:54:16,436 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:54:16,436 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:54:16,444 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:54:16,444 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:54:16,444 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:16,445 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:16,445 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:54:16,445 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:54:16,445 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:54:16,445 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:16,445 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:16,446 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 23:54:16,448 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:54:16,448 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:54:16,449 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:16,449 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:16,449 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 23:54:16,452 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 23:54:16,452 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:54:16,452 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:54:16,455 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 23:54:16,456 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:54:16,685 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:54:16,686 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:54:16,687 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:16,687 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:16,687 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 23:54:16,694 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 23:54:16,695 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:54:16,998 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:54:16,998 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:54:16,999 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:17,246 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:54:17,246 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:54:17,247 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:17,247 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:17,247 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 23:54:17,255 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 23:54:17,255 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:54:24,636 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:54:24,636 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:54:24,636 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:24,636 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:24,636 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:54:24,637 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:54:24,637 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:54:24,637 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:24,637 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:24,638 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 23:54:24,642 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 23:54:24,642 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:54:24,643 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:54:25,424 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:54:25,425 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:54:25,427 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:25,428 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:25,429 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:54:25,429 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:54:25,429 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:54:25,430 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:25,431 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:54:25,431 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 23:54:25,451 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 23:54:25,451 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:54:25,452 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:54:31,612 - INFO - app.core.security - Closing Redis connection...
2025-07-02 23:54:31,616 - INFO - app.core.security - Redis connection closed.
2025-07-02 23:57:27,800 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-02 23:57:27,800 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-02 23:57:27,804 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-02 23:57:27,805 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-02 23:57:27,809 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 23:57:27,809 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 23:57:27,809 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 23:57:27,809 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 7, 32, 27, 809796), 'iat': datetime.datetime(2025, 7, 3, 6, 57, 27, 809798)}
2025-07-02 23:57:27,810 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 23:57:33,855 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:57:33,855 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:57:33,855 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:57:55,250 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:57:55,250 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:57:55,251 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:57:55,251 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751527455, 'iat': 1751525655}
2025-07-02 23:57:55,251 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-02 23:57:55,265 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-02 23:57:55,265 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-02 23:57:55,266 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE1Mjc0NTUsImlhdCI6MTc1MTUyNTY1NX0.SGMIZv2c573ogxTt2uje26qmG2VccVjlh93DuTsdzH0
2025-07-02 23:57:55,270 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE1Mjc0NTUsImlhdCI6MTc1MTUyNTY1NX0.SGMIZv2c573ogxTt2uje26qmG2VccVjlh93DuTsdzH0
2025-07-02 23:58:06,736 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-02 23:58:06,737 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-02 23:58:06,738 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-02 23:58:06,738 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 3, 7, 28, 6, 736692), 'iat': datetime.datetime(2025, 7, 3, 6, 58, 6, 736723)}
2025-07-02 23:58:06,739 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-02 23:58:06,740 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIxMzA2ODYsImlhdCI6MTc1MTUyNTg4Nn0.RnmvLMAKVFTyL2QDTrr2hzPERxvufw6dmMkqcLi9t20, Expiry (seconds): 604800
2025-07-02 23:58:06,748 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-02 23:58:07,913 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:58:07,913 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:58:07,913 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-02 23:58:07,913 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-02 23:58:07,913 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:58:07,914 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:58:07,914 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:58:07,914 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-02 23:58:07,914 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-02 23:58:07,914 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:58:07,921 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:58:07,921 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:58:07,921 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:58:07,928 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:58:07,928 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:58:07,929 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-02 23:58:07,929 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-02 23:58:07,929 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:58:07,929 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:58:07,929 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:58:07,930 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-02 23:58:07,930 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-02 23:58:07,930 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:58:07,948 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:58:07,948 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:58:07,948 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:58:07,958 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:58:07,958 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:58:07,959 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-02 23:58:07,959 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-02 23:58:07,959 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:58:07,965 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:58:07,966 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:58:08,196 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:58:08,196 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:58:08,197 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-02 23:58:08,197 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-02 23:58:08,197 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:58:08,201 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:58:08,201 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:58:08,513 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:58:08,513 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:58:08,514 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-02 23:58:08,514 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-02 23:58:08,514 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:58:08,521 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:58:08,522 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:58:08,909 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:58:08,909 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:58:08,910 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-02 23:58:14,773 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:58:14,774 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:58:14,774 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-02 23:58:14,774 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-02 23:58:14,774 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-02 23:58:14,774 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-02 23:58:14,774 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-02 23:58:14,775 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-02 23:58:14,775 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-02 23:58:14,775 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-02 23:58:14,780 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-02 23:58:14,780 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-02 23:58:14,780 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:02:21,872 - INFO - app.core.security - Closing Redis connection...
2025-07-03 00:02:21,872 - INFO - app.core.security - Redis connection closed.
2025-07-03 00:02:24,235 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 00:02:24,235 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 00:02:24,237 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 00:02:24,238 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 00:02:24,241 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 00:02:24,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 00:02:24,241 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 00:02:24,241 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 7, 37, 24, 241177), 'iat': datetime.datetime(2025, 7, 3, 7, 2, 24, 241180)}
2025-07-03 00:02:24,241 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 00:02:26,428 - INFO - app.core.security - Closing Redis connection...
2025-07-03 00:02:26,430 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:02:26,431 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:02:26,431 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-03 00:02:26,433 - INFO - app.core.security - Redis connection closed.
2025-07-03 00:02:28,523 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 00:02:28,524 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 00:02:28,527 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 00:02:28,527 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 00:02:28,530 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 00:02:28,530 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 00:02:28,530 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 00:02:28,530 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 7, 37, 28, 530680), 'iat': datetime.datetime(2025, 7, 3, 7, 2, 28, 530682)}
2025-07-03 00:02:28,531 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 00:02:32,080 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:02:32,080 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:02:32,081 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-03 00:02:33,780 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:02:33,781 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:02:33,782 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-03 00:02:33,782 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-03 00:02:33,782 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 00:02:33,782 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:02:33,782 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:02:33,782 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-03 00:02:33,783 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-03 00:02:33,783 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:02:33,793 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:02:33,793 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:02:33,793 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:02:44,588 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:02:44,588 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:02:44,588 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-03 00:02:44,588 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-03 00:02:44,588 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 00:02:44,588 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:02:44,588 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:02:44,588 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-03 00:02:44,588 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-03 00:02:44,588 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:02:44,591 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:02:44,591 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:02:44,591 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:03:58,038 - INFO - app.core.security - Closing Redis connection...
2025-07-03 00:03:58,045 - INFO - app.core.security - Redis connection closed.
2025-07-03 00:06:29,579 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 00:06:29,580 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 00:06:29,584 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 00:06:29,585 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 00:06:29,589 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 00:06:29,589 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 00:06:29,589 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 00:06:29,589 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 7, 41, 29, 589460), 'iat': datetime.datetime(2025, 7, 3, 7, 6, 29, 589464)}
2025-07-03 00:06:29,589 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 00:06:32,919 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:06:32,920 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:06:32,921 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-03 00:06:32,921 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-03 00:06:32,921 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 00:06:32,922 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:06:32,922 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:06:32,923 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-03 00:06:32,923 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-03 00:06:32,923 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:06:32,931 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:06:32,931 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:06:32,931 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:06:34,203 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:06:34,204 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:06:34,205 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-03 00:11:42,690 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:11:42,690 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:11:42,690 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-03 00:11:42,690 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-03 00:11:42,690 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 00:11:42,690 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:11:42,690 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:11:42,690 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-03 00:11:42,690 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-03 00:11:42,690 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:11:42,692 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:11:42,692 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:11:42,692 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:11:59,677 - INFO - app.core.security - Closing Redis connection...
2025-07-03 00:11:59,678 - INFO - app.core.security - Redis connection closed.
2025-07-03 00:25:13,401 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 00:25:13,401 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 00:25:13,407 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 00:25:13,407 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 00:25:13,410 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 00:25:13,410 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 00:25:13,410 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 00:25:13,410 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 8, 0, 13, 410741), 'iat': datetime.datetime(2025, 7, 3, 7, 25, 13, 410744)}
2025-07-03 00:25:13,411 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 00:25:20,900 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:25:20,900 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:25:20,900 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751527686, 'iat': 1751525886}
2025-07-03 00:25:27,465 - INFO - app.core.security - Closing Redis connection...
2025-07-03 00:25:27,466 - INFO - app.core.security - Redis connection closed.
2025-07-03 00:32:25,409 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 00:32:25,409 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 00:32:25,414 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 00:32:25,414 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 00:32:25,419 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 00:32:25,420 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 00:32:25,420 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 00:32:25,420 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 8, 7, 25, 419956), 'iat': datetime.datetime(2025, 7, 3, 7, 32, 25, 419958)}
2025-07-03 00:32:25,420 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 00:32:29,419 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:32:29,420 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:32:29,420 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1752130686, 'iat': 1751525886}
2025-07-03 00:32:29,420 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIxMzA2ODYsImlhdCI6MTc1MTUyNTg4Nn0.RnmvLMAKVFTyL2QDTrr2hzPERxvufw6dmMkqcLi9t20
2025-07-03 00:32:29,430 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 00:32:29,430 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 00:32:29,430 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 00:32:29,430 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 3, 8, 2, 29, 430254), 'iat': datetime.datetime(2025, 7, 3, 7, 32, 29, 430264)}
2025-07-03 00:32:29,431 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 00:32:29,431 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIxMzI3NDksImlhdCI6MTc1MTUyNzk0OX0.yCLX3GSiLuB6w3MXneqy3VqK3rAsIwZL2o6oIkGrpaQ, Expiry (seconds): 604800
2025-07-03 00:32:29,432 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-03 00:32:29,994 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:32:29,994 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:32:29,995 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 00:32:33,778 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:32:33,778 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:32:33,778 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:32:33,778 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:32:33,778 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 00:32:33,778 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:32:33,779 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:32:33,779 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:32:33,779 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:32:33,779 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:32:33,786 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:32:33,787 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:32:33,787 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:32:33,801 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:32:33,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:32:33,802 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:32:33,802 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:32:33,802 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 00:32:33,802 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:32:33,803 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:32:33,803 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:32:33,803 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:32:33,803 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:32:33,810 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:32:33,810 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:32:33,811 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:32:33,814 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:32:33,815 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:32:33,815 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:32:33,815 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:32:33,815 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:32:33,822 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:32:33,822 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:32:34,038 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:32:34,039 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:32:34,039 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:32:34,039 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:32:34,039 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:32:34,044 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:32:34,044 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:32:34,240 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:32:34,240 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:32:34,240 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:32:34,240 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:32:34,240 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:32:34,245 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:32:34,245 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:32:36,841 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:32:36,842 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:32:36,842 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:32:53,898 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:32:53,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:32:53,899 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:32:53,899 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:32:53,899 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 00:32:53,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:32:53,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:32:53,900 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:32:53,900 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:32:53,901 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:32:53,927 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:32:53,927 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:32:53,927 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:34:27,416 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:34:27,416 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:34:27,417 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:34:27,417 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:34:27,417 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:34:27,425 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:34:27,426 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:36:09,678 - INFO - app.core.security - Closing Redis connection...
2025-07-03 00:36:09,678 - INFO - app.core.security - Redis connection closed.
2025-07-03 00:36:12,645 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 00:36:12,645 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 00:36:12,647 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 00:36:12,647 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 00:36:12,651 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 00:36:12,651 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 00:36:12,651 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 00:36:12,651 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 8, 11, 12, 651127), 'iat': datetime.datetime(2025, 7, 3, 7, 36, 12, 651128)}
2025-07-03 00:36:12,651 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 00:36:14,869 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:36:14,870 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:36:14,870 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:36:28,002 - INFO - app.core.security - Closing Redis connection...
2025-07-03 00:36:28,003 - INFO - app.core.security - Redis connection closed.
2025-07-03 00:38:11,265 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 00:38:11,266 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 00:38:11,272 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 00:38:11,272 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 00:38:11,275 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 00:38:11,275 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 00:38:11,275 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 00:38:11,276 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 8, 13, 11, 275840), 'iat': datetime.datetime(2025, 7, 3, 7, 38, 11, 275842)}
2025-07-03 00:38:11,276 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 00:38:16,860 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:38:16,860 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:38:16,860 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:39:07,653 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:39:07,653 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:39:07,653 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:39:07,653 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:39:07,653 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 00:39:07,653 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:39:07,653 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:39:07,653 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:39:07,653 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:39:07,653 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:39:07,656 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:39:07,656 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:39:07,656 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:39:21,111 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:39:21,111 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:39:21,111 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:39:21,112 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:39:21,112 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:39:21,118 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:39:21,119 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:39:27,218 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:39:27,219 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:39:27,219 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:39:27,219 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:39:27,219 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 00:39:27,220 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:39:27,220 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:39:27,220 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:39:27,220 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:39:27,220 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:39:27,234 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:39:27,235 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:39:27,235 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:40:45,703 - INFO - app.core.security - Closing Redis connection...
2025-07-03 00:40:45,704 - INFO - app.core.security - Redis connection closed.
2025-07-03 00:50:23,721 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 00:50:23,721 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 00:50:23,727 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 00:50:23,728 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 00:50:23,732 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 00:50:23,732 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 00:50:23,732 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 00:50:23,732 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 8, 25, 23, 732842), 'iat': datetime.datetime(2025, 7, 3, 7, 50, 23, 732844)}
2025-07-03 00:50:23,733 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 00:50:29,199 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:50:29,200 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:50:29,200 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:50:33,664 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:50:33,664 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:50:33,664 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:50:33,665 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:50:33,665 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 00:50:33,665 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:50:33,665 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:50:33,665 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:50:33,665 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:50:33,666 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:50:33,673 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:50:33,673 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:50:33,673 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:50:33,690 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:50:33,690 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:50:33,691 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:50:33,691 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:50:33,691 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 00:50:33,691 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:50:33,691 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:50:33,691 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:50:33,692 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:50:33,692 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:50:33,696 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:50:33,696 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:50:33,696 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:50:34,134 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:50:34,138 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:50:34,138 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:50:34,138 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:50:34,138 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:50:34,145 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:50:34,145 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:50:34,399 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:50:34,399 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:50:34,400 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:50:34,400 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:50:34,400 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:50:34,405 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:50:34,405 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:50:34,714 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:50:34,714 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:50:34,714 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:50:34,789 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:50:34,789 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:50:34,789 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:50:34,789 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:50:34,789 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:50:34,800 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:50:34,800 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:50:44,537 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:50:44,538 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:50:44,538 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:50:44,538 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:50:44,538 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 00:50:44,538 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:50:44,538 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:50:44,539 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:50:44,539 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:50:44,539 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:50:44,547 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:50:44,548 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:50:44,548 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:51:22,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:51:22,372 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:51:22,373 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:51:22,373 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:51:22,373 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 00:51:22,373 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:51:22,373 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:51:22,374 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:51:22,374 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:51:22,374 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:51:22,380 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:51:22,380 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:51:22,380 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:53:01,615 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:53:01,616 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:53:01,616 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:53:01,616 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:53:01,616 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 00:53:01,617 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:53:01,617 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:53:01,617 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:53:01,617 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:53:01,617 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:53:01,623 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:53:01,624 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:53:01,624 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:53:04,806 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:53:04,806 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:53:04,807 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:53:04,807 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:53:04,807 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 00:53:04,807 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:53:04,807 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:53:04,808 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:53:04,808 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:53:04,808 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:53:04,813 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:53:04,814 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:53:04,814 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:53:04,833 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:53:04,833 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:53:04,833 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:53:04,834 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:53:04,834 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 00:53:04,834 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:53:04,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:53:04,834 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:53:04,834 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:53:04,834 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:53:04,837 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:53:04,837 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:53:04,838 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:53:04,838 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:53:04,838 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:53:04,840 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:53:04,841 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:53:04,841 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:53:04,844 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:53:04,844 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:53:05,077 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:53:05,077 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:53:05,077 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:53:05,077 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:53:05,078 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:53:05,082 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:53:05,082 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:53:05,315 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:53:05,316 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:53:05,316 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:53:05,316 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:53:05,316 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 00:53:05,321 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 00:53:05,321 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 00:53:05,395 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 00:53:05,395 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 00:53:05,396 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751529749, 'iat': 1751527949}
2025-07-03 00:53:31,584 - INFO - app.core.security - Closing Redis connection...
2025-07-03 00:53:31,585 - INFO - app.core.security - Redis connection closed.
2025-07-03 01:02:53,035 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 01:02:53,035 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 01:02:53,051 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 01:02:53,051 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 01:02:53,056 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 01:02:53,056 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 01:02:53,056 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 01:02:53,056 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 8, 37, 53, 56262), 'iat': datetime.datetime(2025, 7, 3, 8, 2, 53, 56264)}
2025-07-03 01:02:53,056 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 01:02:56,210 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:02:56,210 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:02:56,210 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 01:02:57,353 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:02:57,354 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:02:57,355 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 01:02:57,357 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-03 01:03:10,135 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 01:03:10,136 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 01:03:10,136 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 01:03:10,136 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 3, 8, 33, 10, 134990), 'iat': datetime.datetime(2025, 7, 3, 8, 3, 10, 135018)}
2025-07-03 01:03:10,137 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 01:03:10,138 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIxMzQ1OTAsImlhdCI6MTc1MTUyOTc5MH0.dFNDwHRym0JI26RSmlrl6WarFSDVBlCmzTEW75JBqkE, Expiry (seconds): 604800
2025-07-03 01:03:10,140 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-03 01:03:11,293 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:03:11,294 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:03:11,294 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:11,294 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:11,294 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 01:03:11,294 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:03:11,294 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:03:11,295 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:11,295 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:11,295 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:03:11,307 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:03:11,307 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:03:11,307 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:03:11,317 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:03:11,317 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:03:11,318 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:11,318 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:11,318 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 01:03:11,318 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:03:11,318 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:03:11,318 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:11,318 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:11,318 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:03:11,324 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:03:11,324 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:03:11,325 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:11,325 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:11,325 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:03:11,328 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:03:11,328 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:03:11,328 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:03:11,342 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:03:11,343 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:03:11,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:03:11,631 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:03:11,631 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:11,631 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:11,631 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:03:11,637 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:03:11,637 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:03:11,937 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:03:11,938 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:03:11,938 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:12,484 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:03:12,484 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:03:12,484 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:12,485 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:12,485 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:03:12,490 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:03:12,491 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:03:24,016 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:03:24,017 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:03:24,017 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:24,017 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:24,018 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 01:03:24,018 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:03:24,018 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:03:24,019 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:24,019 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:24,019 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:03:24,026 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:03:24,027 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:03:24,027 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:03:43,191 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:03:43,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:03:43,202 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:43,202 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:43,202 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 01:03:43,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:03:43,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:03:43,203 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:43,203 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:43,203 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:03:43,270 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:03:43,271 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:03:43,271 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:03:44,244 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:03:44,245 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:03:44,245 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:44,245 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:44,245 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 01:03:44,245 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:03:44,245 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:03:44,246 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:44,246 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:44,246 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:03:44,252 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:03:44,253 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:03:44,253 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:03:44,816 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:03:44,817 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:03:44,818 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:44,818 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:44,819 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 01:03:44,819 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:03:44,819 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:03:44,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:44,820 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:44,820 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:03:44,824 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:03:44,824 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:03:44,824 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:03:45,399 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:03:45,399 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:03:45,401 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:45,401 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:45,401 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 01:03:45,401 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:03:45,401 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:03:45,402 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:45,402 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:45,402 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:03:45,415 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:03:45,415 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:03:45,416 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:03:46,356 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:03:46,356 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:03:46,357 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:46,357 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:46,357 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 01:03:46,357 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:03:46,357 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:03:46,358 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:46,358 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:03:46,358 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:03:46,364 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:03:46,364 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:03:46,364 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:04:24,048 - INFO - app.core.security - Closing Redis connection...
2025-07-03 01:04:24,049 - INFO - app.core.security - Redis connection closed.
2025-07-03 01:11:45,350 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 01:11:45,350 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 01:11:45,353 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 01:11:45,353 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 01:11:45,357 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 01:11:45,357 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 01:11:45,357 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 01:11:45,357 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 8, 46, 45, 357651), 'iat': datetime.datetime(2025, 7, 3, 8, 11, 45, 357653)}
2025-07-03 01:11:45,358 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 01:11:49,918 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:11:49,919 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:11:49,920 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:07,764 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:12:07,764 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:12:07,765 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:07,765 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:07,765 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 01:12:07,765 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:12:07,766 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:12:07,766 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:07,766 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:07,766 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:12:07,772 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:12:07,773 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:12:07,773 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:12:07,789 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:12:07,789 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:12:07,789 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:07,790 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:07,790 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 01:12:07,790 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:12:07,790 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:12:07,790 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:07,790 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:07,790 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:12:07,796 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:12:07,796 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:12:07,796 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:12:07,802 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:12:07,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:12:07,803 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:07,803 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:07,803 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:12:07,808 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:12:07,809 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:12:08,023 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:12:08,023 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:12:08,024 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:08,024 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:08,028 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:12:08,061 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:12:08,062 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:12:08,353 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:12:08,353 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:12:08,353 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:08,536 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:12:08,536 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:12:08,536 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:08,537 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:08,537 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:12:08,546 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:12:08,546 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:12:13,217 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:12:13,218 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:12:13,218 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:13,219 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:13,219 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:12:13,227 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:12:13,227 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:12:22,010 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:12:22,010 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:12:22,011 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:22,011 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:22,011 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 01:12:22,011 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:12:22,011 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:12:22,011 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:22,011 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:22,011 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:12:22,043 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:12:22,044 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:12:22,044 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:12:42,765 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:12:42,766 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:12:42,767 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:42,767 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:42,767 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:12:42,788 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:12:42,788 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:12:49,003 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:12:49,003 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:12:49,003 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:49,004 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:49,004 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 01:12:49,004 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:12:49,004 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:12:49,004 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:49,004 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:12:49,004 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:12:49,006 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:12:49,006 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:12:49,006 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:14:59,961 - INFO - app.core.security - Closing Redis connection...
2025-07-03 01:14:59,964 - INFO - app.core.security - Redis connection closed.
2025-07-03 01:17:57,075 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 01:17:57,075 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 01:17:57,078 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 01:17:57,078 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 01:17:57,084 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 01:17:57,084 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 01:17:57,084 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 01:17:57,084 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 8, 52, 57, 84393), 'iat': datetime.datetime(2025, 7, 3, 8, 17, 57, 84398)}
2025-07-03 01:17:57,085 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 01:18:01,451 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:18:01,451 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:18:01,452 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:18:01,452 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:18:01,452 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 01:18:01,452 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:18:01,452 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:18:01,453 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:18:01,453 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:18:01,453 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 01:18:01,465 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 01:18:01,465 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:18:01,465 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 01:18:02,218 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 01:18:02,219 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 01:18:02,219 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751531590, 'iat': 1751529790}
2025-07-03 01:18:19,626 - INFO - app.core.security - Closing Redis connection...
2025-07-03 01:18:19,627 - INFO - app.core.security - Redis connection closed.
2025-07-03 02:54:57,657 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 02:54:57,657 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 02:54:57,660 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 02:54:57,660 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 02:54:57,663 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 02:54:57,663 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 02:54:57,663 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 02:54:57,663 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 10, 29, 57, 663465), 'iat': datetime.datetime(2025, 7, 3, 9, 54, 57, 663467)}
2025-07-03 02:54:57,663 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 02:54:59,381 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 02:54:59,381 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 02:54:59,382 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 02:56:42,696 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 02:56:42,696 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 02:56:42,697 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 02:56:42,698 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 02:56:42,698 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 02:56:42,698 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 02:56:42,698 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 02:56:42,698 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 02:56:42,699 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 02:56:42,699 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 02:56:42,707 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 02:56:42,707 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 02:56:42,708 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 02:56:57,232 - INFO - app.core.security - Closing Redis connection...
2025-07-03 02:56:57,233 - INFO - app.core.security - Redis connection closed.
2025-07-03 02:57:00,395 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 02:57:00,395 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 02:57:00,397 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 02:57:00,397 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 02:57:00,400 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 02:57:00,400 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 02:57:00,400 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 02:57:00,400 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 10, 32, 0, 400794), 'iat': datetime.datetime(2025, 7, 3, 9, 57, 0, 400796)}
2025-07-03 02:57:00,401 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 02:57:01,947 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 02:57:01,947 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 02:57:01,947 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 02:57:59,476 - INFO - app.core.security - Closing Redis connection...
2025-07-03 02:57:59,478 - INFO - app.core.security - Redis connection closed.
2025-07-03 03:00:52,697 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 03:00:52,697 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 03:00:52,699 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 03:00:52,700 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 03:00:52,705 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:00:52,705 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:00:52,705 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:00:52,705 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 10, 35, 52, 705829), 'iat': datetime.datetime(2025, 7, 3, 10, 0, 52, 705831)}
2025-07-03 03:00:52,706 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:00:59,419 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:00:59,420 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:00:59,420 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:01:01,471 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:01:01,471 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:01:01,471 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:01:01,471 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:01:01,472 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:01:01,472 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:01:01,472 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:01:01,472 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:01:01,472 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:01:01,472 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:01:01,480 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:01:01,480 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:01:01,480 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:01:01,500 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:01:01,501 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:01:01,501 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:01:01,501 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:01:01,501 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:01:01,502 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:01:01,502 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:01:01,502 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:01:01,502 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:01:01,502 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:01:01,509 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:01:01,510 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:01:01,510 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:01:01,968 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:01:01,968 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:01:01,968 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:01:01,969 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:01:01,969 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:01:01,972 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:01:01,972 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:01:02,240 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:01:02,240 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:01:02,241 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:01:02,241 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:01:02,241 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:01:02,245 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:01:02,245 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:01:02,422 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:01:02,422 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:01:02,423 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:01:02,423 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:01:02,423 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:01:02,428 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:01:02,428 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:01:02,617 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:01:02,617 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:01:02,617 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:01:09,085 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:01:09,085 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:01:09,085 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:01:09,085 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:01:09,085 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:01:09,085 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:01:09,085 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:01:09,085 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:01:09,086 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:01:09,086 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:01:09,092 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:01:09,092 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:01:09,093 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:03:07,779 - INFO - app.core.security - Closing Redis connection...
2025-07-03 03:03:07,779 - INFO - app.core.security - Redis connection closed.
2025-07-03 03:03:09,896 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 03:03:09,897 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 03:03:09,900 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 03:03:09,900 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 03:03:09,903 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:03:09,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:03:09,903 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:03:09,903 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 10, 38, 9, 903051), 'iat': datetime.datetime(2025, 7, 3, 10, 3, 9, 903053)}
2025-07-03 03:03:09,903 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:03:12,843 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:03:12,843 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:03:12,843 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:03:40,017 - INFO - app.core.security - Closing Redis connection...
2025-07-03 03:03:40,018 - INFO - app.core.security - Redis connection closed.
2025-07-03 03:04:55,748 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 03:04:55,748 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 03:04:55,751 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 03:04:55,751 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 03:04:55,754 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:04:55,754 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:04:55,755 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:04:55,755 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 10, 39, 55, 754941), 'iat': datetime.datetime(2025, 7, 3, 10, 4, 55, 754943)}
2025-07-03 03:04:55,755 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:04:58,430 - INFO - app.core.security - Closing Redis connection...
2025-07-03 03:04:58,430 - INFO - app.core.security - Redis connection closed.
2025-07-03 03:05:00,516 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 03:05:00,516 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 03:05:00,518 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 03:05:00,519 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 03:05:00,522 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:05:00,522 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:05:00,522 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:05:00,522 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 10, 40, 0, 522775), 'iat': datetime.datetime(2025, 7, 3, 10, 5, 0, 522777)}
2025-07-03 03:05:00,523 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:05:03,747 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:05:03,747 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:05:03,747 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:05:06,461 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:05:06,461 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:05:06,461 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:05:06,461 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:05:06,461 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:05:06,461 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:05:06,461 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:05:06,462 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:05:06,462 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:05:06,462 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:05:06,467 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:05:06,467 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:05:06,467 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:05:09,065 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:05:09,065 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:05:09,066 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:05:09,066 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:05:09,066 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:05:09,066 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:05:09,066 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:05:09,066 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:05:09,067 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:05:09,067 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:05:09,072 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:05:09,073 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:05:09,073 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:05:10,414 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:05:10,415 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:05:10,416 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:05:10,416 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:05:10,416 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:05:10,417 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:05:10,417 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:05:10,417 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:05:10,418 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:05:10,418 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:05:10,428 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:05:10,428 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:05:10,428 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:06:51,282 - INFO - app.core.security - Closing Redis connection...
2025-07-03 03:06:51,283 - INFO - app.core.security - Redis connection closed.
2025-07-03 03:08:28,024 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 03:08:28,024 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 03:08:28,027 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 03:08:28,027 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 03:08:28,031 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:08:28,032 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:08:28,032 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:08:28,032 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 10, 43, 28, 31967), 'iat': datetime.datetime(2025, 7, 3, 10, 8, 28, 31969)}
2025-07-03 03:08:28,032 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:08:31,846 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:08:31,846 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:08:31,847 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:34,536 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:08:34,536 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:08:34,536 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:34,536 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:34,537 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:08:34,537 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:08:34,537 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:08:34,537 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:34,537 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:34,537 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:08:34,542 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:08:34,542 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:08:34,542 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:08:34,552 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:08:34,552 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:08:34,553 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:34,553 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:34,553 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:08:34,553 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:08:34,553 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:08:34,554 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:34,554 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:34,554 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:08:34,556 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:08:34,557 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:08:34,557 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:08:34,750 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:08:34,750 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:08:34,750 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:34,750 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:34,750 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:08:34,786 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:08:34,786 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:08:34,988 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:08:34,989 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:08:34,989 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:34,989 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:34,989 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:08:34,993 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:08:34,993 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:08:35,152 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:08:35,152 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:08:35,153 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:35,153 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:35,153 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:08:35,156 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:08:35,156 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:08:35,300 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:08:35,300 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:08:35,300 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:45,049 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:08:45,049 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:08:45,049 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:45,050 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:45,050 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:08:45,057 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:08:45,058 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:08:49,631 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:08:49,631 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:08:49,632 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:49,632 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:49,632 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:08:49,640 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:08:49,640 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:08:55,446 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:08:55,446 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:08:55,446 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:55,447 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:55,447 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:08:55,447 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:08:55,447 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:08:55,447 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:55,447 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:55,447 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:08:55,452 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:08:55,452 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:08:55,452 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:08:56,101 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:08:56,101 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:08:56,101 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:56,102 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:56,102 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:08:56,102 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:08:56,102 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:08:56,102 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:56,102 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:08:56,102 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:08:56,117 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:08:56,117 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:08:56,117 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:09:05,503 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:05,503 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:05,504 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:09:05,504 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751537502, 'iat': 1751535702}
2025-07-03 03:09:05,504 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:09:05,511 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:09:05,512 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:09:05,513 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1Mzc1MDIsImlhdCI6MTc1MTUzNTcwMn0.BEubpbDFm9CYSRrFetF0npn10HE8jpLU_iwxlXLfdvk
2025-07-03 03:09:05,515 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1Mzc1MDIsImlhdCI6MTc1MTUzNTcwMn0.BEubpbDFm9CYSRrFetF0npn10HE8jpLU_iwxlXLfdvk
2025-07-03 03:09:18,805 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:09:18,805 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:09:18,805 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:09:18,805 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 3, 10, 39, 18, 804935), 'iat': datetime.datetime(2025, 7, 3, 10, 9, 18, 804950)}
2025-07-03 03:09:18,806 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:09:18,806 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIxNDIxNTgsImlhdCI6MTc1MTUzNzM1OH0.rOFyeywp6xGgo1tfECEHH5TsUG365Wty-xQ8Lll0qZ4, Expiry (seconds): 604800
2025-07-03 03:09:18,808 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-03 03:09:19,876 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:19,876 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:19,876 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:19,876 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:19,876 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:09:19,876 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:19,877 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:19,877 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:19,877 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:19,877 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-03 03:09:19,883 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-03 03:09:19,883 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-03 03:09:19,883 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-03 03:09:19,889 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:19,889 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:19,889 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:19,889 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:19,890 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:09:19,890 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:19,890 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:19,890 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:19,890 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:19,890 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-03 03:09:19,892 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:19,892 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:19,892 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:19,892 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:19,893 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-03 03:09:19,896 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-03 03:09:19,897 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-03 03:09:19,897 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-03 03:09:19,899 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-03 03:09:19,899 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-03 03:09:20,110 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:20,110 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:20,110 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:20,110 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:20,110 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-03 03:09:20,114 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-03 03:09:20,114 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-03 03:09:20,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:20,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:20,291 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:20,291 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:20,291 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-03 03:09:20,295 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-03 03:09:20,295 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-03 03:09:20,424 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:20,425 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:20,425 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:33,190 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:33,190 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:33,191 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:33,191 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:33,191 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-03 03:09:33,196 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-03 03:09:33,196 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-03 03:09:36,109 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:36,109 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:36,110 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:36,110 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:36,110 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-03 03:09:36,114 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-03 03:09:36,115 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-03 03:09:40,220 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:40,220 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:40,220 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:40,220 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:40,220 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-03 03:09:40,226 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-03 03:09:40,226 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-03 03:09:46,214 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:46,214 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:46,215 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:46,215 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:46,215 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:09:46,216 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:46,216 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:46,217 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:46,218 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:46,218 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-03 03:09:46,232 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-03 03:09:46,232 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-03 03:09:46,232 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-03 03:09:46,884 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:46,884 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:46,884 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:46,884 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:46,884 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:09:46,885 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:46,885 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:46,885 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:46,885 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:46,885 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-03 03:09:46,889 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-03 03:09:46,890 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-03 03:09:46,890 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-03 03:09:47,503 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:47,503 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:47,503 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:47,504 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:47,504 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:09:47,504 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:47,504 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:47,505 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:47,505 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:47,505 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-03 03:09:47,508 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-03 03:09:47,509 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-03 03:09:47,509 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-03 03:09:53,219 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:53,219 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:53,220 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:53,220 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:53,220 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:09:53,220 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:53,220 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:53,221 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:53,221 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:53,221 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-03 03:09:53,235 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-03 03:09:53,235 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-03 03:09:53,235 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-03 03:09:59,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:09:59,373 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:09:59,373 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:59,373 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751539158, 'iat': 1751537358}
2025-07-03 03:09:59,373 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-03 03:09:59,377 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-03 03:09:59,377 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-03 03:09:59,377 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE1MzkxNTgsImlhdCI6MTc1MTUzNzM1OH0.AZ6gHpFsy3DQxQghUkHVM5f7aey4kCOi2zZggsRBzzE
2025-07-03 03:09:59,378 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE1MzkxNTgsImlhdCI6MTc1MTUzNzM1OH0.AZ6gHpFsy3DQxQghUkHVM5f7aey4kCOi2zZggsRBzzE
2025-07-03 03:10:10,760 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:10:10,761 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:10:10,761 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:10:10,762 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 3, 10, 40, 10, 760817), 'iat': datetime.datetime(2025, 7, 3, 10, 10, 10, 760825)}
2025-07-03 03:10:10,762 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:10:10,763 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIxNDIyMTAsImlhdCI6MTc1MTUzNzQxMH0.K-UTpUsj1gpEV2uT1CSPC1BVZ67P6t8eL91a43w7RIc, Expiry (seconds): 604800
2025-07-03 03:10:10,765 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-03 03:10:11,841 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:10:11,841 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:10:11,842 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:10:11,842 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:10:11,842 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:10:11,842 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:10:11,842 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:10:11,843 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:10:11,843 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:10:11,843 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:10:11,847 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:10:11,847 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:10:11,847 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:10:11,852 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:10:11,852 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:10:11,852 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:10:11,852 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:10:11,852 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:10:11,852 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:10:11,853 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:10:11,853 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:10:11,853 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:10:11,853 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:10:11,857 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:10:11,857 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:10:11,857 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:10:11,861 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:10:11,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:10:11,862 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:10:11,863 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:10:11,863 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:10:11,868 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:10:11,868 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:10:12,123 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:10:12,123 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:10:12,124 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:10:12,125 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:10:12,125 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:10:12,131 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:10:12,131 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:10:12,441 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:10:12,441 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:10:12,442 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:10:12,505 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:10:12,506 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:10:12,506 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:10:12,506 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:10:12,506 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:10:12,516 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:10:12,516 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:10:26,342 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:10:26,343 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:10:26,344 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:10:26,344 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:10:26,345 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:10:26,351 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:10:26,352 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:10:52,582 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:10:52,582 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:10:52,582 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:10:52,583 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:10:52,583 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:10:52,596 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:10:52,596 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:11:17,880 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:11:17,880 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:11:17,881 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:11:17,881 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:11:17,881 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:11:17,899 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:11:17,900 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:13:04,869 - INFO - app.core.security - Closing Redis connection...
2025-07-03 03:13:04,870 - INFO - app.core.security - Redis connection closed.
2025-07-03 03:15:23,036 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 03:15:23,037 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 03:15:23,039 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 03:15:23,039 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 03:15:23,042 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:15:23,042 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:15:23,042 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:15:23,042 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 10, 50, 23, 42578), 'iat': datetime.datetime(2025, 7, 3, 10, 15, 23, 42580)}
2025-07-03 03:15:23,042 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:15:25,401 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:15:25,401 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:15:25,401 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:15:28,986 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:15:28,986 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:15:28,987 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:15:28,988 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:15:28,989 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:15:28,989 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:15:28,990 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:15:28,990 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:15:28,991 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:15:28,991 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:15:29,001 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:15:29,002 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:15:29,002 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:15:29,019 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:15:29,020 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:15:29,021 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:15:29,021 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:15:29,022 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:15:29,022 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:15:29,022 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:15:29,023 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:15:29,023 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:15:29,023 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:15:29,028 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:15:29,028 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:15:29,028 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:15:29,029 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:15:29,029 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:15:29,033 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:15:29,033 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:15:29,034 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:15:29,041 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:15:29,041 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:15:29,368 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:15:29,368 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:15:29,369 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:15:29,370 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:15:29,370 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:15:29,375 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:15:29,376 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:15:29,757 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:15:29,758 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:15:29,759 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:15:29,854 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:15:29,855 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:15:29,856 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:15:29,856 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:15:29,856 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:15:29,872 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:15:29,872 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:15:52,583 - INFO - app.core.security - Closing Redis connection...
2025-07-03 03:15:52,606 - INFO - app.core.security - Redis connection closed.
2025-07-03 03:17:56,433 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 03:17:56,434 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 03:17:56,455 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 03:17:56,455 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 03:17:56,461 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:17:56,461 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:17:56,461 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:17:56,462 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 10, 52, 56, 461830), 'iat': datetime.datetime(2025, 7, 3, 10, 17, 56, 461835)}
2025-07-03 03:17:56,462 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:18:04,287 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:18:04,287 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:18:04,287 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:19:11,626 - INFO - app.core.security - Closing Redis connection...
2025-07-03 03:19:11,629 - INFO - app.core.security - Redis connection closed.
2025-07-03 03:21:13,726 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 03:21:13,726 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 03:21:13,730 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 03:21:13,730 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 03:21:13,733 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:21:13,733 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:21:13,733 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:21:13,733 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 10, 56, 13, 733403), 'iat': datetime.datetime(2025, 7, 3, 10, 21, 13, 733405)}
2025-07-03 03:21:13,733 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:21:15,677 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:21:15,677 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:21:15,677 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:21:15,677 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539210, 'iat': 1751537410}
2025-07-03 03:21:15,677 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:21:15,685 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:21:15,685 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:21:15,685 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1MzkyMTAsImlhdCI6MTc1MTUzNzQxMH0.uLYN8Ct1jSdhZ3knB1usesU4CkXmkxgr_yRs0AfBqRg
2025-07-03 03:21:15,686 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1MzkyMTAsImlhdCI6MTc1MTUzNzQxMH0.uLYN8Ct1jSdhZ3knB1usesU4CkXmkxgr_yRs0AfBqRg
2025-07-03 03:21:26,619 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:21:26,619 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:21:26,619 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:21:26,620 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 3, 10, 51, 26, 619568), 'iat': datetime.datetime(2025, 7, 3, 10, 21, 26, 619578)}
2025-07-03 03:21:26,620 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:21:26,620 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIxNDI4ODYsImlhdCI6MTc1MTUzODA4Nn0.6JswYWfgXzJa9hnzgepEnk7bHlZyq_w4-DbyRmfvGs8, Expiry (seconds): 604800
2025-07-03 03:21:26,621 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-03 03:21:27,712 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:21:27,712 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:21:27,712 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:21:27,712 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:21:27,713 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:21:27,713 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:21:27,713 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:21:27,713 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:21:27,713 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:21:27,713 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:21:27,717 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:21:27,717 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:21:27,717 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:21:27,733 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:21:27,734 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:21:27,734 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:21:27,734 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:21:27,734 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:21:27,734 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:21:27,734 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:21:27,735 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:21:27,735 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:21:27,735 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:21:27,738 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:21:27,739 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:21:27,739 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:21:27,739 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:21:27,739 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:21:27,741 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:21:27,741 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:21:27,742 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:21:27,746 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:21:27,747 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:21:28,016 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:21:28,017 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:21:28,018 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:21:28,018 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:21:28,018 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:21:28,023 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:21:28,023 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:21:28,376 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:21:28,376 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:21:28,377 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:21:29,111 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:21:29,112 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:21:29,112 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:21:29,112 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:21:29,112 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:21:29,117 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:21:29,118 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:21:52,659 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:21:52,659 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:21:52,660 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:21:52,660 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:21:52,660 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:21:52,660 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:21:52,660 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:21:52,660 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:21:52,660 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:21:52,660 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:21:52,673 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:21:52,674 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:21:52,674 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:22:07,870 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:22:07,870 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:22:07,870 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:22:07,870 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:22:07,870 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:22:07,873 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:22:07,873 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:22:13,631 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:22:13,631 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:22:13,631 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:22:13,631 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:22:13,631 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:22:13,641 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:22:13,641 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:22:25,399 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:22:25,400 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:22:25,400 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:22:25,400 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:22:25,400 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:22:25,407 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:22:25,407 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:22:38,342 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:22:38,342 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:22:38,342 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:22:38,343 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:22:38,343 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:22:38,347 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:22:38,347 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:22:50,604 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:22:50,605 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:22:50,606 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:22:50,606 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:22:50,606 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:22:50,615 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:22:50,615 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:23:15,941 - INFO - app.core.security - Closing Redis connection...
2025-07-03 03:23:15,942 - INFO - app.core.security - Redis connection closed.
2025-07-03 03:29:05,999 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 03:29:06,000 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 03:29:06,002 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 03:29:06,002 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 03:29:06,005 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:29:06,005 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:29:06,005 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:29:06,005 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 11, 4, 6, 5501), 'iat': datetime.datetime(2025, 7, 3, 10, 29, 6, 5503)}
2025-07-03 03:29:06,005 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:29:11,017 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:29:11,017 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:29:11,017 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:29:11,017 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:29:11,017 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:29:11,017 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:29:11,017 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:29:11,018 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:29:11,018 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:29:11,018 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:29:11,026 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:29:11,027 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:29:11,027 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:29:11,038 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:29:11,038 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:29:11,038 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:29:11,039 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:29:11,039 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:29:11,039 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:29:11,039 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:29:11,039 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:29:11,040 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:29:11,040 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:29:11,043 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:29:11,043 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:29:11,043 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:29:11,043 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:29:11,043 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:29:11,047 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:29:11,047 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:29:11,048 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:29:11,054 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:29:11,054 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:29:11,262 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:29:11,262 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:29:11,262 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:29:11,262 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:29:11,262 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:29:11,265 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:29:11,265 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:29:11,433 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:29:11,434 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:29:11,434 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:29:11,434 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:29:11,434 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:29:11,438 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:29:11,439 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:29:11,575 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:29:11,575 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:29:11,576 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:29:32,499 - INFO - app.core.security - Closing Redis connection...
2025-07-03 03:29:32,500 - INFO - app.core.security - Redis connection closed.
2025-07-03 03:29:54,757 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 03:29:54,757 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 03:29:54,759 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 03:29:54,759 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 03:29:54,762 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:29:54,763 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:29:54,763 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:29:54,763 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 11, 4, 54, 762910), 'iat': datetime.datetime(2025, 7, 3, 10, 29, 54, 762912)}
2025-07-03 03:29:54,763 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:30:00,522 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:30:00,522 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:30:00,522 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:30:05,323 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:30:05,323 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:30:05,324 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:30:05,324 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:30:05,324 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:30:05,327 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:30:05,327 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:30:09,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:30:09,896 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:30:09,896 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:30:09,896 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:30:09,896 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:30:09,896 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:30:09,896 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:30:09,897 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:30:09,897 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:30:09,897 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:30:09,898 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:30:09,899 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:30:09,899 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:30:10,470 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:30:10,470 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:30:10,470 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:30:10,470 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:30:10,470 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:30:10,471 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:30:10,471 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:30:10,471 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:30:10,471 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:30:10,471 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:30:10,473 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:30:10,473 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:30:10,473 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:30:14,485 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:30:14,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:30:14,485 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:30:14,485 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:30:14,485 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:30:14,512 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:30:14,512 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:30:27,152 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:30:27,152 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:30:27,153 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:30:27,153 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:30:27,153 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:30:27,156 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:30:27,156 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:30:46,334 - INFO - app.core.security - Closing Redis connection...
2025-07-03 03:30:46,336 - INFO - app.core.security - Redis connection closed.
2025-07-03 03:32:52,915 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 03:32:52,915 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 03:32:52,917 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 03:32:52,917 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 03:32:52,922 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:32:52,922 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:32:52,922 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:32:52,922 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 11, 7, 52, 922417), 'iat': datetime.datetime(2025, 7, 3, 10, 32, 52, 922419)}
2025-07-03 03:32:52,922 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:32:59,862 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:32:59,862 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:32:59,862 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:33:33,121 - INFO - app.core.security - Closing Redis connection...
2025-07-03 03:33:33,122 - INFO - app.core.security - Redis connection closed.
2025-07-03 03:35:55,393 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 03:35:55,393 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 03:35:55,409 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 03:35:55,409 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 03:35:55,413 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:35:55,413 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:35:55,413 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:35:55,413 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 11, 10, 55, 413869), 'iat': datetime.datetime(2025, 7, 3, 10, 35, 55, 413871)}
2025-07-03 03:35:55,414 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:36:01,431 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:36:01,431 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:36:01,432 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:36:04,169 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:36:04,170 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:36:04,170 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:36:04,170 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751539886, 'iat': 1751538086}
2025-07-03 03:36:04,170 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:36:04,187 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:36:04,187 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:36:04,187 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1Mzk4ODYsImlhdCI6MTc1MTUzODA4Nn0.3tjAq3Nz1dX1wtIBtySWuWZ0AO1wqE6OkGL5p3QtdRQ
2025-07-03 03:36:04,189 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1Mzk4ODYsImlhdCI6MTc1MTUzODA4Nn0.3tjAq3Nz1dX1wtIBtySWuWZ0AO1wqE6OkGL5p3QtdRQ
2025-07-03 03:36:18,056 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:36:18,057 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:36:18,057 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:36:18,058 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 3, 11, 6, 18, 56642), 'iat': datetime.datetime(2025, 7, 3, 10, 36, 18, 56659)}
2025-07-03 03:36:18,058 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:36:18,059 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIxNDM3NzgsImlhdCI6MTc1MTUzODk3OH0.cY_7GN2gVCdFsCl0T_C6b4sQZiHydtEH9WsEqHiK6fE, Expiry (seconds): 604800
2025-07-03 03:36:18,067 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-03 03:36:19,219 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:36:19,219 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:36:19,220 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:19,220 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:19,220 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:36:19,220 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:36:19,221 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:36:19,221 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:19,222 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:19,222 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:36:19,228 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:36:19,228 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:36:19,228 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:36:19,238 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:36:19,238 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:36:19,239 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:19,239 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:19,239 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:36:19,239 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:36:19,239 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:36:19,239 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:19,239 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:19,239 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:36:19,243 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:36:19,244 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:36:19,244 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:19,245 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:19,245 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:36:19,249 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:36:19,249 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:36:19,249 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:36:19,252 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:36:19,252 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:36:19,489 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:36:19,489 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:36:19,489 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:19,490 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:19,490 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:36:19,494 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:36:19,495 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:36:19,838 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:36:19,838 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:36:19,838 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:19,838 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:19,839 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:36:19,843 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:36:19,843 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:36:20,110 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:36:20,110 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:36:20,110 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:40,937 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:36:40,937 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:36:40,938 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:40,938 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:40,938 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:36:41,070 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:36:41,070 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:36:42,375 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:36:42,375 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:36:42,376 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:42,378 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:42,378 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:36:42,378 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:36:42,379 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:36:42,379 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:42,380 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:42,381 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:36:42,394 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:36:42,395 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:36:42,395 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:36:45,964 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:36:45,965 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:36:45,965 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:45,965 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:45,965 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:36:45,987 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:36:45,987 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:36:58,994 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:36:58,995 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:36:58,995 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:58,995 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:36:58,995 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:36:59,000 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:36:59,000 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:38:19,814 - INFO - app.core.security - Closing Redis connection...
2025-07-03 03:38:19,816 - INFO - app.core.security - Redis connection closed.
2025-07-03 03:41:20,703 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 03:41:20,703 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 03:41:20,706 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 03:41:20,706 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 03:41:20,709 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:41:20,709 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:41:20,709 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:41:20,709 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 11, 16, 20, 709379), 'iat': datetime.datetime(2025, 7, 3, 10, 41, 20, 709381)}
2025-07-03 03:41:20,709 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:41:25,771 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:41:25,772 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:41:25,772 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:41:25,772 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:41:25,772 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:41:25,773 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:41:25,773 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:41:25,774 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:41:25,774 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:41:25,774 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:41:25,785 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:41:25,785 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:41:25,785 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:41:27,149 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:41:27,149 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:41:27,149 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:41:30,621 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:41:30,621 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:41:30,622 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:41:30,622 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:41:30,622 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:41:30,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:41:30,622 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:41:30,622 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:41:30,622 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:41:30,622 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:41:30,627 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:41:30,627 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:41:30,627 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:41:36,506 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:41:36,506 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:41:36,507 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:41:36,507 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:41:36,507 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:41:36,871 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:41:36,871 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:41:49,088 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:41:49,088 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:41:49,088 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:41:49,088 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:41:49,088 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:41:49,098 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:41:49,098 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:42:49,394 - INFO - app.core.security - Closing Redis connection...
2025-07-03 03:42:49,395 - INFO - app.core.security - Redis connection closed.
2025-07-03 03:45:05,152 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 03:45:05,152 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 03:45:05,175 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 03:45:05,176 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 03:45:05,180 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:45:05,180 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:45:05,180 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:45:05,180 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 11, 20, 5, 180133), 'iat': datetime.datetime(2025, 7, 3, 10, 45, 5, 180135)}
2025-07-03 03:45:05,180 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:45:07,291 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:45:07,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:45:07,291 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:45:16,100 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:45:16,100 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:45:16,100 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:45:16,101 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751540778, 'iat': 1751538978}
2025-07-03 03:45:16,101 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:45:16,109 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:45:16,110 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:45:16,110 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1NDA3NzgsImlhdCI6MTc1MTUzODk3OH0.1oyMUzWM3ldOp_7ctq7UiB0zsgKA50w_GKjJt44MuJc
2025-07-03 03:45:16,112 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE1NDA3NzgsImlhdCI6MTc1MTUzODk3OH0.1oyMUzWM3ldOp_7ctq7UiB0zsgKA50w_GKjJt44MuJc
2025-07-03 03:45:28,750 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:45:28,750 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:45:28,751 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:45:28,751 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 3, 11, 15, 28, 750400), 'iat': datetime.datetime(2025, 7, 3, 10, 45, 28, 750418)}
2025-07-03 03:45:28,752 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:45:28,753 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIxNDQzMjgsImlhdCI6MTc1MTUzOTUyOH0.RxVEgOv9aNgwQD2lJQhEt6qZP0_b3NpRexbrz9J_UQE, Expiry (seconds): 604800
2025-07-03 03:45:28,756 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-03 03:45:29,944 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:45:29,944 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:45:29,944 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:45:29,944 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:45:29,944 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:45:29,944 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:45:29,944 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:45:29,945 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:45:29,945 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:45:29,945 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:45:29,950 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:45:29,950 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:45:29,951 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:45:29,964 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:45:29,964 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:45:29,965 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:45:29,965 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:45:29,965 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:45:29,965 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:45:29,965 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:45:29,966 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:45:29,966 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:45:29,966 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:45:29,971 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:45:29,972 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:45:29,972 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:45:29,984 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:45:29,984 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:45:29,985 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:45:29,985 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:45:29,985 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:45:29,989 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:45:29,990 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:45:30,215 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:45:30,216 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:45:30,216 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:45:30,217 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:45:30,217 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:45:30,226 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:45:30,226 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:45:30,457 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:45:30,458 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:45:30,458 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:45:30,458 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:45:30,458 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:45:30,464 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:45:30,465 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:45:30,534 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:45:30,534 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:45:30,535 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:47:18,340 - INFO - app.core.security - Closing Redis connection...
2025-07-03 03:47:18,341 - INFO - app.core.security - Redis connection closed.
2025-07-03 03:48:09,562 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 03:48:09,563 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 03:48:09,566 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 03:48:09,566 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 03:48:09,569 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:48:09,569 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:48:09,569 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:48:09,569 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 11, 23, 9, 569245), 'iat': datetime.datetime(2025, 7, 3, 10, 48, 9, 569246)}
2025-07-03 03:48:09,569 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:48:11,363 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:48:11,364 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:48:11,364 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:49:06,313 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:49:06,314 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:49:06,314 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:49:06,314 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:49:06,315 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:49:06,327 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:49:06,327 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:49:21,535 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:49:21,535 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:49:21,536 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:49:21,536 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:49:21,536 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:49:21,543 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:49:21,543 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:49:58,883 - INFO - app.core.security - Closing Redis connection...
2025-07-03 03:49:58,887 - INFO - app.core.security - Redis connection closed.
2025-07-03 03:52:47,381 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 03:52:47,381 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 03:52:47,384 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 03:52:47,384 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 03:52:47,387 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:52:47,387 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:52:47,387 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:52:47,387 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 11, 27, 47, 387308), 'iat': datetime.datetime(2025, 7, 3, 10, 52, 47, 387310)}
2025-07-03 03:52:47,387 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 03:52:52,235 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:52:52,235 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:52:52,236 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:52:52,236 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:52:52,237 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:52:52,237 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:52:52,237 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:52:52,237 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:52:52,238 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:52:52,238 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:52:52,249 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:52:52,249 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:52:52,250 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:52:52,267 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:52:52,268 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:52:52,268 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:52:52,268 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:52:52,268 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 03:52:52,269 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:52:52,269 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:52:52,269 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:52:52,269 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:52:52,269 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:52:52,274 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:52:52,274 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:52:52,274 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:52:52,279 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:52:52,279 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:52:52,280 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:52:52,280 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:52:52,280 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:52:52,283 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:52:52,284 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:52:52,457 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:52:52,457 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:52:52,458 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:52:52,459 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:52:52,459 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:52:52,465 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:52:52,465 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:52:52,622 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:52:52,623 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:52:52,623 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:52:52,623 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:52:52,623 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 03:52:52,627 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 03:52:52,627 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 03:52:52,768 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 03:52:52,769 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 03:52:52,769 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 03:53:32,526 - INFO - app.core.security - Closing Redis connection...
2025-07-03 03:53:32,531 - INFO - app.core.security - Redis connection closed.
2025-07-03 03:59:57,649 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 03:59:57,650 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 03:59:57,662 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 03:59:57,662 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 03:59:57,666 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 03:59:57,666 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 03:59:57,666 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 03:59:57,666 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 11, 34, 57, 666554), 'iat': datetime.datetime(2025, 7, 3, 10, 59, 57, 666555)}
2025-07-03 03:59:57,667 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 04:00:01,933 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:00:01,933 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:00:01,937 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:00:06,688 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:00:06,689 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:00:06,689 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:00:06,689 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:00:06,689 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:00:06,696 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:00:06,696 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:00:21,428 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:00:21,429 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:00:21,429 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:00:21,429 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:00:21,429 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:00:21,434 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:00:21,434 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:02:03,141 - INFO - app.core.security - Closing Redis connection...
2025-07-03 04:02:03,143 - INFO - app.core.security - Redis connection closed.
2025-07-03 04:02:57,748 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 04:02:57,748 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 04:02:57,751 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 04:02:57,751 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 04:02:57,755 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 04:02:57,755 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 04:02:57,755 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 04:02:57,755 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 11, 37, 57, 755579), 'iat': datetime.datetime(2025, 7, 3, 11, 2, 57, 755582)}
2025-07-03 04:02:57,756 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 04:03:03,241 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:03:03,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:03:03,241 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:03:17,534 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:03:17,535 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:03:17,535 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:03:17,536 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:03:17,536 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:03:17,544 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:03:17,544 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:03:25,075 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:03:25,075 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:03:25,075 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:03:25,076 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:03:25,076 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:03:25,080 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:03:25,080 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:03:48,931 - INFO - app.core.security - Closing Redis connection...
2025-07-03 04:03:48,932 - INFO - app.core.security - Redis connection closed.
2025-07-03 04:04:51,689 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 04:04:51,689 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 04:04:51,692 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 04:04:51,692 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 04:04:51,695 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 04:04:51,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 04:04:51,695 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 04:04:51,695 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 11, 39, 51, 695317), 'iat': datetime.datetime(2025, 7, 3, 11, 4, 51, 695319)}
2025-07-03 04:04:51,695 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 04:04:55,750 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:04:55,751 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:04:55,751 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:04:55,751 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:04:55,752 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 04:04:55,752 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:04:55,752 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:04:55,753 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:04:55,753 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:04:55,753 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:04:55,774 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:04:55,774 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:04:55,774 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:04:55,799 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:04:55,799 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:04:55,799 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:04:55,800 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:04:55,800 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 04:04:55,800 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:04:55,800 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:04:55,800 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:04:55,800 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:04:55,800 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:04:55,806 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:04:55,806 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:04:55,807 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:04:55,900 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:04:55,900 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:04:55,901 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:04:55,901 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:04:55,901 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:04:55,906 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:04:55,906 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:04:56,123 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:04:56,123 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:04:56,123 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:04:56,123 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:04:56,123 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:04:56,128 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:04:56,129 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:04:56,351 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:04:56,351 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:04:56,352 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:04:56,352 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:04:56,352 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:04:56,357 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:04:56,357 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:04:56,433 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:04:56,433 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:04:56,434 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:05:27,843 - INFO - app.core.security - Closing Redis connection...
2025-07-03 04:05:27,844 - INFO - app.core.security - Redis connection closed.
2025-07-03 04:06:09,190 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 04:06:09,191 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 04:06:09,195 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 04:06:09,195 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 04:06:09,199 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 04:06:09,199 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 04:06:09,199 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 04:06:09,199 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 11, 41, 9, 199135), 'iat': datetime.datetime(2025, 7, 3, 11, 6, 9, 199137)}
2025-07-03 04:06:09,199 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 04:06:11,863 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:06:11,864 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:06:11,864 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:06:47,901 - INFO - app.core.security - Closing Redis connection...
2025-07-03 04:06:47,903 - INFO - app.core.security - Redis connection closed.
2025-07-03 04:08:47,154 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 04:08:47,155 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 04:08:47,159 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 04:08:47,159 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 04:08:47,164 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 04:08:47,164 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 04:08:47,164 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 04:08:47,164 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 11, 43, 47, 164059), 'iat': datetime.datetime(2025, 7, 3, 11, 8, 47, 164061)}
2025-07-03 04:08:47,164 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 04:08:53,848 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:08:53,849 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:08:53,849 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:09:10,082 - INFO - app.core.security - Closing Redis connection...
2025-07-03 04:09:10,085 - INFO - app.core.security - Redis connection closed.
2025-07-03 04:12:02,987 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 04:12:02,988 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 04:12:02,991 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 04:12:02,991 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 04:12:02,995 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 04:12:02,995 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 04:12:02,995 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 04:12:02,995 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 11, 47, 2, 995734), 'iat': datetime.datetime(2025, 7, 3, 11, 12, 2, 995736)}
2025-07-03 04:12:02,996 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 04:12:04,855 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:04,855 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:04,855 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:06,427 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:06,427 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:06,428 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:06,428 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:06,428 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 04:12:06,428 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:06,428 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:06,428 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:06,429 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:06,429 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:12:06,434 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:12:06,434 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:12:06,434 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:12:06,445 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:06,445 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:06,446 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:06,446 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:06,446 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 04:12:06,446 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:06,446 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:06,446 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:06,446 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:06,446 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:12:06,448 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:12:06,448 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:12:06,448 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:12:06,452 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:06,452 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:06,453 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:06,453 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:06,453 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:12:06,455 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:12:06,456 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:12:06,555 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:06,555 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:06,555 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:06,555 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:06,555 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:12:06,558 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:12:06,558 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:12:06,642 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:06,642 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:06,642 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:06,642 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:06,642 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:12:06,645 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:12:06,645 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:12:06,874 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:06,875 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:06,875 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:33,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:33,373 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:33,373 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:33,373 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:33,374 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 04:12:33,374 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:33,374 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:33,374 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:33,374 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:33,374 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:12:33,379 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:12:33,379 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:12:33,379 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:12:33,387 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:33,387 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:33,387 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:33,387 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:33,387 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 04:12:33,387 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:33,388 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:33,388 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:33,388 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:33,388 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:12:33,390 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:33,390 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:33,390 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:33,391 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:33,391 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:12:33,396 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:12:33,396 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:12:33,396 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:12:33,399 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:12:33,399 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:12:33,625 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:33,626 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:33,626 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:33,626 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:33,626 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:12:33,630 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:12:33,630 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:12:33,818 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:33,819 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:33,819 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:33,819 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:33,819 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:12:33,824 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:12:33,824 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:12:34,051 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:34,052 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:34,053 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:39,152 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:39,152 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:39,153 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:39,153 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:39,153 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:12:39,160 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:12:39,160 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:12:42,689 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:42,689 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:42,690 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:42,691 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:42,691 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:12:42,699 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:12:42,700 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:12:46,209 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:46,209 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:46,210 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:46,210 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:46,210 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 04:12:46,210 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:46,210 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:46,210 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:46,210 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:46,210 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:12:46,224 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:12:46,224 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:12:46,224 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:12:56,180 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:12:56,180 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:12:56,180 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:56,180 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751541328, 'iat': 1751539528}
2025-07-03 04:12:56,181 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:12:56,187 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:12:56,187 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:13:43,792 - INFO - app.core.security - Closing Redis connection...
2025-07-03 04:13:43,794 - INFO - app.core.security - Redis connection closed.
2025-07-03 04:18:07,351 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 04:18:07,351 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 04:18:07,364 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 04:18:07,364 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 04:18:07,367 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 04:18:07,367 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 04:18:07,367 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 04:18:07,367 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 11, 53, 7, 367456), 'iat': datetime.datetime(2025, 7, 3, 11, 18, 7, 367457)}
2025-07-03 04:18:07,367 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 04:18:13,674 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:18:13,675 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:18:13,676 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 04:18:23,327 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:18:23,327 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:18:23,328 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 04:18:23,746 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:18:23,747 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:18:23,747 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 04:18:23,750 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-03 04:18:29,918 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:18:29,919 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:18:29,919 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 04:18:34,593 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:18:34,593 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:18:34,594 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 04:18:34,594 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-03 04:18:44,924 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 04:18:44,925 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 04:18:44,925 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 04:18:44,925 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 3, 11, 48, 44, 924854), 'iat': datetime.datetime(2025, 7, 3, 11, 18, 44, 924858)}
2025-07-03 04:18:44,925 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 04:18:44,925 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIxNDYzMjQsImlhdCI6MTc1MTU0MTUyNH0.SoyYNxpM3gabY6EfcJYhtd4DYiH4Q1QZV-5Wmh2NE-4, Expiry (seconds): 604800
2025-07-03 04:18:44,926 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-03 04:18:46,020 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:18:46,020 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:18:46,021 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:18:46,021 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:18:46,021 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 04:18:46,021 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:18:46,021 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:18:46,021 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:18:46,021 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:18:46,021 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:18:46,025 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:18:46,025 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:18:46,025 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:18:46,029 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:18:46,029 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:18:46,029 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:18:46,029 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:18:46,029 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 04:18:46,029 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:18:46,029 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:18:46,030 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:18:46,030 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:18:46,030 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:18:46,033 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:18:46,033 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:18:46,033 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:18:46,041 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:18:46,041 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:18:46,041 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:18:46,041 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:18:46,041 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:18:46,043 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:18:46,043 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:18:46,158 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:18:46,158 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:18:46,159 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:18:46,159 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:18:46,159 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:18:46,160 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:18:46,161 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:18:46,251 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:18:46,251 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:18:46,251 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:18:46,251 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:18:46,251 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:18:46,254 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:18:46,254 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:18:46,479 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:18:46,479 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:18:46,479 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:18:51,437 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:18:51,437 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:18:51,437 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:18:51,437 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:18:51,437 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:18:51,439 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:18:51,439 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:19:02,092 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:19:02,092 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:19:02,093 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:19:02,093 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:19:02,093 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:19:02,096 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:19:02,096 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:19:36,040 - INFO - app.core.security - Closing Redis connection...
2025-07-03 04:19:36,042 - INFO - app.core.security - Redis connection closed.
2025-07-03 04:21:23,064 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 04:21:23,064 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 04:21:23,066 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 04:21:23,066 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 04:21:23,069 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 04:21:23,069 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 04:21:23,069 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 04:21:23,069 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 11, 56, 23, 69671), 'iat': datetime.datetime(2025, 7, 3, 11, 21, 23, 69673)}
2025-07-03 04:21:23,070 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 04:21:29,232 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:21:29,232 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:21:29,232 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:21:33,564 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:21:33,564 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:21:33,565 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:21:33,565 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:21:33,565 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:21:33,575 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:21:33,575 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:21:45,043 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:21:45,043 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:21:45,044 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:21:45,044 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:21:45,044 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:21:45,050 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:21:45,050 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:21:47,743 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:21:47,743 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:21:47,743 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:21:47,743 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:21:47,744 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:21:47,749 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:21:47,749 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:21:59,377 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:21:59,377 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:21:59,378 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:21:59,378 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:21:59,378 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:21:59,383 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:21:59,383 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:22:05,443 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:22:05,443 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:22:05,444 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:22:05,445 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:22:05,445 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:22:05,468 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:22:05,468 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:22:11,498 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:22:11,498 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:22:11,499 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:22:11,499 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:22:11,499 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 04:22:11,499 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:22:11,499 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:22:11,499 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:22:11,499 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:22:11,499 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:22:11,503 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:22:11,503 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:22:11,504 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:22:13,498 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:22:13,498 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:22:13,499 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:22:13,499 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:22:13,499 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 04:22:13,499 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:22:13,499 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:22:13,500 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:22:13,500 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:22:13,500 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:22:13,506 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:22:13,506 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:22:13,506 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:22:15,432 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:22:15,432 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:22:15,432 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:22:15,432 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:22:15,432 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 04:22:15,432 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:22:15,432 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:22:15,433 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:22:15,433 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:22:15,433 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:22:15,443 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:22:15,443 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:22:15,443 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:23:09,166 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:23:09,167 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:23:09,167 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:23:09,167 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:23:09,167 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:23:09,174 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:23:09,174 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:23:23,167 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:23:23,167 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:23:23,168 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:23:23,168 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:23:23,168 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:23:23,190 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:23:23,191 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:23:43,434 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:23:43,434 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:23:43,434 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:23:43,434 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:23:43,435 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:23:43,443 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:23:43,444 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:24:16,065 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:24:16,065 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:24:16,065 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:24:16,065 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:24:16,065 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:24:16,070 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:24:16,070 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:24:40,206 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:24:40,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:24:40,207 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:24:40,207 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:24:40,207 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 04:24:40,207 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 04:24:40,207 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 04:24:40,207 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:24:40,207 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751543324, 'iat': 1751541524}
2025-07-03 04:24:40,207 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 04:24:40,212 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 04:24:40,212 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:24:40,212 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 04:24:52,454 - INFO - app.core.security - Closing Redis connection...
2025-07-03 04:24:52,456 - INFO - app.core.security - Redis connection closed.
2025-07-03 06:21:04,853 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 06:21:04,853 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 06:21:04,869 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 06:21:04,870 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 06:21:04,874 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 06:21:04,874 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 06:21:04,874 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 06:21:04,874 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 3, 13, 56, 4, 874570), 'iat': datetime.datetime(2025, 7, 3, 13, 21, 4, 874575)}
2025-07-03 06:21:04,875 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 06:23:16,865 - INFO - app.core.security - Closing Redis connection...
2025-07-03 06:23:16,866 - INFO - app.core.security - Redis connection closed.
2025-07-03 21:26:08,137 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 21:26:08,137 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 21:26:08,151 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 21:26:08,151 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 21:26:08,156 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 21:26:08,156 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 21:26:08,156 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 21:26:08,156 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 5, 1, 8, 156441), 'iat': datetime.datetime(2025, 7, 4, 4, 26, 8, 156443)}
2025-07-03 21:26:08,157 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 21:26:29,588 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:26:29,588 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:26:29,591 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 21:26:29,597 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-03 21:26:29,634 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:26:29,634 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:26:29,635 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 21:26:29,638 - ERROR - app.core.security - Authentication error in get_user_from_service_or_user_token: Could not validate credentials
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 371, in get_user_from_service_or_user_token
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-03 21:26:29,669 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:26:29,670 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:26:29,671 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 21:26:29,675 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-03 21:26:29,697 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:26:29,698 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:26:29,698 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 21:26:29,702 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-03 21:26:29,711 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:26:29,711 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:26:29,712 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752153320, 'iat': 1751548520}
2025-07-03 21:26:29,712 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIxNTMzMjAsImlhdCI6MTc1MTU0ODUyMH0.z4GamlCAKbeSeRKzT6vY4qBs0OyBbiVvyGnUlQ3fO1E
2025-07-03 21:26:29,836 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:26:29,837 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:26:29,838 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752153320, 'iat': 1751548520}
2025-07-03 21:26:29,838 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIxNTMzMjAsImlhdCI6MTc1MTU0ODUyMH0.z4GamlCAKbeSeRKzT6vY4qBs0OyBbiVvyGnUlQ3fO1E
2025-07-03 21:26:29,922 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIxNTMzMjAsImlhdCI6MTc1MTU0ODUyMH0.z4GamlCAKbeSeRKzT6vY4qBs0OyBbiVvyGnUlQ3fO1E
2025-07-03 21:26:29,939 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIxNTMzMjAsImlhdCI6MTc1MTU0ODUyMH0.z4GamlCAKbeSeRKzT6vY4qBs0OyBbiVvyGnUlQ3fO1E
2025-07-03 21:26:29,941 - INFO - app.core.security - Refresh token deleted from Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIxNTMzMjAsImlhdCI6MTc1MTU0ODUyMH0.z4GamlCAKbeSeRKzT6vY4qBs0OyBbiVvyGnUlQ3fO1E
2025-07-03 21:26:29,991 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIxNTMzMjAsImlhdCI6MTc1MTU0ODUyMH0.z4GamlCAKbeSeRKzT6vY4qBs0OyBbiVvyGnUlQ3fO1E
2025-07-03 21:28:08,582 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 21:28:08,582 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 21:28:08,582 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 21:28:08,583 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 4, 58, 8, 582111), 'iat': datetime.datetime(2025, 7, 4, 4, 28, 8, 582127)}
2025-07-03 21:28:08,583 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 21:28:08,584 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMDgwODgsImlhdCI6MTc1MTYwMzI4OH0.bWOMWval-lGgkLcv5N0e8hXm14gLNomd2ExDUYBXeX0, Expiry (seconds): 604800
2025-07-03 21:28:08,589 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-03 21:28:09,702 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:28:09,702 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:28:09,702 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:09,703 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:09,703 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 21:28:09,703 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:28:09,703 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:28:09,703 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:09,703 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:09,703 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:28:09,710 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:28:09,710 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:28:09,710 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:28:09,720 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:28:09,720 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:28:09,721 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:09,721 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:09,721 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 21:28:09,721 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:28:09,721 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:28:09,722 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:09,722 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:09,722 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:28:09,726 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:28:09,726 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:28:09,726 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:09,727 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:09,727 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:28:09,730 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:28:09,730 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:28:09,731 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:28:09,736 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:28:09,736 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:28:10,008 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:28:10,008 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:28:10,008 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:10,008 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:10,008 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:28:10,012 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:28:10,012 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:28:10,195 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:28:10,195 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:28:10,196 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:10,196 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:10,196 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:28:10,201 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:28:10,201 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:28:10,315 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:28:10,316 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:28:10,316 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:18,462 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:28:18,462 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:28:18,462 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:18,463 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:18,463 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:28:18,468 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:28:18,468 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:28:22,004 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:28:22,004 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:28:22,005 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:22,005 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:22,005 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:28:22,010 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:28:22,011 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:28:25,698 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:28:25,699 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:28:25,700 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:25,701 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:25,701 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:28:25,710 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:28:25,711 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:28:32,267 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:28:32,267 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:28:32,268 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:32,268 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:32,268 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 21:28:32,268 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:28:32,268 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:28:32,268 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:32,268 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:32,268 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:28:32,274 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:28:32,275 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:28:32,275 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:28:32,912 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:28:32,912 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:28:32,912 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:32,912 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:32,912 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 21:28:32,912 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:28:32,913 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:28:32,913 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:32,913 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:32,913 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:28:32,915 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:28:32,915 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:28:32,916 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:28:33,565 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:28:33,565 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:28:33,565 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:33,565 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:33,566 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 21:28:33,566 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:28:33,566 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:28:33,566 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:33,566 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:28:33,566 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:28:33,579 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:28:33,580 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:28:33,580 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:31:42,443 - INFO - app.core.security - Closing Redis connection...
2025-07-03 21:31:42,445 - INFO - app.core.security - Redis connection closed.
2025-07-03 21:36:59,532 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 21:36:59,532 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 21:36:59,535 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 21:36:59,535 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 21:36:59,540 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 21:36:59,540 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 21:36:59,540 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 21:36:59,540 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 5, 11, 59, 540170), 'iat': datetime.datetime(2025, 7, 4, 4, 36, 59, 540172)}
2025-07-03 21:36:59,540 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 21:37:01,839 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:37:01,840 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:37:01,840 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:37:03,419 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:37:03,419 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:37:03,419 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:37:03,420 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:37:03,420 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:37:03,428 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:37:03,429 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:37:07,106 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:37:07,106 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:37:07,107 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:37:07,107 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:37:07,107 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 21:37:07,107 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:37:07,107 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:37:07,107 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:37:07,108 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:37:07,108 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:37:07,113 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:37:07,114 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:37:07,114 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:42:35,746 - INFO - app.core.security - Closing Redis connection...
2025-07-03 21:42:35,750 - INFO - app.core.security - Redis connection closed.
2025-07-03 21:43:05,802 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 21:43:05,802 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 21:43:05,806 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 21:43:05,806 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 21:43:05,812 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 21:43:05,812 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 21:43:05,812 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 21:43:05,812 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 5, 18, 5, 812848), 'iat': datetime.datetime(2025, 7, 4, 4, 43, 5, 812850)}
2025-07-03 21:43:05,813 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 21:43:12,686 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:43:12,687 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:43:12,687 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:43:13,414 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:43:13,414 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:43:13,415 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:43:13,415 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751605088, 'iat': 1751603288}
2025-07-03 21:43:13,415 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:43:13,417 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:43:13,417 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:43:13,417 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MDUwODgsImlhdCI6MTc1MTYwMzI4OH0.-XWjNn3htgjCw4V3DW6ORWyyaWHJ9zMJy2vCj6UhC00
2025-07-03 21:43:13,418 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MDUwODgsImlhdCI6MTc1MTYwMzI4OH0.-XWjNn3htgjCw4V3DW6ORWyyaWHJ9zMJy2vCj6UhC00
2025-07-03 21:43:33,337 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 21:43:33,337 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 21:43:33,337 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 21:43:33,337 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 5, 13, 33, 337301), 'iat': datetime.datetime(2025, 7, 4, 4, 43, 33, 337316)}
2025-07-03 21:43:33,338 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 21:43:33,338 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMDkwMTMsImlhdCI6MTc1MTYwNDIxM30.dHOQO27ACk0TJApynLDdW6mfnZjBK4zIRKYn0KRUfUU, Expiry (seconds): 604800
2025-07-03 21:43:33,341 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-03 21:43:34,489 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:43:34,489 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:43:34,490 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:34,490 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:34,490 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 21:43:34,490 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:43:34,491 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:43:34,491 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:34,491 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:34,491 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:43:34,495 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:43:34,495 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:43:34,496 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:43:34,501 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:43:34,501 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:43:34,502 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:34,502 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:34,502 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 21:43:34,502 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:43:34,502 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:43:34,502 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:34,503 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:34,503 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:43:34,507 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:43:34,508 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:43:34,508 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:34,508 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:34,508 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:43:34,512 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:43:34,512 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:43:34,512 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:43:34,515 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:43:34,516 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:43:34,711 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:43:34,711 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:43:34,712 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:34,712 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:34,712 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:43:34,716 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:43:34,716 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:43:34,915 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:43:34,916 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:43:34,916 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:34,916 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:34,916 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:43:34,920 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:43:34,921 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:43:35,021 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:43:35,021 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:43:35,021 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:45,589 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:43:45,589 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:43:45,589 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:45,589 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:45,589 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:43:45,593 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:43:45,593 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:43:49,178 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:43:49,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:43:49,178 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:49,179 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:49,179 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:43:49,184 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:43:49,184 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:43:55,713 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:43:55,714 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:43:55,714 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:55,714 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:55,714 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 21:43:55,714 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:43:55,714 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:43:55,714 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:55,714 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:55,714 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:43:55,718 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:43:55,718 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:43:55,718 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:43:56,323 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:43:56,324 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:43:56,324 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:56,324 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:56,325 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 21:43:56,325 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:43:56,325 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:43:56,325 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:56,325 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:43:56,326 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:43:56,372 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:43:56,372 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:43:56,372 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:44:12,506 - INFO - app.core.security - Closing Redis connection...
2025-07-03 21:44:12,508 - INFO - app.core.security - Redis connection closed.
2025-07-03 21:45:02,848 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 21:45:02,848 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 21:45:02,863 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 21:45:02,863 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 21:45:02,866 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 21:45:02,866 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 21:45:02,866 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 21:45:02,866 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 5, 20, 2, 866761), 'iat': datetime.datetime(2025, 7, 4, 4, 45, 2, 866763)}
2025-07-03 21:45:02,867 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 21:45:05,632 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:45:05,632 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:45:05,632 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:45:06,393 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:45:06,394 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:45:06,394 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:45:06,394 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:45:06,394 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:45:06,397 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:45:06,397 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:46:16,920 - INFO - app.core.security - Closing Redis connection...
2025-07-03 21:46:16,923 - INFO - app.core.security - Redis connection closed.
2025-07-03 21:52:06,784 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 21:52:06,784 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 21:52:06,787 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 21:52:06,787 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 21:52:06,790 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 21:52:06,790 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 21:52:06,790 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 21:52:06,790 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 5, 27, 6, 790142), 'iat': datetime.datetime(2025, 7, 4, 4, 52, 6, 790145)}
2025-07-03 21:52:06,790 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 21:52:12,810 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:52:12,810 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:52:12,810 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:52:14,659 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:52:14,659 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:52:14,659 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:52:14,659 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:52:14,659 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 21:52:14,659 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:52:14,660 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:52:14,660 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:52:14,660 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:52:14,660 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:52:14,661 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:52:14,661 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:52:14,661 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:52:16,745 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:52:16,745 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:52:16,746 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:52:16,746 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:52:16,746 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:52:16,767 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:52:16,768 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:52:20,486 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:52:20,486 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:52:20,486 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:52:20,486 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:52:20,486 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:52:20,490 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:52:20,490 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:52:23,703 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:52:23,703 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:52:23,703 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:52:23,703 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:52:23,703 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:52:23,707 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:52:23,707 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:53:29,978 - INFO - app.core.security - Closing Redis connection...
2025-07-03 21:53:29,978 - INFO - app.core.security - Redis connection closed.
2025-07-03 21:57:18,463 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 21:57:18,463 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 21:57:18,466 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 21:57:18,466 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 21:57:18,469 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 21:57:18,469 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 21:57:18,469 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 21:57:18,469 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 5, 32, 18, 469444), 'iat': datetime.datetime(2025, 7, 4, 4, 57, 18, 469446)}
2025-07-03 21:57:18,469 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 21:57:20,828 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:57:20,828 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:57:20,829 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:31,765 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:57:31,765 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:57:31,766 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:31,766 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:31,766 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:57:31,767 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:57:31,767 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:57:37,065 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:57:37,065 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:57:37,065 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:37,065 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:37,065 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:57:37,081 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:57:37,081 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:57:41,091 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:57:41,091 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:57:41,092 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:41,092 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:41,092 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:57:41,093 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:57:41,093 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:57:44,023 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:57:44,023 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:57:44,023 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:44,023 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:44,023 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:57:44,027 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:57:44,027 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:57:48,179 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:57:48,179 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:57:48,179 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:48,179 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:48,179 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 21:57:48,179 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:57:48,179 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:57:48,179 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:48,179 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:48,179 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:57:48,181 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:57:48,181 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:57:48,181 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:57:49,024 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:57:49,024 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:57:49,025 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:49,025 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:49,025 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 21:57:49,025 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:57:49,025 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:57:49,025 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:49,025 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:49,026 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:57:49,031 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:57:49,031 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:57:49,032 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:57:49,633 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:57:49,633 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:57:49,633 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:49,633 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:49,633 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 21:57:49,633 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:57:49,633 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:57:49,633 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:49,633 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:49,633 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:57:49,635 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:57:49,635 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:57:49,635 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:57:55,044 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:57:55,044 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:57:55,045 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:55,045 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:55,045 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:57:55,047 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:57:55,047 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:57:58,891 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 21:57:58,891 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 21:57:58,891 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:58,892 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 21:57:58,892 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 21:57:58,894 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 21:57:58,894 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 21:58:04,495 - INFO - app.core.security - Closing Redis connection...
2025-07-03 21:58:04,496 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:09:22,555 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:09:22,555 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:09:22,558 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:09:22,558 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:09:22,561 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:09:22,561 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:09:22,561 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:09:22,561 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 5, 44, 22, 561576), 'iat': datetime.datetime(2025, 7, 4, 5, 9, 22, 561578)}
2025-07-03 22:09:22,561 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:09:24,804 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:09:24,804 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:09:24,804 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 22:09:30,766 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:09:30,766 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:09:30,767 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 22:09:30,767 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 22:09:30,767 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:09:30,767 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:09:30,767 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:09:30,768 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 22:09:30,768 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 22:09:30,768 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:09:30,773 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:09:30,773 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:09:30,774 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:09:31,481 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:09:31,481 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:09:31,482 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 22:09:31,482 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 22:09:31,482 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:09:31,483 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:09:31,483 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:09:31,483 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 22:09:31,483 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 22:09:31,483 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:09:31,501 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:09:31,502 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:09:31,502 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:09:36,244 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:09:36,244 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:09:36,244 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 22:09:36,245 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 22:09:36,245 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:09:36,251 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:09:36,252 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:11:56,371 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:11:56,374 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:11:58,282 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:11:58,282 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:11:58,284 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:11:58,284 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:11:58,287 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:11:58,287 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:11:58,287 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:11:58,287 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 5, 46, 58, 287591), 'iat': datetime.datetime(2025, 7, 4, 5, 11, 58, 287593)}
2025-07-03 22:11:58,287 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:12:00,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:12:00,292 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:12:00,293 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751606013, 'iat': 1751604213}
2025-07-03 22:12:58,125 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:12:58,125 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:12:58,125 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1752209013, 'iat': 1751604213}
2025-07-03 22:12:58,125 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMDkwMTMsImlhdCI6MTc1MTYwNDIxM30.dHOQO27ACk0TJApynLDdW6mfnZjBK4zIRKYn0KRUfUU
2025-07-03 22:12:58,129 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:12:58,129 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:12:58,129 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:12:58,129 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 5, 42, 58, 129111), 'iat': datetime.datetime(2025, 7, 4, 5, 12, 58, 129115)}
2025-07-03 22:12:58,129 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:12:58,129 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMTA3NzgsImlhdCI6MTc1MTYwNTk3OH0.ck5-w5jvT8hhd41rBW6c02_sgWAAJYuayfr1HKjIZ8A, Expiry (seconds): 604800
2025-07-03 22:12:58,130 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-03 22:12:59,452 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:12:59,452 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:12:59,452 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:03,548 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:13:03,549 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:13:03,550 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:04,486 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:13:04,487 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:13:04,487 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:04,487 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:04,487 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:13:04,491 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:13:04,491 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:13:09,318 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:13:09,319 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:13:09,319 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:09,319 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:09,319 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:13:09,325 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:13:09,325 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:13:12,321 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:13:12,322 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:13:12,323 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:12,323 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:12,323 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:13:12,333 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:13:12,333 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:13:16,831 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:13:16,831 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:13:16,832 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:16,832 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:16,832 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:13:16,839 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:13:16,839 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:13:22,940 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:13:22,940 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:13:22,941 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:22,941 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:22,941 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:13:22,941 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:13:22,941 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:13:22,942 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:22,942 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:22,942 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:13:22,947 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:13:22,947 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:13:22,947 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:13:23,628 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:13:23,629 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:13:23,630 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:23,630 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:23,630 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:13:23,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:13:23,631 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:13:23,631 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:23,631 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:23,632 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:13:23,648 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:13:23,648 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:13:23,649 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:13:25,047 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:13:25,047 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:13:25,048 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:25,048 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:25,048 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:13:25,048 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:13:25,048 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:13:25,049 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:25,049 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:25,050 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:13:25,064 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:13:25,064 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:13:25,064 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:13:26,583 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:13:26,586 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:13:26,587 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:26,594 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:26,595 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:13:26,595 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:13:26,595 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:13:26,596 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:26,596 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:13:26,597 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:13:26,621 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:13:26,621 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:13:26,621 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:13:32,935 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:13:32,938 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:23:44,762 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:23:44,762 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:23:44,765 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:23:44,765 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:23:44,768 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:23:44,768 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:23:44,768 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:23:44,768 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 5, 58, 44, 768893), 'iat': datetime.datetime(2025, 7, 4, 5, 23, 44, 768895)}
2025-07-03 22:23:44,769 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:23:49,558 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:23:49,558 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:23:49,559 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:23:52,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:23:52,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:23:52,899 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:23:52,900 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:23:52,900 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:23:52,900 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:23:52,900 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:23:52,900 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:23:52,900 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:23:52,901 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:23:52,906 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:23:52,906 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:23:52,906 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:23:52,926 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:23:52,927 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:23:52,927 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:23:52,927 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:23:52,928 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:23:52,928 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:23:52,928 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:23:52,928 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:23:52,928 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:23:52,928 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:23:52,934 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:23:52,934 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:23:52,934 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:23:52,938 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:23:52,938 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:23:52,938 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:23:52,939 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:23:52,939 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:23:52,953 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:23:52,954 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:23:53,195 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:23:53,196 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:23:53,196 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:23:53,197 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:23:53,197 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:23:53,201 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:23:53,201 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:23:53,425 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:23:53,426 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:23:53,426 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:23:53,426 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:23:53,426 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:23:53,429 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:23:53,430 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:23:55,801 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:23:55,801 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:23:55,801 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:24:02,679 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:24:02,680 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:24:02,680 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:24:02,680 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:24:02,680 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:24:02,687 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:24:02,687 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:25:03,608 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:25:03,608 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:26:52,451 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:26:52,452 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:26:52,456 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:26:52,456 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:26:52,461 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:26:52,461 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:26:52,461 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:26:52,461 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 1, 52, 461307), 'iat': datetime.datetime(2025, 7, 4, 5, 26, 52, 461310)}
2025-07-03 22:26:52,461 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:26:58,566 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:26:58,567 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:26:58,568 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:26:58,568 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:26:58,568 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:26:58,568 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:26:58,568 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:26:58,569 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:26:58,569 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:26:58,569 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:26:58,582 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:26:58,582 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:26:58,582 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:26:58,601 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:26:58,602 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:26:58,602 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:26:58,602 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:26:58,602 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:26:58,602 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:26:58,603 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:26:58,603 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:26:58,603 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:26:58,603 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:26:58,607 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:26:58,607 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:26:58,607 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:26:58,613 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:26:58,613 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:26:58,613 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:26:58,614 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:26:58,614 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:26:58,618 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:26:58,619 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:26:58,810 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:26:58,810 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:26:58,811 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:26:58,811 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:26:58,811 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:26:58,815 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:26:58,816 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:26:59,032 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:26:59,032 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:26:59,032 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:26:59,032 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:26:59,032 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:26:59,036 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:26:59,036 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:26:59,143 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:26:59,143 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:26:59,144 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:27:04,168 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:27:04,169 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:27:04,170 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:27:04,170 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:27:04,170 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:27:04,180 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:27:04,181 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:28:16,660 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:28:16,661 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:28:16,661 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:28:16,661 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:28:16,661 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:28:16,663 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:28:16,663 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:28:38,235 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:28:38,235 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:29:58,909 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:29:58,910 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:29:58,914 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:29:58,914 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:29:58,926 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:29:58,926 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:29:58,926 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:29:58,926 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 4, 58, 926383), 'iat': datetime.datetime(2025, 7, 4, 5, 29, 58, 926387)}
2025-07-03 22:29:58,928 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:30:03,322 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:30:03,323 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:30:03,323 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:30:19,309 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:30:19,310 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:30:21,275 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:30:21,275 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:30:21,280 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:30:21,280 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:30:21,286 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:30:21,286 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:30:21,286 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:30:21,286 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 5, 21, 286321), 'iat': datetime.datetime(2025, 7, 4, 5, 30, 21, 286323)}
2025-07-03 22:30:21,286 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:30:23,912 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:30:23,916 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:30:23,916 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:30:23,917 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:30:23,921 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:30:27,225 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:30:27,225 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:30:27,233 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:30:27,233 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:30:27,240 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:30:27,240 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:30:27,240 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:30:27,240 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 5, 27, 240173), 'iat': datetime.datetime(2025, 7, 4, 5, 30, 27, 240175)}
2025-07-03 22:30:27,240 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:30:30,300 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:30:30,300 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:30:30,301 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:30:42,340 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:30:42,341 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:30:44,199 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:30:44,199 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:30:44,203 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:30:44,203 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:30:44,206 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:30:44,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:30:44,206 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:30:44,206 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 5, 44, 206384), 'iat': datetime.datetime(2025, 7, 4, 5, 30, 44, 206387)}
2025-07-03 22:30:44,206 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:30:46,318 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:30:46,319 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:30:46,319 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:31:27,791 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:31:27,791 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:31:27,792 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:31:27,792 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:31:27,792 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:31:27,799 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:31:27,800 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:31:44,517 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:31:44,519 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:33:57,923 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:33:57,924 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:33:57,932 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:33:57,933 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:33:57,942 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:33:57,942 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:33:57,942 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:33:57,942 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 8, 57, 941958), 'iat': datetime.datetime(2025, 7, 4, 5, 33, 57, 941965)}
2025-07-03 22:33:57,942 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:34:05,335 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:34:05,335 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:34:05,335 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:34:07,751 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:34:07,752 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:34:09,988 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:34:09,988 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:34:09,991 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:34:09,991 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:34:09,994 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:34:09,994 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:34:09,994 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:34:09,994 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 9, 9, 994683), 'iat': datetime.datetime(2025, 7, 4, 5, 34, 9, 994685)}
2025-07-03 22:34:09,995 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:34:12,354 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:34:12,355 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:34:14,560 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:34:14,560 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:34:14,563 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:34:14,563 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:34:14,566 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:34:14,566 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:34:14,566 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:34:14,566 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 9, 14, 566034), 'iat': datetime.datetime(2025, 7, 4, 5, 34, 14, 566036)}
2025-07-03 22:34:14,566 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:34:18,449 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:34:18,449 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:34:18,449 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:34:49,348 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:34:49,351 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:34:52,202 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:34:52,202 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:34:52,205 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:34:52,205 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:34:52,208 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:34:52,208 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:34:52,208 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:34:52,208 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 9, 52, 208107), 'iat': datetime.datetime(2025, 7, 4, 5, 34, 52, 208109)}
2025-07-03 22:34:52,208 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:34:56,288 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:34:56,291 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:34:56,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:34:56,291 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:34:56,296 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:34:59,723 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:34:59,723 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:34:59,730 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:34:59,730 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:34:59,735 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:34:59,736 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:34:59,736 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:34:59,736 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 9, 59, 735978), 'iat': datetime.datetime(2025, 7, 4, 5, 34, 59, 735982)}
2025-07-03 22:34:59,736 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:35:02,303 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:35:02,303 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:35:02,303 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:35:21,600 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:35:21,604 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:35:25,156 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:35:25,156 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:35:25,161 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:35:25,161 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:35:25,168 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:35:25,168 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:35:25,168 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:35:25,168 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 10, 25, 168469), 'iat': datetime.datetime(2025, 7, 4, 5, 35, 25, 168471)}
2025-07-03 22:35:25,169 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:35:28,540 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:35:28,541 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:35:31,082 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:35:31,082 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:35:31,088 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:35:31,089 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:35:31,093 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:35:31,093 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:35:31,093 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:35:31,093 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 10, 31, 93384), 'iat': datetime.datetime(2025, 7, 4, 5, 35, 31, 93387)}
2025-07-03 22:35:31,093 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:35:34,322 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:35:34,322 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:35:34,323 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:35:52,502 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:35:52,502 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:35:52,502 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:35:52,503 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:35:52,503 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:35:52,507 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:35:52,507 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:37:28,463 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:37:28,465 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:37:30,866 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:37:30,866 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:37:30,869 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:37:30,870 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:37:30,873 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:37:30,873 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:37:30,873 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:37:30,873 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 12, 30, 873232), 'iat': datetime.datetime(2025, 7, 4, 5, 37, 30, 873234)}
2025-07-03 22:37:30,873 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:37:34,321 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:37:34,321 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:37:34,322 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:37:37,662 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:37:37,663 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:37:39,753 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:37:39,753 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:37:39,757 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:37:39,757 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:37:39,759 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:37:39,759 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:37:39,759 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:37:39,759 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 12, 39, 759874), 'iat': datetime.datetime(2025, 7, 4, 5, 37, 39, 759876)}
2025-07-03 22:37:39,760 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:37:42,301 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:37:42,302 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:37:42,302 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:37:53,749 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:37:53,750 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:37:55,800 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:37:55,801 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:37:55,805 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:37:55,805 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:37:55,808 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:37:55,808 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:37:55,808 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:37:55,808 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 12, 55, 808277), 'iat': datetime.datetime(2025, 7, 4, 5, 37, 55, 808279)}
2025-07-03 22:37:55,808 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:37:58,311 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:37:58,311 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:37:58,312 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:38:12,068 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:38:12,069 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:38:15,254 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:38:15,254 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:38:15,259 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:38:15,259 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:38:15,266 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:38:15,266 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:38:15,266 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:38:15,266 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 13, 15, 266633), 'iat': datetime.datetime(2025, 7, 4, 5, 38, 15, 266745)}
2025-07-03 22:38:15,267 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:38:17,114 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:38:17,115 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:38:17,115 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:38:49,152 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:38:49,152 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:38:49,156 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:38:49,156 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:38:49,161 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:38:49,161 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:38:49,161 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:38:49,161 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 13, 49, 161182), 'iat': datetime.datetime(2025, 7, 4, 5, 38, 49, 161184)}
2025-07-03 22:38:49,162 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:38:57,297 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:38:57,297 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:38:57,297 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:39:09,589 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:39:09,599 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:39:13,066 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:39:13,066 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:39:13,071 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:39:13,071 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:39:13,076 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:39:13,076 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:39:13,076 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:39:13,076 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 14, 13, 76587), 'iat': datetime.datetime(2025, 7, 4, 5, 39, 13, 76592)}
2025-07-03 22:39:13,077 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:39:16,486 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:39:16,487 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:39:20,918 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:39:20,919 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:39:20,925 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:39:20,925 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:39:20,933 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:39:20,933 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:39:20,933 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:39:20,933 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 14, 20, 933036), 'iat': datetime.datetime(2025, 7, 4, 5, 39, 20, 933040)}
2025-07-03 22:39:20,933 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:39:22,746 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:39:22,746 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:39:22,746 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:39:34,819 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:39:34,820 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:39:37,497 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:39:37,497 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:39:37,502 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:39:37,502 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:39:37,505 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:39:37,506 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:39:37,506 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:39:37,506 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 14, 37, 505920), 'iat': datetime.datetime(2025, 7, 4, 5, 39, 37, 505922)}
2025-07-03 22:39:37,506 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:39:39,242 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:39:39,242 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:39:39,242 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:39:40,715 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:39:40,715 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:39:40,715 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:39:40,715 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:39:40,715 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:39:40,720 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:39:40,720 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:40:01,992 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:40:01,992 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:40:01,992 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:40:01,993 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:40:01,993 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:40:01,993 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:40:01,993 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:40:01,993 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:40:01,993 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:40:01,993 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:40:02,000 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:40:02,000 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:40:02,000 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:40:02,662 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:40:02,662 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:40:02,662 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:40:02,662 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:40:02,663 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:40:02,663 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:40:02,663 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:40:02,663 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:40:02,664 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751607778, 'iat': 1751605978}
2025-07-03 22:40:02,664 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:40:02,675 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:40:02,675 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:40:02,675 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:40:30,008 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:40:30,010 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:43:23,453 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:43:23,453 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:43:23,458 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:43:23,458 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:43:23,465 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:43:23,465 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:43:23,465 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:43:23,465 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 18, 23, 465743), 'iat': datetime.datetime(2025, 7, 4, 5, 43, 23, 465745)}
2025-07-03 22:43:23,466 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:43:30,300 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:43:30,301 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:43:30,301 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 22:43:36,300 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:43:36,300 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:43:36,300 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 22:43:42,296 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:43:42,296 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:43:42,296 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 22:43:48,299 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:43:48,299 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:43:48,299 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 22:43:54,308 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:43:54,308 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:43:54,308 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 22:43:59,301 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:43:59,301 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:44:01,354 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:44:01,355 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:44:01,359 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:44:01,359 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:44:01,362 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:44:01,362 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:44:01,362 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:44:01,362 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 19, 1, 362755), 'iat': datetime.datetime(2025, 7, 4, 5, 44, 1, 362757)}
2025-07-03 22:44:01,363 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:44:03,825 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:44:03,825 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:44:05,831 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:44:05,832 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:44:05,835 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:44:05,835 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:44:05,838 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:44:05,838 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:44:05,838 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:44:05,838 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 19, 5, 838183), 'iat': datetime.datetime(2025, 7, 4, 5, 44, 5, 838184)}
2025-07-03 22:44:05,838 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:44:09,324 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:44:09,324 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:44:09,324 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 22:44:15,459 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:44:15,459 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:44:15,460 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 22:44:21,448 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:44:21,448 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:44:21,448 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 22:44:27,471 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:44:27,471 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:44:27,472 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 22:44:34,464 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:44:34,464 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:44:34,464 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 22:44:38,631 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:44:38,632 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:44:40,862 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:44:40,862 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:44:40,879 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:44:40,879 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:44:40,883 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:44:40,883 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:44:40,883 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:44:40,883 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 19, 40, 883736), 'iat': datetime.datetime(2025, 7, 4, 5, 44, 40, 883738)}
2025-07-03 22:44:40,884 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:44:42,539 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:44:42,539 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:44:42,539 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 22:44:52,696 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:44:52,696 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:44:52,696 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 22:45:01,099 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:45:01,100 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:45:01,100 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 22:45:07,722 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:45:07,722 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:45:07,722 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 22:45:12,850 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:45:12,851 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:45:12,851 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-03 22:45:12,852 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\AppData\Local\Programs\Python\Python313\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-03 22:45:41,946 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:45:41,946 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:45:41,947 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:45:41,947 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 6, 15, 41, 946163), 'iat': datetime.datetime(2025, 7, 4, 5, 45, 41, 946184)}
2025-07-03 22:45:41,948 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:45:41,949 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMTI3NDEsImlhdCI6MTc1MTYwNzk0MX0.9RBGJVbSLY3yxjFIURNl4UOh0BxG9kTRopVwU70tPjg, Expiry (seconds): 604800
2025-07-03 22:45:41,958 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-03 22:45:43,128 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:45:43,128 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:45:43,129 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:43,129 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:43,129 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:45:43,129 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:45:43,130 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:45:43,130 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:43,130 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:43,130 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:45:43,165 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:45:43,165 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:45:43,166 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:45:43,177 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:45:43,177 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:45:43,177 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:43,178 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:43,178 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:45:43,178 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:45:43,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:45:43,178 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:43,178 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:43,178 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:45:43,187 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:45:43,187 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:45:43,188 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:43,188 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:43,188 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:45:43,190 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:45:43,191 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:45:43,191 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:45:43,196 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:45:43,196 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:45:43,580 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:45:43,580 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:45:43,581 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:43,581 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:43,581 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:45:43,589 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:45:43,589 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:45:43,807 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:45:43,808 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:45:43,809 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:43,809 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:43,810 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:45:43,817 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:45:43,818 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:45:43,905 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:45:43,905 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:45:43,905 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:49,320 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:45:49,321 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:45:49,321 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:49,322 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:49,322 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:45:49,327 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:45:49,328 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:45:51,846 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:45:51,846 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:45:51,847 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:51,848 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:51,848 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:45:51,856 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:45:51,857 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:45:55,607 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:45:55,607 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:45:55,608 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:55,609 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:45:55,609 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:45:55,617 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:45:55,617 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:46:04,961 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:46:04,961 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:46:04,962 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:46:04,962 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:46:04,962 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:46:04,967 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:46:04,968 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:46:44,885 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:46:44,885 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:46:44,886 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:46:44,886 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:46:44,886 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:46:44,886 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:46:44,886 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:46:44,887 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:46:44,887 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:46:44,887 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:46:44,891 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:46:44,891 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:46:44,892 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:46:45,525 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:46:45,526 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:46:45,526 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:46:45,527 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:46:45,527 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:46:45,527 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:46:45,527 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:46:45,528 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:46:45,529 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:46:45,529 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:46:45,547 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:46:45,547 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:46:45,548 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:46:46,250 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:46:46,250 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:46:46,251 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:46:46,251 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:46:46,251 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:46:46,251 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:46:46,251 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:46:46,251 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:46:46,251 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:46:46,251 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:46:46,262 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:46:46,262 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:46:46,262 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:46:47,213 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:46:47,213 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:46:47,214 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:46:47,214 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:46:47,215 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:46:47,215 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:46:47,215 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:46:47,215 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:46:47,215 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:46:47,215 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:46:47,222 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:46:47,222 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:46:47,222 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:47:26,247 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:47:26,247 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:47:26,248 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:47:26,248 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:47:26,248 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:47:26,251 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:47:26,251 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:47:29,436 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:47:29,436 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:47:29,437 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:47:29,437 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:47:29,437 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:47:29,454 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:47:29,455 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:47:37,527 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:47:37,527 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:47:37,527 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:47:37,527 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:47:37,528 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:47:37,531 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:47:37,532 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:48:31,796 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:48:31,797 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:48:31,797 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:48:31,798 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:48:31,798 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:48:31,799 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:48:31,799 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:48:31,799 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:48:31,799 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:48:31,799 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:48:31,805 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:48:31,805 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:48:31,805 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:48:32,434 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:48:32,434 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:48:32,435 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:48:32,435 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:48:32,436 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:48:32,436 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:48:32,437 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:48:32,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:48:32,439 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:48:32,439 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:48:32,447 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:48:32,448 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:48:32,448 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:48:33,066 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:48:33,067 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:48:33,067 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:48:33,067 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:48:33,067 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:48:33,067 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:48:33,067 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:48:33,068 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:48:33,068 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:48:33,068 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:48:33,073 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:48:33,073 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:48:33,073 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:50:27,962 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:50:27,962 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:50:27,963 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:50:27,963 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:50:27,964 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:50:27,968 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:50:27,968 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:50:47,937 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:50:47,937 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:50:47,937 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:50:47,937 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:50:47,938 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:50:47,941 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:50:47,942 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:50:53,095 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:50:53,095 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:50:53,096 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:50:53,096 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:50:53,096 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:50:53,103 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:50:53,103 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:51:40,111 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:51:40,114 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:52:02,209 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:52:02,209 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:52:02,219 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:52:02,219 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:52:02,222 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:52:02,222 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:52:02,222 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:52:02,222 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 27, 2, 222590), 'iat': datetime.datetime(2025, 7, 4, 5, 52, 2, 222592)}
2025-07-03 22:52:02,222 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:52:08,307 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:52:08,307 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:52:08,308 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:52:16,981 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:52:16,982 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:52:19,812 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:52:19,812 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:52:19,816 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:52:19,816 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:52:19,822 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:52:19,822 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:52:19,822 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:52:19,822 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 27, 19, 822271), 'iat': datetime.datetime(2025, 7, 4, 5, 52, 19, 822273)}
2025-07-03 22:52:19,822 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:52:23,836 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:52:23,841 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:52:23,841 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:52:23,842 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:52:23,849 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:52:28,205 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:52:28,205 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:52:28,210 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:52:28,211 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:52:28,216 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:52:28,216 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:52:28,216 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:52:28,216 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 27, 28, 216193), 'iat': datetime.datetime(2025, 7, 4, 5, 52, 28, 216196)}
2025-07-03 22:52:28,217 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:52:30,311 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:52:30,311 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:52:30,311 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:52:58,460 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:52:58,463 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:53:01,192 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:53:01,192 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:53:01,196 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:53:01,196 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:53:01,199 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:53:01,199 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:53:01,199 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:53:01,199 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 28, 1, 199655), 'iat': datetime.datetime(2025, 7, 4, 5, 53, 1, 199656)}
2025-07-03 22:53:01,200 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:53:04,304 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:53:04,304 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:53:04,304 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:53:46,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:53:46,979 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:53:46,979 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:53:46,979 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:53:46,979 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:53:46,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:53:46,979 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:53:46,980 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:53:46,980 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:53:46,980 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:53:46,982 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:53:46,982 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:53:46,982 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:53:49,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:53:49,291 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:53:49,292 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:53:49,292 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:53:49,292 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 22:53:49,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:53:49,292 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:53:49,292 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:53:49,293 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:53:49,293 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:53:49,300 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:53:49,301 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:53:49,301 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:53:51,624 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:53:51,624 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:53:51,624 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:53:51,624 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:53:51,624 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:53:51,629 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:53:51,629 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:53:58,400 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:53:58,400 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:53:58,401 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:53:58,401 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:53:58,401 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:53:58,408 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:53:58,408 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:54:01,044 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:54:01,044 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:54:01,045 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:54:01,045 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:54:01,045 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:54:01,062 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:54:01,063 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:54:05,065 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:54:05,066 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:54:05,066 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:54:05,066 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:54:05,066 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:54:05,071 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:54:05,072 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:54:07,152 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:54:07,152 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:54:07,153 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:54:07,153 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:54:07,153 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:54:07,172 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:54:07,172 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:54:08,887 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:54:08,887 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:54:08,887 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:54:08,888 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:54:08,888 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:54:08,901 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:54:08,901 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:54:10,724 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:54:10,725 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:54:10,725 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:54:10,725 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:54:10,725 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:54:10,735 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:54:10,736 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:54:12,736 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:54:12,737 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:54:12,737 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:54:12,738 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:54:12,738 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:54:12,757 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:54:12,758 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:54:15,434 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:54:15,435 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:54:15,435 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:54:15,435 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:54:15,435 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 22:54:15,441 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 22:54:15,441 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 22:55:58,555 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:55:58,557 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:56:00,721 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:56:00,721 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:56:00,726 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:56:00,726 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:56:00,731 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:56:00,731 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:56:00,731 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:56:00,731 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 31, 0, 731182), 'iat': datetime.datetime(2025, 7, 4, 5, 56, 0, 731184)}
2025-07-03 22:56:00,731 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:56:02,562 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:56:02,562 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:56:02,562 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:56:26,193 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:56:26,194 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:56:28,464 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:56:28,464 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:56:28,470 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:56:28,470 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:56:28,478 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:56:28,478 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:56:28,478 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:56:28,478 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 31, 28, 478445), 'iat': datetime.datetime(2025, 7, 4, 5, 56, 28, 478447)}
2025-07-03 22:56:28,478 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:56:30,307 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:56:30,307 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:56:30,307 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:56:51,483 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:56:51,484 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:56:53,403 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:56:53,403 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:56:53,406 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:56:53,406 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:56:53,410 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:56:53,410 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:56:53,410 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:56:53,410 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 31, 53, 410003), 'iat': datetime.datetime(2025, 7, 4, 5, 56, 53, 410004)}
2025-07-03 22:56:53,410 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:56:56,304 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:56:56,304 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:56:56,304 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:57:12,275 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:57:12,276 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:57:14,209 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:57:14,209 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:57:14,233 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:57:14,233 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:57:14,237 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:57:14,237 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:57:14,237 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:57:14,237 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 32, 14, 237180), 'iat': datetime.datetime(2025, 7, 4, 5, 57, 14, 237183)}
2025-07-03 22:57:14,237 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:57:17,300 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:57:17,300 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:57:17,301 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:57:28,373 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:57:28,373 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:57:30,435 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:57:30,436 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:57:30,441 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:57:30,441 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:57:30,446 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:57:30,446 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:57:30,446 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:57:30,446 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 32, 30, 446546), 'iat': datetime.datetime(2025, 7, 4, 5, 57, 30, 446549)}
2025-07-03 22:57:30,447 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:57:33,319 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:57:33,320 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:57:33,320 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:57:54,165 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:57:54,168 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:57:56,656 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:57:56,656 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:57:56,660 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:57:56,660 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:57:56,663 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:57:56,663 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:57:56,664 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:57:56,664 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 32, 56, 663930), 'iat': datetime.datetime(2025, 7, 4, 5, 57, 56, 663932)}
2025-07-03 22:57:56,664 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:57:58,589 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:57:58,589 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:57:58,590 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:58:19,449 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:58:19,451 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:58:21,685 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:58:21,685 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:58:21,690 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:58:21,690 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:58:21,693 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:58:21,693 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:58:21,693 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:58:21,693 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 33, 21, 693433), 'iat': datetime.datetime(2025, 7, 4, 5, 58, 21, 693435)}
2025-07-03 22:58:21,693 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:58:24,056 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:58:24,058 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:58:26,164 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:58:26,164 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:58:26,188 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:58:26,188 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:58:26,192 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:58:26,192 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:58:26,192 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:58:26,193 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 33, 26, 192869), 'iat': datetime.datetime(2025, 7, 4, 5, 58, 26, 192872)}
2025-07-03 22:58:26,193 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:58:28,085 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:58:28,086 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:58:28,087 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:58:31,019 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:58:31,020 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:58:33,915 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:58:33,915 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:58:33,918 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:58:33,918 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:58:33,922 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:58:33,922 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:58:33,922 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:58:33,922 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 33, 33, 922321), 'iat': datetime.datetime(2025, 7, 4, 5, 58, 33, 922323)}
2025-07-03 22:58:33,922 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:58:35,764 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:58:35,765 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:58:35,765 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:58:37,888 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:58:37,890 - INFO - app.core.security - Redis connection closed.
2025-07-03 22:58:40,109 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 22:58:40,109 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 22:58:40,113 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 22:58:40,113 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 22:58:40,116 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 22:58:40,116 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 22:58:40,116 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 22:58:40,116 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 33, 40, 116652), 'iat': datetime.datetime(2025, 7, 4, 5, 58, 40, 116654)}
2025-07-03 22:58:40,117 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 22:58:42,313 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 22:58:42,313 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 22:58:42,313 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 22:59:17,206 - INFO - app.core.security - Closing Redis connection...
2025-07-03 22:59:17,207 - INFO - app.core.security - Redis connection closed.
2025-07-03 23:00:29,316 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 23:00:29,317 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 23:00:29,321 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 23:00:29,322 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 23:00:29,331 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 23:00:29,331 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 23:00:29,331 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 23:00:29,331 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 35, 29, 331204), 'iat': datetime.datetime(2025, 7, 4, 6, 0, 29, 331206)}
2025-07-03 23:00:29,331 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 23:00:32,675 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:32,676 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:32,676 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:41,509 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:41,509 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:41,509 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:41,509 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:41,509 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:00:41,509 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:41,509 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:41,509 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:41,509 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:41,509 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:00:41,513 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:00:41,513 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:00:41,513 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:00:42,190 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:42,190 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:42,191 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:42,191 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:42,191 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:00:42,192 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:42,192 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:42,192 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:42,192 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:42,193 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:00:42,204 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:00:42,204 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:00:42,205 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:00:43,010 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:43,010 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:43,011 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:43,011 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:43,011 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:00:43,012 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:43,012 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:43,012 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:43,013 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:43,014 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:00:43,032 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:00:43,032 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:00:43,032 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:00:43,710 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:43,710 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:43,711 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:43,711 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:43,711 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:00:43,711 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:43,712 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:43,712 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:43,712 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:43,712 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:00:43,722 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:00:43,722 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:00:43,722 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:00:44,662 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:44,662 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:44,662 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:44,663 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:44,663 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:00:44,663 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:44,663 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:44,664 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:44,664 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:44,664 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:00:44,680 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:00:44,680 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:00:44,680 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:00:45,470 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:45,470 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:45,471 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:45,472 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:45,472 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:00:45,472 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:45,472 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:45,473 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:45,473 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:45,473 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:00:45,490 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:00:45,490 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:00:45,491 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:00:46,494 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:46,494 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:46,495 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:46,495 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:46,495 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:00:46,495 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:46,495 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:46,496 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:46,496 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:46,496 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:00:46,504 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:00:46,504 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:00:46,505 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:00:47,157 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:47,158 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:47,158 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:47,159 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:47,159 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:00:47,159 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:47,159 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:47,159 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:47,159 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:47,160 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:00:47,174 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:00:47,175 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:00:47,175 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:00:47,822 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:47,823 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:47,824 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:47,824 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:47,824 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:00:47,824 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:47,824 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:47,826 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:47,826 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:47,826 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:00:47,835 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:00:47,835 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:00:47,835 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:00:53,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:53,292 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:53,293 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:53,293 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:53,293 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:00:53,304 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:00:53,304 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:00:55,469 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:55,469 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:55,470 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:55,470 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:55,470 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:00:55,476 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:00:55,476 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:00:57,079 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:00:57,080 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:00:57,081 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:57,081 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:00:57,081 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:00:57,090 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:00:57,090 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:01:00,914 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:01:00,914 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:01:00,915 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:01:00,915 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:01:00,915 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:01:00,919 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:01:00,919 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:01:15,274 - INFO - app.core.security - Closing Redis connection...
2025-07-03 23:01:15,275 - INFO - app.core.security - Redis connection closed.
2025-07-03 23:10:26,725 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 23:10:26,725 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 23:10:26,734 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 23:10:26,734 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 23:10:26,737 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 23:10:26,737 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 23:10:26,737 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 23:10:26,737 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 6, 45, 26, 737827), 'iat': datetime.datetime(2025, 7, 4, 6, 10, 26, 737829)}
2025-07-03 23:10:26,738 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 23:10:31,628 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:10:31,628 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:10:31,629 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:40,752 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:10:40,753 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:10:40,753 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:40,753 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:40,753 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:10:40,753 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:10:40,754 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:10:40,754 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:40,754 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:40,754 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:10:40,764 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:10:40,765 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:10:40,766 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:10:40,786 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:10:40,787 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:10:40,787 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:40,787 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:40,787 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:10:40,788 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:10:40,788 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:10:40,788 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:40,788 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:40,788 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:10:40,793 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:10:40,793 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:10:40,794 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:40,794 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:40,794 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:10:40,797 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:10:40,797 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:10:40,797 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:10:40,802 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:10:40,803 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:10:41,019 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:10:41,020 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:10:41,020 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:41,020 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:41,020 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:10:41,025 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:10:41,025 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:10:41,351 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:10:41,351 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:10:41,351 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:41,352 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:41,352 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:10:41,358 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:10:41,358 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:10:41,613 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:10:41,613 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:10:41,613 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:47,023 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:10:47,023 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:10:47,024 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:47,024 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:47,024 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:10:47,024 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:10:47,024 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:10:47,024 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:47,024 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:47,024 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:10:47,029 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:10:47,030 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:10:47,030 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:10:47,683 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:10:47,683 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:10:47,684 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:47,684 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:47,684 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:10:47,685 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:10:47,685 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:10:47,685 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:47,685 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:47,686 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:10:47,705 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:10:47,706 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:10:47,706 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:10:48,393 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:10:48,393 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:10:48,394 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:48,394 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:48,394 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:10:48,394 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:10:48,394 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:10:48,395 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:48,397 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:48,397 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:10:48,410 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:10:48,410 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:10:48,410 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:10:49,176 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:10:49,177 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:10:49,177 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:49,178 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:49,178 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:10:49,178 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:10:49,178 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:10:49,178 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:49,179 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:49,179 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:10:49,193 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:10:49,193 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:10:49,193 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:10:59,801 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:10:59,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:10:59,803 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:59,803 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:10:59,804 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:10:59,809 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:10:59,810 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:11:03,236 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:11:03,236 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:11:03,236 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:11:03,236 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:11:03,237 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:11:03,345 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:11:03,346 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:11:06,251 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:11:06,252 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:11:06,252 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:11:06,252 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:11:06,252 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:11:06,256 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:11:06,256 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:11:12,589 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:11:12,589 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:11:12,590 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:11:12,591 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:11:12,591 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:11:12,591 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:11:12,591 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:11:12,592 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:11:12,592 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:11:12,593 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:11:12,599 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:11:12,599 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:11:12,599 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:11:13,172 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:11:13,172 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:11:13,172 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:11:13,172 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:11:13,172 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:11:13,172 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:11:13,172 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:11:13,172 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:11:13,172 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:11:13,172 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:11:13,175 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:11:13,175 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:11:13,175 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:11:13,732 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:11:13,732 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:11:13,732 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:11:13,732 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:11:13,732 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:11:13,733 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:11:13,733 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:11:13,733 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:11:13,733 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751609741, 'iat': 1751607941}
2025-07-03 23:11:13,733 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:11:13,735 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:11:13,735 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:11:13,735 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:11:21,355 - INFO - app.core.security - Closing Redis connection...
2025-07-03 23:11:21,357 - INFO - app.core.security - Redis connection closed.
2025-07-03 23:42:19,077 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-03 23:42:19,078 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-03 23:42:19,080 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-03 23:42:19,080 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-03 23:42:19,084 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 23:42:19,084 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 23:42:19,084 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 23:42:19,084 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 7, 17, 19, 84241), 'iat': datetime.datetime(2025, 7, 4, 6, 42, 19, 84243)}
2025-07-03 23:42:19,084 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 23:42:24,676 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-03 23:42:24,677 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-03 23:42:24,677 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-03 23:42:24,677 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 7, 12, 24, 676718), 'iat': datetime.datetime(2025, 7, 4, 6, 42, 24, 676736)}
2025-07-03 23:42:24,678 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-03 23:42:24,678 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMTYxNDQsImlhdCI6MTc1MTYxMTM0NH0.03lxUgTZ-tZsdjp0JErCVp0flTc6Y2M8VF8TUnThrXE, Expiry (seconds): 604800
2025-07-03 23:42:24,680 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-03 23:42:25,835 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:42:25,835 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:42:25,836 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:25,836 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:25,836 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:42:25,837 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:42:25,837 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:42:25,837 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:25,837 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:25,837 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:42:25,844 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:42:25,844 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:42:25,845 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:42:25,858 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:42:25,858 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:42:25,859 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:25,859 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:25,859 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:42:25,859 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:42:25,860 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:42:25,860 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:25,860 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:25,860 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:42:25,868 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:42:25,868 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:42:25,868 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:25,868 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:25,868 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:42:25,872 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:42:25,873 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:42:25,873 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:42:25,881 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:42:25,882 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:42:26,317 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:42:26,317 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:42:26,318 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:26,318 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:26,318 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:42:26,323 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:42:26,323 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:42:26,587 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:42:26,587 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:42:26,588 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:26,588 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:26,588 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:42:26,598 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:42:26,598 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:42:26,634 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:42:26,634 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:42:26,635 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:33,738 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:42:33,739 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:42:33,739 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:33,739 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:33,739 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:42:33,746 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:42:33,746 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:42:43,139 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:42:43,139 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:42:43,139 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:43,139 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:43,139 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-03 23:42:43,139 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-03 23:42:43,139 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-03 23:42:43,140 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:43,140 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751613144, 'iat': 1751611344}
2025-07-03 23:42:43,140 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-03 23:42:43,143 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-03 23:42:43,143 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:42:43,144 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-03 23:43:04,428 - INFO - app.core.security - Closing Redis connection...
2025-07-03 23:43:04,430 - INFO - app.core.security - Redis connection closed.
2025-07-04 00:16:38,289 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 00:16:38,290 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 00:16:38,293 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 00:16:38,294 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 00:16:38,299 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 00:16:38,299 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 00:16:38,299 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 00:16:38,299 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 7, 51, 38, 299019), 'iat': datetime.datetime(2025, 7, 4, 7, 16, 38, 299021)}
2025-07-04 00:16:38,299 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 00:16:40,624 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:16:40,624 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:16:40,626 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 00:16:41,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:16:41,385 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:16:41,386 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 00:16:41,388 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-04 00:16:45,954 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:16:45,954 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:16:45,954 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 00:16:47,510 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:16:47,510 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:16:47,510 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 00:16:47,511 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-04 00:16:58,849 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 00:16:58,849 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 00:16:58,849 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 00:16:58,849 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 7, 46, 58, 849226), 'iat': datetime.datetime(2025, 7, 4, 7, 16, 58, 849234)}
2025-07-04 00:16:58,850 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 00:16:58,850 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMTgyMTgsImlhdCI6MTc1MTYxMzQxOH0.2vO71VyJMCVUIIJuyPVeJVLmekeB-UA2KFDUj55HwdM, Expiry (seconds): 604800
2025-07-04 00:16:58,853 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 00:17:00,054 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:17:00,054 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:17:00,055 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:00,055 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:00,055 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 00:17:00,055 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:17:00,055 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:17:00,056 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:00,056 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:00,056 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 00:17:00,063 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 00:17:00,063 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 00:17:00,064 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 00:17:00,085 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:17:00,085 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:17:00,086 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:00,086 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:00,086 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 00:17:00,086 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:17:00,086 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:17:00,086 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:00,087 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:00,087 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 00:17:00,093 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 00:17:00,093 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 00:17:00,093 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 00:17:00,096 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:17:00,096 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:17:00,097 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:00,097 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:00,097 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 00:17:00,101 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 00:17:00,102 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 00:17:00,377 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:17:00,378 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:17:00,378 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:00,379 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:00,379 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 00:17:00,384 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 00:17:00,384 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 00:17:00,710 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:17:00,710 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:17:00,711 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:01,029 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:17:01,029 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:17:01,029 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:01,029 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:01,029 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 00:17:01,039 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 00:17:01,040 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 00:17:04,879 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:17:04,880 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:17:04,882 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:04,882 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:04,882 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 00:17:04,891 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 00:17:04,892 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 00:17:07,786 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:17:07,787 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:17:07,788 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:07,788 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:07,788 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 00:17:07,799 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 00:17:07,799 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 00:17:14,002 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:17:14,003 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:17:14,004 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:14,004 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:14,004 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 00:17:14,004 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:17:14,004 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:17:14,005 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:14,005 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:14,005 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 00:17:14,013 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 00:17:14,013 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 00:17:14,013 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 00:17:15,201 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:17:15,201 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:17:15,202 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:15,202 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:15,202 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 00:17:15,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:17:15,202 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:17:15,202 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:15,202 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751615218, 'iat': 1751613418}
2025-07-04 00:17:15,202 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 00:17:15,210 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 00:17:15,210 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 00:17:15,211 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 00:18:50,415 - INFO - app.core.security - Closing Redis connection...
2025-07-04 00:18:50,416 - INFO - app.core.security - Redis connection closed.
2025-07-04 00:32:13,234 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 00:32:13,234 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 00:32:13,250 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 00:32:13,250 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 00:32:13,253 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 00:32:13,253 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 00:32:13,254 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 00:32:13,254 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 8, 7, 13, 253857), 'iat': datetime.datetime(2025, 7, 4, 7, 32, 13, 253859)}
2025-07-04 00:32:13,254 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 00:32:17,491 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 00:32:17,492 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 00:32:17,492 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 00:32:17,492 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 4, 8, 2, 17, 491550), 'iat': datetime.datetime(2025, 7, 4, 7, 32, 17, 491567)}
2025-07-04 00:32:17,493 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 00:32:17,493 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIyMTkxMzcsImlhdCI6MTc1MTYxNDMzN30.Lhx1lYZ6c6OzWh3X4OxZP9qDU2Uzek0GpBEqiak22oA, Expiry (seconds): 604800
2025-07-04 00:32:17,496 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-04 00:32:18,656 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:32:18,657 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:32:18,658 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751616137, 'iat': 1751614337}
2025-07-04 00:32:18,658 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751616137, 'iat': 1751614337}
2025-07-04 00:32:18,658 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 00:32:18,658 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:32:18,658 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:32:18,659 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751616137, 'iat': 1751614337}
2025-07-04 00:32:18,660 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751616137, 'iat': 1751614337}
2025-07-04 00:32:18,660 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 00:32:18,666 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 00:32:18,666 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 00:32:18,667 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 00:32:18,677 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:32:18,677 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:32:18,678 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751616137, 'iat': 1751614337}
2025-07-04 00:32:18,678 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751616137, 'iat': 1751614337}
2025-07-04 00:32:18,678 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 00:32:18,678 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:32:18,679 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:32:18,680 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751616137, 'iat': 1751614337}
2025-07-04 00:32:18,680 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751616137, 'iat': 1751614337}
2025-07-04 00:32:18,680 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 00:32:18,684 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:32:18,684 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:32:18,685 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751616137, 'iat': 1751614337}
2025-07-04 00:32:18,685 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751616137, 'iat': 1751614337}
2025-07-04 00:32:18,685 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 00:32:18,688 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 00:32:18,689 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 00:32:18,689 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 00:32:18,693 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 00:32:18,693 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 00:32:18,972 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:32:18,972 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:32:18,972 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751616137, 'iat': 1751614337}
2025-07-04 00:32:18,972 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751616137, 'iat': 1751614337}
2025-07-04 00:32:18,972 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 00:32:18,976 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 00:32:18,977 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 00:32:19,280 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:32:19,280 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:32:19,281 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751616137, 'iat': 1751614337}
2025-07-04 00:32:19,396 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:32:19,396 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:32:19,396 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751616137, 'iat': 1751614337}
2025-07-04 00:32:19,396 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751616137, 'iat': 1751614337}
2025-07-04 00:32:19,396 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 00:32:19,401 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 00:32:19,401 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 00:32:27,016 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:32:27,016 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:32:27,016 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751616137, 'iat': 1751614337}
2025-07-04 00:32:27,017 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751616137, 'iat': 1751614337}
2025-07-04 00:32:27,017 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 00:32:27,024 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 00:32:27,025 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 00:32:44,554 - INFO - app.core.security - Closing Redis connection...
2025-07-04 00:32:44,556 - INFO - app.core.security - Redis connection closed.
2025-07-04 00:38:44,707 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 00:38:44,708 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 00:38:44,711 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 00:38:44,711 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 00:38:44,714 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 00:38:44,714 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 00:38:44,714 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 00:38:44,714 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 8, 13, 44, 714509), 'iat': datetime.datetime(2025, 7, 4, 7, 38, 44, 714512)}
2025-07-04 00:38:44,714 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 00:38:52,524 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:38:52,524 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:38:52,524 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751616137, 'iat': 1751614337}
2025-07-04 00:38:54,552 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 00:38:54,552 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 00:38:54,552 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751616137, 'iat': 1751614337}
2025-07-04 00:38:54,552 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751616137, 'iat': 1751614337}
2025-07-04 00:38:54,552 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 00:38:54,555 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 00:38:54,555 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 01:27:15,863 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:27:15,863 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:27:15,865 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 01:27:25,134 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:27:25,134 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:27:25,134 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 01:27:32,023 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:27:32,023 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:27:32,023 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 01:27:37,700 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:27:37,700 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:27:37,701 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 01:27:43,696 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:27:43,696 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:27:43,697 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 01:27:43,943 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:27:43,944 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:27:43,945 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1752219137, 'iat': 1751614337}
2025-07-04 01:27:43,945 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIyMTkxMzcsImlhdCI6MTc1MTYxNDMzN30.Lhx1lYZ6c6OzWh3X4OxZP9qDU2Uzek0GpBEqiak22oA
2025-07-04 01:27:43,952 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIyMTkxMzcsImlhdCI6MTc1MTYxNDMzN30.Lhx1lYZ6c6OzWh3X4OxZP9qDU2Uzek0GpBEqiak22oA
2025-07-04 01:27:43,954 - INFO - app.core.security - Refresh token deleted from Redis for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIyMTkxMzcsImlhdCI6MTc1MTYxNDMzN30.Lhx1lYZ6c6OzWh3X4OxZP9qDU2Uzek0GpBEqiak22oA
2025-07-04 01:27:46,728 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:27:46,728 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:27:46,728 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 01:27:46,730 - WARNING - app.core.security - JWTError during access token validation.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 281, in get_current_user
    payload = decode_token(token)
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 98, in decode_token
    raise JWTError("Could not validate credentials")
jose.exceptions.JWTError: Could not validate credentials
2025-07-04 01:27:58,689 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 01:27:58,689 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 01:27:58,689 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 01:27:58,689 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 8, 57, 58, 689537), 'iat': datetime.datetime(2025, 7, 4, 8, 27, 58, 689545)}
2025-07-04 01:27:58,690 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 01:27:58,690 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMjI0NzgsImlhdCI6MTc1MTYxNzY3OH0.Kr5enaE5G4elTAc9r593LAr6wcCc2BmUsQpX7yFjlVs, Expiry (seconds): 604800
2025-07-04 01:27:58,695 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 01:27:59,880 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:27:59,880 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:27:59,881 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:27:59,881 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:27:59,881 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 01:27:59,881 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:27:59,881 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:27:59,882 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:27:59,882 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:27:59,882 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:27:59,888 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:27:59,888 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:27:59,888 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:27:59,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:27:59,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:27:59,899 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:27:59,899 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:27:59,899 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 01:27:59,900 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:27:59,900 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:27:59,900 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:27:59,900 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:27:59,900 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:27:59,907 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:27:59,907 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:27:59,908 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:27:59,911 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:27:59,911 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:27:59,911 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:27:59,911 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:27:59,912 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:27:59,918 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:27:59,918 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:28:00,159 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:28:00,159 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:28:00,160 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:28:00,160 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:28:00,160 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:28:00,167 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:28:00,167 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:28:00,795 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:28:00,795 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:28:00,796 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:28:00,796 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:28:00,797 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:28:00,804 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:28:00,804 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:28:00,833 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:28:00,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:28:00,834 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:28:25,546 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:28:25,547 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:28:25,547 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:28:25,547 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:28:25,547 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 01:28:25,547 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:28:25,547 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:28:25,547 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:28:25,547 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:28:25,547 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:28:25,552 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:28:25,552 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:28:25,552 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:28:25,555 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:28:25,556 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:28:25,556 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:28:25,556 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:28:25,556 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 01:28:25,556 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:28:25,556 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:28:25,557 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:28:25,557 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:28:25,557 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:28:25,560 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:28:25,560 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:28:25,560 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:28:25,564 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:28:25,565 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:28:25,565 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:28:25,565 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:28:25,565 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:28:25,568 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:28:25,568 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:28:25,752 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:28:25,752 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:28:25,752 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:28:25,752 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:28:25,753 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:28:25,756 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:28:25,756 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:28:25,899 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:28:25,899 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:28:25,900 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:28:25,900 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:28:25,900 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:28:25,902 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:28:25,902 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:28:26,061 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:28:26,061 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:28:26,061 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:28:57,085 - INFO - app.core.security - Closing Redis connection...
2025-07-04 01:28:57,088 - INFO - app.core.security - Redis connection closed.
2025-07-04 01:29:05,440 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 01:29:05,441 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 01:29:05,447 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 01:29:05,447 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 01:29:05,458 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 01:29:05,458 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 01:29:05,458 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 01:29:05,458 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 9, 4, 5, 458052), 'iat': datetime.datetime(2025, 7, 4, 8, 29, 5, 458061)}
2025-07-04 01:29:05,458 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 01:29:09,171 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:29:09,171 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:29:09,172 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:09,172 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:09,172 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 01:29:09,173 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:29:09,173 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:29:09,174 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:09,174 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:09,175 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:29:09,196 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:29:09,196 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:29:09,197 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:29:09,230 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:29:09,230 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:29:09,231 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:09,232 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:09,232 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 01:29:09,232 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:29:09,232 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:29:09,233 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:09,234 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:09,234 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:29:09,243 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:29:09,243 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:29:09,244 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:29:09,516 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:29:09,516 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:29:09,517 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:09,517 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:09,517 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:29:09,524 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:29:09,525 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:29:09,871 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:29:09,872 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:29:09,872 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:09,872 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:09,872 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:29:09,880 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:29:09,880 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:29:10,194 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:29:10,195 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:29:10,195 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:10,278 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:29:10,278 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:29:10,279 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:10,279 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:10,280 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:29:10,289 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:29:10,289 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:29:29,212 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:29:29,212 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:29:29,213 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:29,213 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:29,213 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:29:29,224 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:29:29,224 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:29:32,610 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:29:32,610 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:29:32,611 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:32,611 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:32,612 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:29:32,618 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:29:32,619 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:29:37,762 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:29:37,762 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:29:37,763 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:37,763 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:37,763 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 01:29:37,763 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:29:37,764 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:29:37,764 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:37,764 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:37,765 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:29:37,772 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:29:37,773 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:29:37,773 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:29:38,660 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:29:38,660 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:29:38,661 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:38,661 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:38,662 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 01:29:38,662 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:29:38,662 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:29:38,663 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:38,663 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:29:38,663 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:29:38,678 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:29:38,679 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:29:38,679 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:35:34,024 - INFO - app.core.security - Closing Redis connection...
2025-07-04 01:35:34,025 - INFO - app.core.security - Redis connection closed.
2025-07-04 01:50:28,305 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 01:50:28,305 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 01:50:28,308 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 01:50:28,308 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 01:50:28,311 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 01:50:28,311 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 01:50:28,311 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 01:50:28,311 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 9, 25, 28, 311823), 'iat': datetime.datetime(2025, 7, 4, 8, 50, 28, 311826)}
2025-07-04 01:50:28,312 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 01:50:30,224 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:50:30,224 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:50:30,225 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:51:02,714 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:51:02,714 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:51:02,715 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:51:02,715 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751619478, 'iat': 1751617678}
2025-07-04 01:51:02,715 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:51:02,720 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:51:02,721 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:51:02,721 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MTk0NzgsImlhdCI6MTc1MTYxNzY3OH0.4oYcf7GVRJ_K5m7L3OFp_9pMS84SOWyItRCDT4cGejA
2025-07-04 01:51:02,722 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MTk0NzgsImlhdCI6MTc1MTYxNzY3OH0.4oYcf7GVRJ_K5m7L3OFp_9pMS84SOWyItRCDT4cGejA
2025-07-04 01:51:14,196 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 01:51:14,196 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 01:51:14,197 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 01:51:14,197 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 9, 21, 14, 196473), 'iat': datetime.datetime(2025, 7, 4, 8, 51, 14, 196488)}
2025-07-04 01:51:14,197 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 01:51:14,198 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMjM4NzQsImlhdCI6MTc1MTYxOTA3NH0.DLC-iLyInYvizinaKAnu0nLD3xA-RFsqmTY5ejht8h8, Expiry (seconds): 604800
2025-07-04 01:51:14,202 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 01:51:15,328 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:51:15,328 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:51:15,328 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 01:51:15,329 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 01:51:15,329 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 01:51:15,329 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:51:15,329 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:51:15,329 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 01:51:15,329 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 01:51:15,329 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:51:15,333 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:51:15,334 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:51:15,334 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:51:15,340 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:51:15,340 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:51:15,341 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 01:51:15,341 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 01:51:15,341 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 01:51:15,341 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:51:15,341 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:51:15,342 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 01:51:15,342 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 01:51:15,342 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:51:15,346 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:51:15,346 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:51:15,347 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:51:15,349 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:51:15,349 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:51:15,350 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 01:51:15,350 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 01:51:15,350 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:51:15,355 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:51:15,356 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:51:15,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:51:15,631 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:51:15,631 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 01:51:15,631 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 01:51:15,631 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:51:15,635 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:51:15,636 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:51:15,926 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:51:15,926 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:51:15,927 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 01:51:15,927 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 01:51:15,927 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:51:15,930 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:51:15,931 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:51:15,938 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:51:15,939 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:51:15,939 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 01:52:24,314 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:52:24,315 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:52:24,315 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 01:52:24,315 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 01:52:24,315 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:52:24,318 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:52:24,319 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:52:31,951 - INFO - app.core.security - Closing Redis connection...
2025-07-04 01:52:31,953 - INFO - app.core.security - Redis connection closed.
2025-07-04 01:52:37,086 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 01:52:37,086 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 01:52:37,089 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 01:52:37,089 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 01:52:37,092 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 01:52:37,092 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 01:52:37,092 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 01:52:37,092 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 9, 27, 37, 92648), 'iat': datetime.datetime(2025, 7, 4, 8, 52, 37, 92650)}
2025-07-04 01:52:37,093 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 01:52:38,778 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:52:38,778 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:52:38,779 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 01:52:44,405 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:52:44,405 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:52:44,405 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 01:52:44,405 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 01:52:44,405 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 01:52:44,410 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 01:52:44,410 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 01:52:59,501 - INFO - app.core.security - Closing Redis connection...
2025-07-04 01:52:59,503 - INFO - app.core.security - Redis connection closed.
2025-07-04 01:59:47,864 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 01:59:47,865 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 01:59:47,875 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 01:59:47,875 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 01:59:47,882 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 01:59:47,882 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 01:59:47,882 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 01:59:47,882 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 9, 34, 47, 882615), 'iat': datetime.datetime(2025, 7, 4, 8, 59, 47, 882617)}
2025-07-04 01:59:47,885 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 01:59:51,963 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 01:59:51,964 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 01:59:51,966 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 02:00:20,137 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:00:20,137 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:00:20,137 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 02:00:20,138 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751620874, 'iat': 1751619074}
2025-07-04 02:00:20,138 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:00:20,150 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:00:20,150 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:00:20,151 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MjA4NzQsImlhdCI6MTc1MTYxOTA3NH0.XoaFgSA7d6hkm3YI1vT9K0wq3SzAq0iOuQ9WqiQP9Ng
2025-07-04 02:00:20,154 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MjA4NzQsImlhdCI6MTc1MTYxOTA3NH0.XoaFgSA7d6hkm3YI1vT9K0wq3SzAq0iOuQ9WqiQP9Ng
2025-07-04 02:00:34,264 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 02:00:34,264 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 02:00:34,264 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 02:00:34,264 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 9, 30, 34, 262643), 'iat': datetime.datetime(2025, 7, 4, 9, 0, 34, 263865)}
2025-07-04 02:00:34,265 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 02:00:34,266 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMjQ0MzQsImlhdCI6MTc1MTYxOTYzNH0.3IF_56LduzN6W7UOB4GYHqMiqaYz5Jk98rpiz20uFys, Expiry (seconds): 604800
2025-07-04 02:00:34,269 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 02:00:35,433 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:00:35,434 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:00:35,434 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:00:35,434 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:00:35,434 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 02:00:35,435 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:00:35,435 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:00:35,435 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:00:35,435 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:00:35,435 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:00:35,439 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:00:35,439 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:00:35,439 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:00:35,450 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:00:35,450 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:00:35,451 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:00:35,451 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:00:35,451 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 02:00:35,451 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:00:35,452 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:00:35,452 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:00:35,452 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:00:35,452 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:00:35,455 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:00:35,455 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:00:35,455 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:00:35,456 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:00:35,456 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:00:35,461 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:00:35,462 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:00:35,462 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:00:35,465 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:00:35,465 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:00:35,673 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:00:35,673 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:00:35,673 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:00:35,674 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:00:35,674 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:00:35,677 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:00:35,678 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:00:35,873 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:00:35,873 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:00:35,874 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:00:35,874 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:00:35,874 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:00:35,877 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:00:35,878 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:00:36,023 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:00:36,023 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:00:36,023 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:01:00,070 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:01:00,070 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:01:00,070 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:01:00,070 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:01:00,070 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:01:00,074 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:01:00,074 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:06:53,457 - INFO - app.core.security - Closing Redis connection...
2025-07-04 02:06:53,458 - INFO - app.core.security - Redis connection closed.
2025-07-04 02:06:57,249 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 02:06:57,249 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 02:06:57,253 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 02:06:57,253 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 02:06:57,258 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 02:06:57,259 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 02:06:57,259 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 02:06:57,259 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 9, 41, 57, 258974), 'iat': datetime.datetime(2025, 7, 4, 9, 6, 57, 258976)}
2025-07-04 02:06:57,259 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 02:07:00,281 - INFO - app.core.security - Closing Redis connection...
2025-07-04 02:07:00,282 - INFO - app.core.security - Redis connection closed.
2025-07-04 02:24:49,204 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 02:24:49,205 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 02:24:49,220 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 02:24:49,220 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 02:24:49,225 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 02:24:49,225 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 02:24:49,225 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 02:24:49,225 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 9, 59, 49, 225426), 'iat': datetime.datetime(2025, 7, 4, 9, 24, 49, 225428)}
2025-07-04 02:24:49,229 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 02:24:57,485 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:24:57,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:24:57,486 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:25:02,364 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:25:02,364 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:25:02,365 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:25:02,365 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:25:02,365 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:25:02,372 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:25:02,372 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:25:07,065 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:25:07,065 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:25:07,066 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:25:07,066 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:25:07,066 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 02:25:07,066 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:25:07,067 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:25:07,067 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:25:07,067 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:25:07,067 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:25:07,072 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:25:07,072 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:25:07,072 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:25:07,675 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:25:07,675 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:25:07,675 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:25:07,676 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:25:07,676 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 02:25:07,676 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:25:07,676 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:25:07,676 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:25:07,676 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:25:07,676 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:25:07,681 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:25:07,681 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:25:07,681 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:25:08,299 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:25:08,299 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:25:08,300 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:25:08,301 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:25:08,302 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 02:25:08,302 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:25:08,303 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:25:08,303 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:25:08,304 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:25:08,304 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:25:08,318 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:25:08,318 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:25:08,319 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:25:09,186 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:25:09,186 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:25:09,186 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:25:09,186 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:25:09,186 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 02:25:09,187 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:25:09,187 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:25:09,187 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:25:09,187 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:25:09,188 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:25:09,198 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:25:09,198 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:25:09,198 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:25:58,544 - INFO - app.core.security - Closing Redis connection...
2025-07-04 02:25:58,545 - INFO - app.core.security - Redis connection closed.
2025-07-04 02:26:40,402 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 02:26:40,402 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 02:26:40,406 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 02:26:40,406 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 02:26:40,410 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 02:26:40,410 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 02:26:40,410 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 02:26:40,410 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 10, 1, 40, 410111), 'iat': datetime.datetime(2025, 7, 4, 9, 26, 40, 410114)}
2025-07-04 02:26:40,410 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 02:26:42,437 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:26:42,437 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:26:42,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:26:44,445 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:26:44,446 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:26:44,447 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:26:44,447 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:26:44,447 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:26:44,457 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:26:44,457 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:27:16,566 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:27:16,566 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:27:16,567 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:27:16,567 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:27:16,567 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 02:27:16,567 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:27:16,567 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:27:16,567 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:27:16,567 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751621434, 'iat': 1751619634}
2025-07-04 02:27:16,567 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:27:16,569 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:27:16,569 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:27:16,569 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:28:16,899 - INFO - app.core.security - Closing Redis connection...
2025-07-04 02:28:16,899 - INFO - app.core.security - Redis connection closed.
2025-07-04 02:36:00,994 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 02:36:00,995 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 02:36:00,998 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 02:36:00,998 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 02:36:01,002 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 02:36:01,002 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 02:36:01,002 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 02:36:01,002 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 10, 11, 1, 2112), 'iat': datetime.datetime(2025, 7, 4, 9, 36, 1, 2115)}
2025-07-04 02:36:01,002 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 02:36:03,746 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:36:03,746 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:36:03,747 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 02:36:11,258 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:36:11,258 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:36:11,258 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 02:36:18,272 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:36:18,272 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:36:18,273 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 02:36:27,697 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:36:27,698 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:36:27,698 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 02:36:35,839 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:36:35,839 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:36:35,840 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 02:36:43,618 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:36:43,618 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:36:43,619 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 02:36:52,083 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:36:52,083 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:36:52,084 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 02:37:01,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:37:01,979 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:37:01,979 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 02:37:08,874 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:37:08,874 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:37:08,874 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 02:37:14,696 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:37:14,696 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:37:14,697 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 02:37:22,259 - INFO - app.core.security - Closing Redis connection...
2025-07-04 02:37:22,262 - INFO - app.core.security - Redis connection closed.
2025-07-04 02:37:48,062 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 02:37:48,063 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 02:37:48,067 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 02:37:48,067 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 02:37:48,070 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 02:37:48,070 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 02:37:48,070 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 02:37:48,070 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 10, 12, 48, 70484), 'iat': datetime.datetime(2025, 7, 4, 9, 37, 48, 70487)}
2025-07-04 02:37:48,071 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 02:37:50,218 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:37:50,218 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:37:50,219 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1752224434, 'iat': 1751619634}
2025-07-04 02:37:50,219 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMjQ0MzQsImlhdCI6MTc1MTYxOTYzNH0.3IF_56LduzN6W7UOB4GYHqMiqaYz5Jk98rpiz20uFys
2025-07-04 02:37:50,227 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 02:37:50,227 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 02:37:50,227 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 02:37:50,228 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 10, 7, 50, 227700), 'iat': datetime.datetime(2025, 7, 4, 9, 37, 50, 227705)}
2025-07-04 02:37:50,228 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 02:37:50,228 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMjY2NzAsImlhdCI6MTc1MTYyMTg3MH0.iPUutWmlJGgSZYbgMcYZclgQccjP9930PKMcw4WPWJE, Expiry (seconds): 604800
2025-07-04 02:37:50,229 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 02:37:52,062 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:37:52,062 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:37:52,062 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:37:55,170 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:37:55,170 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:37:55,170 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:37:55,170 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:37:55,170 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:37:55,172 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:37:55,172 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:38:00,023 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:38:00,023 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:38:00,023 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:38:00,023 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:38:00,023 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:38:00,025 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:38:00,025 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:38:08,612 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:38:08,613 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:38:08,613 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:38:08,613 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:38:08,613 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:38:08,617 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:38:08,618 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:38:24,614 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:38:24,614 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:38:24,615 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:38:24,615 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:38:24,615 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 02:38:24,615 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:38:24,615 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:38:24,615 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:38:24,615 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:38:24,615 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:38:24,633 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:38:24,634 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:38:24,634 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:38:29,220 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:38:29,220 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:38:29,220 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:38:29,220 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:38:29,220 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 02:38:29,220 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:38:29,220 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:38:29,221 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:38:29,221 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:38:29,221 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:38:29,227 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:38:29,227 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:38:29,227 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:39:17,156 - INFO - app.core.security - Closing Redis connection...
2025-07-04 02:39:17,158 - INFO - app.core.security - Redis connection closed.
2025-07-04 02:39:34,688 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 02:39:34,688 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 02:39:34,720 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 02:39:34,720 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 02:39:34,725 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 02:39:34,725 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 02:39:34,726 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 02:39:34,726 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 10, 14, 34, 725909), 'iat': datetime.datetime(2025, 7, 4, 9, 39, 34, 725912)}
2025-07-04 02:39:34,726 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 02:39:36,314 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:39:36,315 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:39:36,315 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:39:46,197 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:39:46,197 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:39:46,198 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:39:46,198 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:39:46,198 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:39:46,202 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:39:46,202 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:39:49,627 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:39:49,627 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:39:49,627 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:39:49,627 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:39:49,627 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 02:39:49,628 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:39:49,628 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:39:49,628 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:39:49,628 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:39:49,628 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:39:49,633 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:39:49,633 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:39:49,633 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:39:53,892 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:39:53,893 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:39:53,893 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:39:53,893 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:39:53,894 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:39:53,897 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:39:53,897 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:41:07,876 - INFO - app.core.security - Closing Redis connection...
2025-07-04 02:41:07,878 - INFO - app.core.security - Redis connection closed.
2025-07-04 02:42:15,350 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 02:42:15,351 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 02:42:15,355 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 02:42:15,355 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 02:42:15,359 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 02:42:15,359 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 02:42:15,360 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 02:42:15,360 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 10, 17, 15, 359909), 'iat': datetime.datetime(2025, 7, 4, 9, 42, 15, 359912)}
2025-07-04 02:42:15,361 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 02:42:17,233 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:42:17,233 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:42:17,233 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:42:23,974 - INFO - app.core.security - Closing Redis connection...
2025-07-04 02:42:23,974 - INFO - app.core.security - Redis connection closed.
2025-07-04 02:42:50,789 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 02:42:50,790 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 02:42:50,800 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 02:42:50,800 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 02:42:50,805 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 02:42:50,805 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 02:42:50,805 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 02:42:50,805 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 10, 17, 50, 805030), 'iat': datetime.datetime(2025, 7, 4, 9, 42, 50, 805033)}
2025-07-04 02:42:50,805 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 02:42:52,739 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:42:52,739 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:42:52,739 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:43:34,097 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:43:34,097 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:43:34,098 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:43:34,098 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751623670, 'iat': 1751621870}
2025-07-04 02:43:34,098 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:43:34,105 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:43:34,105 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:43:34,105 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MjM2NzAsImlhdCI6MTc1MTYyMTg3MH0.XHODLB9xO7oQg6luqoRDtfFNdiVnjgdOZPth-OOwx_I
2025-07-04 02:43:34,107 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MjM2NzAsImlhdCI6MTc1MTYyMTg3MH0.XHODLB9xO7oQg6luqoRDtfFNdiVnjgdOZPth-OOwx_I
2025-07-04 02:43:44,300 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 02:43:44,300 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 02:43:44,300 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 02:43:44,300 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 10, 13, 44, 300379), 'iat': datetime.datetime(2025, 7, 4, 9, 43, 44, 300386)}
2025-07-04 02:43:44,301 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 02:43:44,301 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMjcwMjQsImlhdCI6MTc1MTYyMjIyNH0.CC212y7eYlvAxEygfzWpn-Fa5uJG4mY4Ws0jjHIbamA, Expiry (seconds): 604800
2025-07-04 02:43:44,305 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 02:43:45,468 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:43:45,468 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:43:45,468 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624024, 'iat': 1751622224}
2025-07-04 02:43:45,468 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624024, 'iat': 1751622224}
2025-07-04 02:43:45,468 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 02:43:45,469 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:43:45,469 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:43:45,469 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624024, 'iat': 1751622224}
2025-07-04 02:43:45,469 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624024, 'iat': 1751622224}
2025-07-04 02:43:45,470 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:43:45,474 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:43:45,474 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:43:45,474 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:43:45,480 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:43:45,480 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:43:45,481 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624024, 'iat': 1751622224}
2025-07-04 02:43:45,481 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624024, 'iat': 1751622224}
2025-07-04 02:43:45,481 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 02:43:45,481 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:43:45,481 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:43:45,481 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624024, 'iat': 1751622224}
2025-07-04 02:43:45,482 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624024, 'iat': 1751622224}
2025-07-04 02:43:45,482 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:43:45,488 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:43:45,488 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:43:45,488 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:43:45,497 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:43:45,497 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:43:45,498 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624024, 'iat': 1751622224}
2025-07-04 02:43:45,498 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624024, 'iat': 1751622224}
2025-07-04 02:43:45,498 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:43:45,502 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:43:45,502 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:43:45,725 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:43:45,725 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:43:45,725 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624024, 'iat': 1751622224}
2025-07-04 02:43:45,725 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624024, 'iat': 1751622224}
2025-07-04 02:43:45,725 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:43:45,731 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:43:45,731 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:43:45,930 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:43:45,930 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:43:45,930 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624024, 'iat': 1751622224}
2025-07-04 02:43:45,930 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624024, 'iat': 1751622224}
2025-07-04 02:43:45,930 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:43:45,933 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:43:45,934 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:43:46,046 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:43:46,046 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:43:46,047 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624024, 'iat': 1751622224}
2025-07-04 02:44:09,471 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:44:09,472 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:44:09,472 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624024, 'iat': 1751622224}
2025-07-04 02:44:09,472 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624024, 'iat': 1751622224}
2025-07-04 02:44:09,472 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:44:09,476 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:44:09,476 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:44:21,542 - INFO - app.core.security - Closing Redis connection...
2025-07-04 02:44:21,545 - INFO - app.core.security - Redis connection closed.
2025-07-04 02:49:49,313 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 02:49:49,313 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 02:49:49,318 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 02:49:49,319 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 02:49:49,325 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 02:49:49,325 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 02:49:49,325 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 02:49:49,325 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 10, 24, 49, 325173), 'iat': datetime.datetime(2025, 7, 4, 9, 49, 49, 325176)}
2025-07-04 02:49:49,325 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 02:49:54,157 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:49:54,157 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:49:54,158 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624024, 'iat': 1751622224}
2025-07-04 02:49:54,158 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624024, 'iat': 1751622224}
2025-07-04 02:49:54,158 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:49:54,168 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:49:54,168 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:49:54,168 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MjQwMjQsImlhdCI6MTc1MTYyMjIyNH0.7i7KrNUWtUy2HBvN3D2xaforil8zpHQSH6oJKTbwYDU
2025-07-04 02:49:54,170 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MjQwMjQsImlhdCI6MTc1MTYyMjIyNH0.7i7KrNUWtUy2HBvN3D2xaforil8zpHQSH6oJKTbwYDU
2025-07-04 02:50:05,537 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 02:50:05,537 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 02:50:05,537 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 02:50:05,537 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 10, 20, 5, 537374), 'iat': datetime.datetime(2025, 7, 4, 9, 50, 5, 537380)}
2025-07-04 02:50:05,537 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 02:50:05,538 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMjc0MDUsImlhdCI6MTc1MTYyMjYwNX0.iR6A3G_2AuMP4v8qWHrTxlptenyCmXYfBisNnE2Yf7k, Expiry (seconds): 604800
2025-07-04 02:50:05,539 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 02:50:06,662 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:50:06,662 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:50:06,663 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:50:06,663 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:50:06,663 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 02:50:06,663 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:50:06,663 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:50:06,663 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:50:06,663 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:50:06,664 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:50:06,670 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:50:06,670 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:50:06,670 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:50:06,679 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:50:06,679 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:50:06,680 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:50:06,680 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:50:06,680 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 02:50:06,680 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:50:06,680 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:50:06,680 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:50:06,680 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:50:06,680 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:50:06,684 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:50:06,684 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:50:06,684 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:50:06,696 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:50:06,696 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:50:06,697 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:50:06,697 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:50:06,697 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:50:06,702 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:50:06,703 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:50:06,891 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:50:06,891 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:50:06,891 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:50:06,891 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:50:06,891 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:50:06,896 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:50:06,896 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:50:07,061 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:50:07,061 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:50:07,061 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:50:07,061 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:50:07,061 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:50:07,064 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:50:07,064 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:50:07,217 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:50:07,217 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:50:07,218 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:50:11,778 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:50:11,778 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:50:11,779 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:50:11,779 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:50:11,779 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:50:11,780 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:50:11,781 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:50:14,799 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:50:14,799 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:50:14,799 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:50:14,799 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:50:14,799 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:50:14,801 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:50:14,801 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:52:25,511 - INFO - app.core.security - Closing Redis connection...
2025-07-04 02:52:25,515 - INFO - app.core.security - Redis connection closed.
2025-07-04 02:59:26,170 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 02:59:26,170 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 02:59:26,176 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 02:59:26,177 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 02:59:26,184 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 02:59:26,184 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 02:59:26,184 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 02:59:26,184 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 10, 34, 26, 184107), 'iat': datetime.datetime(2025, 7, 4, 9, 59, 26, 184110)}
2025-07-04 02:59:26,184 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 02:59:29,714 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:59:29,714 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:59:29,714 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:59:32,656 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:59:32,657 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:59:32,657 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:59:32,657 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624405, 'iat': 1751622605}
2025-07-04 02:59:32,657 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:59:32,664 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:59:32,664 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:59:32,664 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MjQ0MDUsImlhdCI6MTc1MTYyMjYwNX0.0C_yHLf15zCGRBu_e9shsfOwcRjsRzmxuw3AnFlfJpI
2025-07-04 02:59:32,665 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MjQ0MDUsImlhdCI6MTc1MTYyMjYwNX0.0C_yHLf15zCGRBu_e9shsfOwcRjsRzmxuw3AnFlfJpI
2025-07-04 02:59:44,304 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 02:59:44,304 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 02:59:44,304 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 02:59:44,304 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 10, 29, 44, 303873), 'iat': datetime.datetime(2025, 7, 4, 9, 59, 44, 303897)}
2025-07-04 02:59:44,305 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 02:59:44,305 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMjc5ODQsImlhdCI6MTc1MTYyMzE4NH0.ceBdoIXb08f9gMGUXZEbjYuC-jHceGOYFp7bF0kUEo8, Expiry (seconds): 604800
2025-07-04 02:59:44,307 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 02:59:45,449 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:59:45,449 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:59:45,451 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 02:59:45,451 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 02:59:45,453 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 02:59:45,459 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:59:45,459 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:59:45,460 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 02:59:45,460 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 02:59:45,460 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:59:45,473 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:59:45,475 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:59:45,475 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:59:45,485 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:59:45,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:59:45,489 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 02:59:45,489 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 02:59:45,489 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 02:59:45,489 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:59:45,489 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:59:45,491 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 02:59:45,491 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 02:59:45,491 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:59:45,508 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:59:45,508 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:59:45,508 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:59:45,514 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:59:45,514 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:59:45,515 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 02:59:45,515 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 02:59:45,515 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:59:45,528 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:59:45,528 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:59:46,100 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:59:46,100 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:59:46,100 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 02:59:46,100 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 02:59:46,100 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:59:46,109 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:59:46,109 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:59:46,387 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:59:46,388 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:59:46,388 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 02:59:46,388 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 02:59:46,388 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:59:46,392 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:59:46,392 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 02:59:46,411 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:59:46,412 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:59:46,415 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 02:59:58,585 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 02:59:58,585 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 02:59:58,586 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 02:59:58,586 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 02:59:58,586 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 02:59:58,590 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 02:59:58,590 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:03:16,611 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:03:16,611 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:06:19,436 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:06:19,436 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:06:19,439 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:06:19,439 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:06:19,444 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:06:19,444 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:06:19,444 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:06:19,444 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 10, 41, 19, 444043), 'iat': datetime.datetime(2025, 7, 4, 10, 6, 19, 444045)}
2025-07-04 03:06:19,444 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:06:26,037 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:06:26,037 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:06:26,038 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:06:26,589 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:06:26,589 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:06:26,590 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:06:26,590 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:06:26,590 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:06:26,597 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:06:26,597 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:06:49,200 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:06:49,200 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:06:49,201 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:06:49,201 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:06:49,201 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:06:49,210 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:06:49,210 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:09:48,757 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:09:48,759 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:09:51,458 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:09:51,459 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:09:51,462 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:09:51,462 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:09:51,465 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:09:51,465 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:09:51,465 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:09:51,466 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 10, 44, 51, 465915), 'iat': datetime.datetime(2025, 7, 4, 10, 9, 51, 465917)}
2025-07-04 03:09:51,466 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:09:53,435 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:09:53,435 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:09:55,575 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:09:55,575 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:09:55,579 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:09:55,579 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:09:55,583 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:09:55,583 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:09:55,583 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:09:55,583 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 10, 44, 55, 583600), 'iat': datetime.datetime(2025, 7, 4, 10, 9, 55, 583602)}
2025-07-04 03:09:55,584 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:09:57,266 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:09:57,266 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:09:57,266 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:09:57,275 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:09:57,275 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:09:57,275 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:09:57,275 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:09:57,275 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:09:57,409 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:09:57,409 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:10:06,818 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:10:06,819 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:10:06,820 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:06,820 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:06,820 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:10:06,830 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:10:06,830 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:10:13,536 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:10:13,536 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:10:13,537 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:13,538 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:13,538 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 03:10:13,538 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:10:13,538 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:10:13,538 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:13,538 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:13,538 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:10:13,541 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:10:13,541 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:10:13,541 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:10:14,082 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:10:14,082 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:10:14,082 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:14,083 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:14,083 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 03:10:14,083 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:10:14,083 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:10:14,083 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:14,083 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:14,083 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:10:14,085 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:10:14,085 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:10:14,085 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:10:14,848 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:10:14,848 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:10:14,848 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:14,849 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:14,849 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 03:10:14,849 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:10:14,849 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:10:14,849 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:14,849 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:14,850 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:10:14,857 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:10:14,857 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:10:14,857 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:10:15,423 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:10:15,423 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:10:15,423 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:15,423 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:15,423 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 03:10:15,423 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:10:15,423 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:10:15,423 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:15,423 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:15,423 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:10:15,428 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:10:15,428 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:10:15,428 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:10:15,963 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:10:15,964 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:10:15,964 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:15,964 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:15,964 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 03:10:15,964 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:10:15,964 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:10:15,965 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:15,965 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:15,965 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:10:15,970 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:10:15,971 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:10:15,971 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:10:16,541 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:10:16,541 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:10:16,541 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:16,542 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:16,542 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 03:10:16,542 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:10:16,542 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:10:16,542 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:16,542 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:16,543 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:10:16,550 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:10:16,550 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:10:16,550 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:10:49,309 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:10:49,309 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:10:49,309 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:49,309 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:49,309 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:10:49,312 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:10:49,312 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:10:58,272 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:10:58,272 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:10:58,272 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:58,272 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:10:58,273 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:10:58,280 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:10:58,280 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:11:09,330 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:11:09,331 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:13:00,435 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:13:00,435 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:13:00,442 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:13:00,442 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:13:00,449 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:13:00,449 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:13:00,449 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:13:00,449 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 10, 48, 0, 449683), 'iat': datetime.datetime(2025, 7, 4, 10, 13, 0, 449686)}
2025-07-04 03:13:00,450 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:13:05,069 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:05,069 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:05,070 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:13:06,419 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:06,420 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:06,420 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:13:06,420 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751624984, 'iat': 1751623184}
2025-07-04 03:13:06,421 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:13:06,428 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:13:06,429 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:13:06,429 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MjQ5ODQsImlhdCI6MTc1MTYyMzE4NH0.Uoq__vHHzAwjva9ZfRAtaSDAuC9yRq9-Iu45T9c-uVA
2025-07-04 03:13:06,431 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MjQ5ODQsImlhdCI6MTc1MTYyMzE4NH0.Uoq__vHHzAwjva9ZfRAtaSDAuC9yRq9-Iu45T9c-uVA
2025-07-04 03:13:28,895 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:13:28,895 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:13:28,895 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:13:28,895 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 4, 10, 43, 28, 895167), 'iat': datetime.datetime(2025, 7, 4, 10, 13, 28, 895178)}
2025-07-04 03:13:28,895 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:13:28,896 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIyMjg4MDgsImlhdCI6MTc1MTYyNDAwOH0.-ptZ0j5Xocs-EDaSDI6YJP4vOYbzVNhXNQac-WXXV8E, Expiry (seconds): 604800
2025-07-04 03:13:28,897 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-04 03:13:30,003 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:30,003 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:30,004 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:30,004 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:30,004 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 03:13:30,004 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:30,004 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:30,005 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:30,005 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:30,005 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 03:13:30,012 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 03:13:30,012 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:13:30,012 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:13:30,022 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:30,023 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:30,023 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:30,023 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:30,024 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 03:13:30,024 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:30,024 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:30,024 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:30,024 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:30,025 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 03:13:30,034 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:30,034 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:30,034 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:30,034 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:30,035 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 03:13:30,037 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 03:13:30,037 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:13:30,037 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:13:30,045 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 03:13:30,045 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:13:30,296 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:30,296 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:30,297 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:30,297 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:30,297 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 03:13:30,301 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 03:13:30,302 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:13:30,604 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:30,604 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:30,605 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:30,799 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:30,799 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:30,799 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:30,800 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:30,800 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 03:13:30,806 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 03:13:30,807 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:13:41,577 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:41,577 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:41,578 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:41,578 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:41,578 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 03:13:41,583 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 03:13:41,584 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:13:44,082 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:44,083 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:44,084 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:44,084 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:44,084 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 03:13:44,092 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 03:13:44,092 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:13:46,018 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:46,018 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:46,018 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:46,018 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:46,018 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 03:13:46,024 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 03:13:46,025 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:13:50,843 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:50,843 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:50,843 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:50,844 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:50,844 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 03:13:50,844 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:50,844 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:50,844 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:50,844 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:50,844 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 03:13:50,851 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 03:13:50,851 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:13:50,851 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:13:51,456 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:51,457 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:51,457 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:51,458 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:51,458 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 03:13:51,458 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:51,458 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:51,458 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:51,458 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:51,459 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 03:13:51,463 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 03:13:51,464 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:13:51,464 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:13:52,064 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:52,065 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:52,066 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:52,066 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:52,066 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 03:13:52,066 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:52,067 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:52,068 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:52,068 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:52,068 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 03:13:52,076 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 03:13:52,076 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:13:52,076 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:13:52,681 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:52,681 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:52,681 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:52,682 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:52,682 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 03:13:52,682 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:13:52,682 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:13:52,682 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:52,682 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:13:52,682 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 03:13:52,695 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 03:13:52,695 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:13:52,695 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:14:21,020 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:14:21,020 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:14:21,021 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:21,021 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:21,021 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 03:14:21,027 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 03:14:21,027 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:14:23,318 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:14:23,318 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:14:23,318 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:23,318 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:23,318 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 03:14:23,325 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 03:14:23,325 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:14:25,372 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:14:25,373 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:14:25,373 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:25,373 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:25,373 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 03:14:25,378 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 03:14:25,378 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:14:27,498 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:14:27,498 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:14:27,501 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:27,501 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:27,501 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 03:14:27,502 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:14:27,502 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:14:27,502 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:27,502 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:27,502 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 03:14:27,508 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 03:14:27,508 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:14:27,508 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:14:29,027 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:14:29,027 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:14:29,028 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:29,029 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:29,029 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 03:14:29,029 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:14:29,029 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:14:29,029 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:29,029 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:29,029 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 03:14:29,039 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 03:14:29,039 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:14:29,039 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:14:31,065 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:14:31,065 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:14:31,065 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:31,065 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:31,065 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 03:14:31,065 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:14:31,066 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:14:31,066 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:31,066 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:31,066 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 03:14:31,072 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 03:14:31,072 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:14:31,072 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:14:32,965 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:14:32,966 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:14:32,966 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:32,966 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:32,966 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 03:14:32,966 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:14:32,966 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:14:32,967 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:32,967 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:14:32,967 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 03:14:32,970 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 03:14:32,970 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:14:32,973 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:15:10,201 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:15:10,202 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:22:12,633 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:22:12,633 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:22:12,637 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:22:12,637 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:22:12,642 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:22:12,642 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:22:12,642 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:22:12,642 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 10, 57, 12, 642309), 'iat': datetime.datetime(2025, 7, 4, 10, 22, 12, 642313)}
2025-07-04 03:22:12,642 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:22:23,387 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:22:23,387 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:22:23,387 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:22:34,566 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:22:34,566 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:22:36,557 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:22:36,557 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:22:36,565 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:22:36,565 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:22:36,568 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:22:36,568 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:22:36,568 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:22:36,568 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 10, 57, 36, 568121), 'iat': datetime.datetime(2025, 7, 4, 10, 22, 36, 568123)}
2025-07-04 03:22:36,568 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:22:38,522 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:22:38,522 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:22:38,523 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:23:03,222 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:23:03,223 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:23:03,223 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:23:03,223 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751625808, 'iat': 1751624008}
2025-07-04 03:23:03,224 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 03:23:03,231 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 03:23:03,231 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 03:23:03,232 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE2MjU4MDgsImlhdCI6MTc1MTYyNDAwOH0.IIEWugmiY5oKXHvEPSbhh_V_ipNA1f4pH0ArAUFNC88
2025-07-04 03:23:03,233 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE2MjU4MDgsImlhdCI6MTc1MTYyNDAwOH0.IIEWugmiY5oKXHvEPSbhh_V_ipNA1f4pH0ArAUFNC88
2025-07-04 03:23:14,612 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:23:14,613 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:23:14,613 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:23:14,613 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 10, 53, 14, 612496), 'iat': datetime.datetime(2025, 7, 4, 10, 23, 14, 612516)}
2025-07-04 03:23:14,614 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:23:14,614 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMjkzOTQsImlhdCI6MTc1MTYyNDU5NH0.pogK6GaCGul3jizqmWWDql1xzsWCH9LwLbHx1ZYTKpY, Expiry (seconds): 604800
2025-07-04 03:23:14,617 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 03:23:15,711 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:23:15,711 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:23:15,711 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:15,711 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:15,712 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 03:23:15,712 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:23:15,712 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:23:15,712 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:15,712 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:15,712 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:23:15,719 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:23:15,720 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:23:15,720 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:23:15,732 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:23:15,732 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:23:15,732 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:15,732 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:15,732 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 03:23:15,732 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:23:15,733 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:23:15,733 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:15,733 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:15,733 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:23:15,735 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:23:15,735 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:23:15,735 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:15,735 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:15,735 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:23:15,741 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:23:15,741 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:23:15,741 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:23:15,744 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:23:15,744 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:23:15,958 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:23:15,959 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:23:15,959 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:15,959 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:15,959 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:23:15,963 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:23:15,963 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:23:16,272 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:23:16,272 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:23:16,272 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:16,285 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:23:16,285 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:23:16,286 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:16,286 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:16,286 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:23:16,331 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:23:16,331 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:23:31,758 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:23:31,759 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:23:31,759 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:31,760 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:31,760 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:23:31,767 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:23:31,768 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:23:56,857 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:23:56,857 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:23:56,857 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:56,857 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:56,857 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 03:23:56,858 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:23:56,858 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:23:56,858 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:56,858 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:56,858 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:23:56,862 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:23:56,863 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:23:56,863 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:23:56,869 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:23:56,869 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:23:56,870 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:56,870 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:56,871 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 03:23:56,871 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:23:56,871 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:23:56,871 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:56,871 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:56,871 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:23:56,876 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:23:56,877 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:23:56,877 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:23:56,880 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:23:56,880 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:23:56,880 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:56,880 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:56,881 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:23:56,887 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:23:56,887 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:23:57,099 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:23:57,099 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:23:57,099 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:57,100 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:57,100 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:23:57,103 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:23:57,103 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:23:57,439 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:23:57,439 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:23:57,441 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:57,633 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:23:57,633 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:23:57,633 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:57,634 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:23:57,634 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:23:57,641 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:23:57,641 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:24:33,965 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:24:33,966 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:24:36,545 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:24:36,545 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:24:36,557 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:24:36,557 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:24:36,560 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:24:36,560 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:24:36,560 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:24:36,560 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 10, 59, 36, 560753), 'iat': datetime.datetime(2025, 7, 4, 10, 24, 36, 560755)}
2025-07-04 03:24:36,561 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:24:38,577 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:24:38,579 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:24:41,117 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:24:41,117 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:24:41,120 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:24:41,121 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:24:41,124 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:24:41,124 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:24:41,124 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:24:41,124 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 10, 59, 41, 124546), 'iat': datetime.datetime(2025, 7, 4, 10, 24, 41, 124548)}
2025-07-04 03:24:41,124 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:24:42,500 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:24:42,500 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:24:42,501 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:24:42,501 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:24:42,501 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:24:42,616 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:24:42,616 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:24:43,888 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:24:43,888 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:24:43,888 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:25:32,272 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:25:32,273 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:25:32,273 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:25:32,273 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:25:32,273 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:25:32,277 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:25:32,278 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:25:55,174 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:25:55,176 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:25:57,219 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:25:57,219 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:25:57,223 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:25:57,223 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:25:57,227 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:25:57,227 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:25:57,227 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:25:57,227 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 11, 0, 57, 227085), 'iat': datetime.datetime(2025, 7, 4, 10, 25, 57, 227089)}
2025-07-04 03:25:57,227 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:25:58,763 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:25:58,763 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:25:58,763 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:26:00,128 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:26:00,128 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:26:00,128 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:26:00,128 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:26:00,128 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:26:00,134 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:26:00,134 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:28:32,793 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:28:32,793 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:28:32,793 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:28:32,794 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:28:32,794 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:28:32,798 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:28:32,798 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:28:38,771 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:28:38,771 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:28:38,773 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:28:38,773 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:28:38,773 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:28:38,782 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:28:38,783 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:29:40,448 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:29:40,449 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:29:42,920 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:29:42,920 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:29:42,923 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:29:42,923 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:29:42,926 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:29:42,926 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:29:42,926 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:29:42,926 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 11, 4, 42, 926663), 'iat': datetime.datetime(2025, 7, 4, 10, 29, 42, 926664)}
2025-07-04 03:29:42,927 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:29:44,576 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:29:44,576 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:29:44,576 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:29:52,145 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:29:52,145 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:29:52,145 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:29:52,146 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:29:52,146 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:29:52,171 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:29:52,171 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:30:00,091 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:30:00,091 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:30:00,091 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:30:00,091 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:30:00,091 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:30:00,093 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:30:00,094 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:31:03,401 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:31:03,401 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:31:06,024 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:31:06,024 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:31:06,028 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:31:06,028 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:31:06,031 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:31:06,031 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:31:06,031 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:31:06,031 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 11, 6, 6, 31777), 'iat': datetime.datetime(2025, 7, 4, 10, 31, 6, 31779)}
2025-07-04 03:31:06,032 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:31:08,146 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:31:08,146 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:31:08,146 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:31:11,202 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:31:11,203 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:31:11,203 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:31:11,203 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:31:11,204 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:31:11,211 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:31:11,211 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:37:17,804 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:37:17,804 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:37:17,807 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:37:17,807 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:37:17,810 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:37:17,810 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:37:17,810 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:37:17,810 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 11, 12, 17, 810587), 'iat': datetime.datetime(2025, 7, 4, 10, 37, 17, 810590)}
2025-07-04 03:37:17,811 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:37:20,133 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:37:20,133 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:37:20,134 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:37:26,954 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:37:26,954 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:37:26,955 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:37:26,955 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:37:26,955 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:37:26,969 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:37:26,969 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:37:59,293 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:37:59,294 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:37:59,294 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:37:59,294 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:37:59,295 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:37:59,305 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:37:59,305 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:38:12,667 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:38:12,668 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:38:50,596 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:38:50,596 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:38:50,610 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:38:50,610 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:38:50,613 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:38:50,613 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:38:50,613 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:38:50,613 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 11, 13, 50, 613829), 'iat': datetime.datetime(2025, 7, 4, 10, 38, 50, 613831)}
2025-07-04 03:38:50,614 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:38:56,076 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:38:56,077 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:38:56,078 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:38:57,707 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:38:57,707 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:38:57,708 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:38:57,708 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:38:57,708 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:38:57,718 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:38:57,719 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:39:46,967 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:39:46,968 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:40:13,672 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:40:13,672 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:40:13,675 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:40:13,675 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:40:13,678 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:40:13,678 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:40:13,678 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:40:13,678 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 11, 15, 13, 678346), 'iat': datetime.datetime(2025, 7, 4, 10, 40, 13, 678348)}
2025-07-04 03:40:13,678 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:40:15,691 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:40:15,691 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:40:15,691 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:40:18,432 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:40:18,432 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:40:18,433 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:40:18,433 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:40:18,433 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:40:18,440 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:40:18,441 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:41:09,799 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:41:09,800 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:41:12,247 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:41:12,247 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:41:12,251 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:41:12,252 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:41:12,257 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:41:12,257 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:41:12,258 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:41:12,258 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 11, 16, 12, 257900), 'iat': datetime.datetime(2025, 7, 4, 10, 41, 12, 257902)}
2025-07-04 03:41:12,258 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:41:14,696 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:41:14,696 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:41:14,697 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:41:25,975 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:41:25,976 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:41:28,362 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:41:28,362 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:41:28,375 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:41:28,375 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:41:28,381 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:41:28,381 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:41:28,381 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:41:28,381 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 11, 16, 28, 381222), 'iat': datetime.datetime(2025, 7, 4, 10, 41, 28, 381225)}
2025-07-04 03:41:28,381 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:41:30,100 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:41:30,100 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:41:30,100 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:41:30,100 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:41:30,100 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:41:30,102 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:41:30,102 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:41:30,102 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:41:30,204 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:41:30,204 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:41:44,505 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:41:44,506 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:41:46,560 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:41:46,561 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:41:46,564 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:41:46,565 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:41:46,570 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:41:46,570 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:41:46,570 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:41:46,570 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 11, 16, 46, 570280), 'iat': datetime.datetime(2025, 7, 4, 10, 41, 46, 570282)}
2025-07-04 03:41:46,570 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:41:48,083 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:41:48,083 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:41:48,084 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:41:50,674 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:41:50,675 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:41:50,676 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:41:50,676 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:41:50,676 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:41:50,691 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:41:50,691 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:44:05,315 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:44:05,315 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:48:02,034 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:48:02,034 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:48:02,046 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:48:02,047 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:48:02,050 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:48:02,050 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:48:02,050 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:48:02,050 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 11, 23, 2, 50665), 'iat': datetime.datetime(2025, 7, 4, 10, 48, 2, 50667)}
2025-07-04 03:48:02,051 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:48:04,273 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:48:04,273 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:48:04,273 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:48:15,512 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:48:15,512 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:48:15,512 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:48:15,513 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:48:15,513 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:48:15,518 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:48:15,519 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:49:50,392 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:49:50,393 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:49:52,383 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:49:52,383 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:49:52,390 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:49:52,391 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:49:52,393 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:49:52,393 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:49:52,393 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:49:52,394 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 11, 24, 52, 393930), 'iat': datetime.datetime(2025, 7, 4, 10, 49, 52, 393932)}
2025-07-04 03:49:52,394 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:49:55,011 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:49:55,014 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:49:55,014 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:49:55,015 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:49:55,018 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:49:57,115 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:49:57,115 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:49:57,118 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:49:57,118 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:49:57,121 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:49:57,121 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:49:57,121 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:49:57,121 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 11, 24, 57, 121105), 'iat': datetime.datetime(2025, 7, 4, 10, 49, 57, 121107)}
2025-07-04 03:49:57,121 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:50:00,700 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:50:00,701 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:50:00,701 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:50:04,247 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:50:04,247 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:50:04,247 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:50:04,247 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:50:04,248 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:50:04,257 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:50:04,257 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:50:39,535 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:50:39,535 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:50:39,536 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:50:39,536 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751626394, 'iat': 1751624594}
2025-07-04 03:50:39,537 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:50:39,545 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:50:39,545 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:51:18,141 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:51:18,144 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:55:35,806 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:55:35,806 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:55:35,812 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:55:35,812 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:55:35,815 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:55:35,815 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:55:35,815 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:55:35,815 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 11, 30, 35, 815670), 'iat': datetime.datetime(2025, 7, 4, 10, 55, 35, 815672)}
2025-07-04 03:55:35,816 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:55:39,811 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:55:39,811 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:55:39,811 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 03:55:45,966 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:55:45,966 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:55:45,966 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 03:55:52,227 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:55:52,227 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:55:52,227 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 03:55:58,467 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:55:58,467 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:55:58,467 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 03:56:06,393 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:56:06,393 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:56:06,393 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 03:56:09,058 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:56:09,059 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:56:09,059 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1752229394, 'iat': 1751624594}
2025-07-04 03:56:09,059 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMjkzOTQsImlhdCI6MTc1MTYyNDU5NH0.pogK6GaCGul3jizqmWWDql1xzsWCH9LwLbHx1ZYTKpY
2025-07-04 03:56:09,062 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:56:09,062 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:56:09,062 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:56:09,062 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 11, 26, 9, 62371), 'iat': datetime.datetime(2025, 7, 4, 10, 56, 9, 62374)}
2025-07-04 03:56:09,062 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:56:09,062 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMzEzNjksImlhdCI6MTc1MTYyNjU2OX0.zARZHNk_pbG4rry9h8NF4_JIDpwAUNbDLGoU1B2BT_k, Expiry (seconds): 604800
2025-07-04 03:56:09,063 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 03:56:11,711 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:56:11,711 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:56:11,712 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 03:56:19,087 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:56:19,088 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:56:19,088 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 03:56:19,088 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 03:56:19,088 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:56:19,092 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:56:19,093 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:56:55,085 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:56:55,086 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:56:55,086 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 03:56:55,086 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 03:56:55,086 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:56:55,093 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:56:55,094 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 03:57:32,095 - INFO - app.core.security - Closing Redis connection...
2025-07-04 03:57:32,096 - INFO - app.core.security - Redis connection closed.
2025-07-04 03:57:34,148 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 03:57:34,148 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 03:57:34,150 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 03:57:34,150 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 03:57:34,153 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 03:57:34,153 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 03:57:34,153 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 03:57:34,153 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 11, 32, 34, 153372), 'iat': datetime.datetime(2025, 7, 4, 10, 57, 34, 153374)}
2025-07-04 03:57:34,153 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 03:57:36,700 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:57:36,700 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:57:36,700 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 03:59:34,772 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 03:59:34,772 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 03:59:34,773 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 03:59:34,773 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 03:59:34,773 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 03:59:34,786 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 03:59:34,786 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:02:04,786 - INFO - app.core.security - Closing Redis connection...
2025-07-04 04:02:04,788 - INFO - app.core.security - Redis connection closed.
2025-07-04 04:02:06,973 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 04:02:06,973 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 04:02:06,977 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 04:02:06,977 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 04:02:06,983 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 04:02:06,983 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 04:02:06,983 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 04:02:06,983 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 11, 37, 6, 983132), 'iat': datetime.datetime(2025, 7, 4, 11, 2, 6, 983134)}
2025-07-04 04:02:06,983 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 04:02:09,708 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:02:09,708 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:02:09,709 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:02:18,287 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:02:18,287 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:02:18,288 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:02:18,288 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:02:18,288 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:02:18,288 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:02:18,288 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:02:18,288 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:02:18,288 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:02:18,288 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:02:18,295 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:02:18,296 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:02:18,296 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:02:41,653 - INFO - app.core.security - Closing Redis connection...
2025-07-04 04:02:41,654 - INFO - app.core.security - Redis connection closed.
2025-07-04 04:02:43,793 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 04:02:43,794 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 04:02:43,799 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 04:02:43,799 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 04:02:43,802 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 04:02:43,802 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 04:02:43,802 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 04:02:43,802 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 11, 37, 43, 802091), 'iat': datetime.datetime(2025, 7, 4, 11, 2, 43, 802093)}
2025-07-04 04:02:43,802 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 04:02:46,697 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:02:46,698 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:02:46,698 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:02:49,420 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:02:49,420 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:02:49,420 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:02:49,421 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:02:49,421 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:02:49,427 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:02:49,427 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:02:51,416 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:02:51,416 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:02:51,416 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:02:51,417 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:02:51,417 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:02:51,427 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:02:51,427 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:03:03,450 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:03:03,450 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:03:03,450 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:03:03,450 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:03:03,451 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:03:03,451 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:03:03,451 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:03:03,451 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:03:03,451 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:03:03,451 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:03:03,456 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:03:03,456 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:03:03,457 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:03:03,471 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:03:03,472 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:03:03,472 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:03:03,473 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:03:03,473 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:03:03,473 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:03:03,473 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:03:03,474 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:03:03,474 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:03:03,474 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:03:03,478 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:03:03,479 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:03:03,479 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:03:03,488 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:03:03,488 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:03:03,488 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:03:03,488 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:03:03,488 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:03:03,492 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:03:03,492 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:03:03,701 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:03:03,701 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:03:03,702 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:03:03,702 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:03:03,702 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:03:03,706 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:03:03,706 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:03:03,904 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:03:03,904 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:03:03,904 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:03:03,905 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:03:03,905 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:03:03,909 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:03:03,909 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:03:04,013 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:03:04,014 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:03:04,014 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:03:10,094 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:03:10,094 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:03:10,094 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:03:10,095 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:03:10,095 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:03:10,099 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:03:10,100 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:05:04,903 - INFO - app.core.security - Closing Redis connection...
2025-07-04 04:05:04,905 - INFO - app.core.security - Redis connection closed.
2025-07-04 04:23:56,050 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 04:23:56,050 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 04:23:56,067 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 04:23:56,067 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 04:23:56,072 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 04:23:56,072 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 04:23:56,072 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 04:23:56,072 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 11, 58, 56, 72668), 'iat': datetime.datetime(2025, 7, 4, 11, 23, 56, 72672)}
2025-07-04 04:23:56,073 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 04:24:01,139 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:01,140 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:01,141 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:24:01,142 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:24:01,142 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:24:01,142 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:01,142 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:01,143 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:24:01,143 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:24:01,143 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:24:01,163 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:24:01,163 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:01,164 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:01,187 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:01,188 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:01,188 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:24:01,188 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:24:01,189 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:24:01,189 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:01,189 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:01,189 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:24:01,190 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:24:01,190 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:24:01,196 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:01,196 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:01,197 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:24:01,197 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:24:01,197 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:24:01,203 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:24:01,203 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:01,203 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:01,217 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:24:01,218 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:01,452 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:01,452 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:01,452 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:24:01,452 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:24:01,453 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:24:01,457 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:24:01,458 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:01,682 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:01,682 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:01,683 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:24:01,683 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:24:01,683 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:24:01,689 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:24:01,689 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:05,010 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:05,011 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:05,012 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:24:10,874 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:10,874 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:10,875 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:24:10,875 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751628369, 'iat': 1751626569}
2025-07-04 04:24:10,875 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:24:10,879 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:24:10,879 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:10,879 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MjgzNjksImlhdCI6MTc1MTYyNjU2OX0.cupemZfnfOrsZJHAmz4MlkrJ2lolywlA36kavZKaY7Y
2025-07-04 04:24:10,881 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MjgzNjksImlhdCI6MTc1MTYyNjU2OX0.cupemZfnfOrsZJHAmz4MlkrJ2lolywlA36kavZKaY7Y
2025-07-04 04:24:21,249 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 04:24:21,249 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 04:24:21,249 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 04:24:21,249 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 11, 54, 21, 249141), 'iat': datetime.datetime(2025, 7, 4, 11, 24, 21, 249150)}
2025-07-04 04:24:21,250 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 04:24:21,250 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMzMwNjEsImlhdCI6MTc1MTYyODI2MX0.e1yQCkPB9fCAIdqrZKm50Jo6zYdp90LFFkIeU1vDUvE, Expiry (seconds): 604800
2025-07-04 04:24:21,255 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 04:24:22,367 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:22,368 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:22,368 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630061, 'iat': 1751628261}
2025-07-04 04:24:22,368 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630061, 'iat': 1751628261}
2025-07-04 04:24:22,368 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:24:22,368 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:22,368 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:22,369 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630061, 'iat': 1751628261}
2025-07-04 04:24:22,369 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630061, 'iat': 1751628261}
2025-07-04 04:24:22,370 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:24:22,374 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:24:22,374 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:22,374 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:22,380 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:22,380 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:22,381 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630061, 'iat': 1751628261}
2025-07-04 04:24:22,381 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630061, 'iat': 1751628261}
2025-07-04 04:24:22,381 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:24:22,381 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:22,381 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:22,382 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630061, 'iat': 1751628261}
2025-07-04 04:24:22,382 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630061, 'iat': 1751628261}
2025-07-04 04:24:22,382 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:24:22,385 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:22,386 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:22,386 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630061, 'iat': 1751628261}
2025-07-04 04:24:22,386 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630061, 'iat': 1751628261}
2025-07-04 04:24:22,386 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:24:22,390 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:24:22,390 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:22,390 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:22,396 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:24:22,396 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:22,642 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:22,642 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:22,643 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630061, 'iat': 1751628261}
2025-07-04 04:24:22,643 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630061, 'iat': 1751628261}
2025-07-04 04:24:22,643 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:24:22,656 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:24:22,656 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:22,976 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:22,976 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:22,976 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630061, 'iat': 1751628261}
2025-07-04 04:24:23,222 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:23,225 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:23,225 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630061, 'iat': 1751628261}
2025-07-04 04:24:23,225 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630061, 'iat': 1751628261}
2025-07-04 04:24:23,226 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:24:23,239 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:24:23,239 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:30,815 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:30,815 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:30,815 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630061, 'iat': 1751628261}
2025-07-04 04:24:30,815 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630061, 'iat': 1751628261}
2025-07-04 04:24:30,815 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:24:30,822 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:24:30,822 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:30,823 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MzAwNjEsImlhdCI6MTc1MTYyODI2MX0.JUd2P5jTjMEeFOHHvYy3Jb7J0odZZ41-NH8FVB58xbI
2025-07-04 04:24:30,825 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MzAwNjEsImlhdCI6MTc1MTYyODI2MX0.JUd2P5jTjMEeFOHHvYy3Jb7J0odZZ41-NH8FVB58xbI
2025-07-04 04:24:40,778 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 04:24:40,778 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 04:24:40,778 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 04:24:40,778 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 11, 54, 40, 777975), 'iat': datetime.datetime(2025, 7, 4, 11, 24, 40, 777985)}
2025-07-04 04:24:40,779 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 04:24:40,779 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMzMwODAsImlhdCI6MTc1MTYyODI4MH0.n-WJTPfEstP9eklJKSBS185-ZHGvKVftE20526-ocFY, Expiry (seconds): 604800
2025-07-04 04:24:40,781 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 04:24:41,947 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:41,947 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:41,948 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630080, 'iat': 1751628280}
2025-07-04 04:24:41,948 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630080, 'iat': 1751628280}
2025-07-04 04:24:41,948 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:24:41,948 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:41,948 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:41,949 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630080, 'iat': 1751628280}
2025-07-04 04:24:41,949 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630080, 'iat': 1751628280}
2025-07-04 04:24:41,949 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:24:41,955 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:24:41,956 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:41,956 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:41,963 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:41,963 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:41,964 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630080, 'iat': 1751628280}
2025-07-04 04:24:41,964 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630080, 'iat': 1751628280}
2025-07-04 04:24:41,964 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:24:41,964 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:41,964 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:41,965 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630080, 'iat': 1751628280}
2025-07-04 04:24:41,965 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630080, 'iat': 1751628280}
2025-07-04 04:24:41,965 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:24:41,970 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:24:41,970 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:41,970 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:41,979 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:41,979 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:41,980 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630080, 'iat': 1751628280}
2025-07-04 04:24:41,980 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630080, 'iat': 1751628280}
2025-07-04 04:24:41,980 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:24:41,984 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:24:41,984 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:42,449 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:42,449 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:42,450 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630080, 'iat': 1751628280}
2025-07-04 04:24:42,451 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630080, 'iat': 1751628280}
2025-07-04 04:24:42,451 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:24:42,457 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:24:42,457 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:42,702 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:42,702 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:42,702 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630080, 'iat': 1751628280}
2025-07-04 04:24:42,702 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630080, 'iat': 1751628280}
2025-07-04 04:24:42,702 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:24:42,707 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:24:42,708 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:24:42,827 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:24:42,827 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:24:42,828 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630080, 'iat': 1751628280}
2025-07-04 04:24:55,951 - INFO - app.core.security - Closing Redis connection...
2025-07-04 04:24:55,951 - INFO - app.core.security - Redis connection closed.
2025-07-04 04:32:25,888 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 04:32:25,889 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 04:32:25,898 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 04:32:25,899 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 04:32:25,903 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 04:32:25,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 04:32:25,903 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 04:32:25,903 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 12, 7, 25, 903052), 'iat': datetime.datetime(2025, 7, 4, 11, 32, 25, 903054)}
2025-07-04 04:32:25,903 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 04:32:36,679 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 04:32:36,679 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 04:32:36,679 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 04:32:36,679 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 12, 2, 36, 679106), 'iat': datetime.datetime(2025, 7, 4, 11, 32, 36, 679114)}
2025-07-04 04:32:36,680 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 04:32:36,680 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMzM1NTYsImlhdCI6MTc1MTYyODc1Nn0.voagvm1cwfOEbbnItkXMggTfShy05SMsxb-KbUPvtto, Expiry (seconds): 604800
2025-07-04 04:32:36,685 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 04:32:38,483 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:32:38,484 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:32:38,485 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630556, 'iat': 1751628756}
2025-07-04 04:32:38,485 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630556, 'iat': 1751628756}
2025-07-04 04:32:38,485 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:32:38,485 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:32:38,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:32:38,486 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630556, 'iat': 1751628756}
2025-07-04 04:32:38,486 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630556, 'iat': 1751628756}
2025-07-04 04:32:38,486 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:32:38,493 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:32:38,493 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:32:38,493 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:32:38,500 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:32:38,500 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:32:38,500 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630556, 'iat': 1751628756}
2025-07-04 04:32:38,501 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630556, 'iat': 1751628756}
2025-07-04 04:32:38,501 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:32:38,501 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:32:38,501 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:32:38,501 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630556, 'iat': 1751628756}
2025-07-04 04:32:38,501 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630556, 'iat': 1751628756}
2025-07-04 04:32:38,501 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:32:38,504 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:32:38,504 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:32:38,505 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630556, 'iat': 1751628756}
2025-07-04 04:32:38,505 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630556, 'iat': 1751628756}
2025-07-04 04:32:38,505 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:32:38,508 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:32:38,508 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:32:38,508 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:32:38,511 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:32:38,511 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:32:38,691 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:32:38,691 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:32:38,692 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630556, 'iat': 1751628756}
2025-07-04 04:32:38,692 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630556, 'iat': 1751628756}
2025-07-04 04:32:38,692 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:32:38,696 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:32:38,696 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:32:39,013 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:32:39,013 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:32:39,013 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630556, 'iat': 1751628756}
2025-07-04 04:32:39,370 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:32:39,370 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:32:39,370 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630556, 'iat': 1751628756}
2025-07-04 04:32:39,370 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630556, 'iat': 1751628756}
2025-07-04 04:32:39,371 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:32:39,377 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:32:39,377 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:32:48,903 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:32:48,903 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:32:48,904 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630556, 'iat': 1751628756}
2025-07-04 04:32:48,904 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751630556, 'iat': 1751628756}
2025-07-04 04:32:48,904 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:32:48,910 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:32:48,910 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:32:48,910 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MzA1NTYsImlhdCI6MTc1MTYyODc1Nn0.m_AGrrvhJ9hvT2K2Xr-DegXh99lN1uWDtEXC3oiek4A
2025-07-04 04:32:48,912 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MzA1NTYsImlhdCI6MTc1MTYyODc1Nn0.m_AGrrvhJ9hvT2K2Xr-DegXh99lN1uWDtEXC3oiek4A
2025-07-04 04:32:59,057 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 04:32:59,058 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 04:32:59,058 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 04:32:59,059 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 4, 12, 2, 59, 57876), 'iat': datetime.datetime(2025, 7, 4, 11, 32, 59, 57884)}
2025-07-04 04:32:59,059 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 04:32:59,060 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIyMzM1NzksImlhdCI6MTc1MTYyODc3OX0.OGsunA1ky0EUvvF8V4TpH2Qh-tm86jbWlyRSwSy5lIE, Expiry (seconds): 604800
2025-07-04 04:32:59,063 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-04 04:33:00,162 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:33:00,162 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:33:00,163 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:00,163 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:00,163 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:33:00,163 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:33:00,163 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:33:00,163 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:00,163 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:00,164 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:33:00,170 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:33:00,170 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:33:00,170 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:33:00,175 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:33:00,175 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:33:00,176 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:00,176 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:00,176 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:33:00,176 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:33:00,176 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:33:00,177 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:00,177 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:00,177 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:33:00,180 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:33:00,180 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:33:00,180 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:00,180 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:00,180 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:33:00,184 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:33:00,184 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:33:00,185 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:33:00,188 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:33:00,189 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:33:00,471 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:33:00,471 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:33:00,471 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:00,472 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:00,472 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:33:00,477 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:33:00,477 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:33:00,708 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:33:00,708 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:33:00,709 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:00,709 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:00,709 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:33:00,714 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:33:00,714 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:33:00,779 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:33:00,779 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:33:00,779 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:07,741 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:33:07,741 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:33:07,741 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:07,741 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:07,741 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:33:07,746 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:33:07,746 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:33:09,938 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:33:09,938 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:33:09,938 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:09,938 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:09,938 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:33:09,944 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:33:09,944 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:33:13,437 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:33:13,438 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:33:13,438 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:13,438 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:13,438 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:33:13,450 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:33:13,450 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:33:23,318 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:33:23,318 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:33:23,319 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:23,319 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:23,320 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:33:23,323 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:33:23,323 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:33:30,038 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:33:30,038 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:33:30,039 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:30,039 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:33:30,040 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:33:30,048 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:33:30,049 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:35:15,291 - INFO - app.core.security - Closing Redis connection...
2025-07-04 04:35:15,293 - INFO - app.core.security - Redis connection closed.
2025-07-04 04:35:17,896 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 04:35:17,896 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 04:35:17,899 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 04:35:17,899 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 04:35:17,902 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 04:35:17,902 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 04:35:17,902 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 04:35:17,902 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 12, 10, 17, 902200), 'iat': datetime.datetime(2025, 7, 4, 11, 35, 17, 902202)}
2025-07-04 04:35:17,902 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 04:35:19,691 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:35:19,691 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:35:19,691 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:41:02,329 - INFO - app.core.security - Closing Redis connection...
2025-07-04 04:41:02,330 - INFO - app.core.security - Redis connection closed.
2025-07-04 04:41:04,370 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 04:41:04,370 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 04:41:04,383 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 04:41:04,383 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 04:41:04,387 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 04:41:04,387 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 04:41:04,387 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 04:41:04,387 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 12, 16, 4, 387206), 'iat': datetime.datetime(2025, 7, 4, 11, 41, 4, 387208)}
2025-07-04 04:41:04,387 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 04:41:06,255 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:41:06,255 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:41:06,255 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:41:12,169 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:41:12,170 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:41:12,171 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:41:12,171 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:41:12,171 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:41:12,219 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:41:12,220 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:41:21,831 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:41:21,831 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:41:21,832 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:41:21,833 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:41:21,834 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:41:21,846 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:41:21,848 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:52:00,937 - INFO - app.core.security - Closing Redis connection...
2025-07-04 04:52:00,939 - INFO - app.core.security - Redis connection closed.
2025-07-04 04:54:05,042 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 04:54:05,042 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 04:54:05,045 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 04:54:05,045 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 04:54:05,049 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 04:54:05,049 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 04:54:05,049 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 04:54:05,049 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 12, 29, 5, 49170), 'iat': datetime.datetime(2025, 7, 4, 11, 54, 5, 49172)}
2025-07-04 04:54:05,049 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 04:54:07,882 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:54:07,882 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:54:07,882 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:54:28,750 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:54:28,750 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:54:28,751 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:54:28,751 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751630579, 'iat': 1751628779}
2025-07-04 04:54:28,751 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:54:28,758 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:54:28,758 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:54:28,758 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE2MzA1NzksImlhdCI6MTc1MTYyODc3OX0.6QJVlCwvZphj1xK3i8L0SuWAliBdx-B8R34AaKXSNuc
2025-07-04 04:54:28,759 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE2MzA1NzksImlhdCI6MTc1MTYyODc3OX0.6QJVlCwvZphj1xK3i8L0SuWAliBdx-B8R34AaKXSNuc
2025-07-04 04:54:41,171 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 04:54:41,172 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 04:54:41,172 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 04:54:41,172 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 4, 12, 24, 41, 171806), 'iat': datetime.datetime(2025, 7, 4, 11, 54, 41, 171815)}
2025-07-04 04:54:41,172 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 04:54:41,172 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIyMzQ4ODEsImlhdCI6MTc1MTYzMDA4MX0.I834YKh3JidJdHgA2UO2Ni52Pc0J_kARrgqzIDZ7hCE, Expiry (seconds): 604800
2025-07-04 04:54:41,174 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-04 04:54:42,289 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:54:42,289 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:54:42,290 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:54:42,290 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:54:42,290 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:54:42,290 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:54:42,290 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:54:42,290 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:54:42,291 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:54:42,291 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:54:42,294 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:54:42,295 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:54:42,295 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:54:42,308 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:54:42,309 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:54:42,309 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:54:42,309 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:54:42,309 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:54:42,309 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:54:42,310 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:54:42,310 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:54:42,310 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:54:42,310 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:54:42,314 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:54:42,314 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:54:42,314 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:54:42,329 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:54:42,329 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:54:42,330 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:54:42,330 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:54:42,330 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:54:42,335 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:54:42,336 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:54:42,606 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:54:42,607 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:54:42,607 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:54:42,607 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:54:42,608 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:54:42,613 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:54:42,614 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:54:42,914 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:54:42,914 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:54:42,914 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:54:42,975 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:54:42,975 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:54:42,976 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:54:42,976 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:54:42,976 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:54:42,983 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:54:42,983 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:54:52,309 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:54:52,310 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:54:52,310 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:54:52,310 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:54:52,310 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:54:52,317 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:54:52,318 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:54:57,635 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:54:57,635 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:54:57,635 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:54:57,635 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:54:57,635 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:54:57,640 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:54:57,640 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:55:00,748 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:55:00,749 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:55:00,749 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:00,749 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:00,750 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:55:00,756 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:55:00,757 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:55:11,920 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:55:11,920 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:55:11,921 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:11,921 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:11,921 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:55:11,921 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:55:11,921 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:55:11,921 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:11,921 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:11,922 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:55:11,928 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:55:11,928 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:55:11,929 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:55:18,292 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:55:18,292 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:55:18,292 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:18,292 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:18,293 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:55:18,293 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:55:18,293 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:55:18,293 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:18,293 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:18,293 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:55:18,299 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:55:18,300 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:55:18,300 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:55:20,399 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:55:20,399 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:55:20,400 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:20,400 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:20,400 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:55:20,401 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:55:20,401 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:55:20,401 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:20,401 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:20,401 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:55:20,422 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:55:20,423 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:55:20,423 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:55:26,241 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:55:26,241 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:55:26,241 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:26,242 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:26,242 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:55:26,242 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:55:26,242 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:55:26,242 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:26,243 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:26,243 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:55:26,247 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:55:26,247 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:55:26,247 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:55:36,777 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:55:36,777 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:55:36,778 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:36,778 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:36,779 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:55:36,794 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:55:36,794 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:55:45,959 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:55:45,960 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:55:45,960 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:45,960 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751631881, 'iat': 1751630081}
2025-07-04 04:55:45,960 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 04:55:45,966 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 04:55:45,966 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 04:55:45,966 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE2MzE4ODEsImlhdCI6MTc1MTYzMDA4MX0.ZpjwnJRlF_rG6SRp7ncWAD1E6ubCvPmBJMFvu1q8wKw
2025-07-04 04:55:45,967 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE2MzE4ODEsImlhdCI6MTc1MTYzMDA4MX0.ZpjwnJRlF_rG6SRp7ncWAD1E6ubCvPmBJMFvu1q8wKw
2025-07-04 04:55:59,710 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 04:55:59,711 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 04:55:59,711 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 04:55:59,711 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 12, 25, 59, 710746), 'iat': datetime.datetime(2025, 7, 4, 11, 55, 59, 710756)}
2025-07-04 04:55:59,712 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 04:55:59,712 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMzQ5NTksImlhdCI6MTc1MTYzMDE1OX0.F_2lKTjT7CStSbA3Sci2-UsZ7-D4cV1wSAJUcBlHuXI, Expiry (seconds): 604800
2025-07-04 04:55:59,716 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 04:56:00,871 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:56:00,872 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:56:00,872 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 04:56:00,872 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 04:56:00,873 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:56:00,873 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:56:00,873 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:56:00,874 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 04:56:00,874 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 04:56:00,874 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:56:00,881 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:56:00,881 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:56:00,882 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:56:00,894 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:56:00,894 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:56:00,895 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 04:56:00,895 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 04:56:00,895 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 04:56:00,895 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:56:00,895 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:56:00,896 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 04:56:00,896 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 04:56:00,896 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:56:00,901 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:56:00,901 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:56:00,902 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 04:56:00,902 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 04:56:00,902 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:56:00,907 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:56:00,907 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:56:00,907 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:56:00,912 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:56:00,912 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:56:01,160 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:56:01,160 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:56:01,160 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 04:56:01,160 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 04:56:01,161 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:56:01,166 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:56:01,166 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:56:01,473 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:56:01,473 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:56:01,474 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 04:56:01,743 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:56:01,743 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:56:01,744 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 04:56:01,744 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 04:56:01,744 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:56:01,751 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:56:01,752 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:56:08,618 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:56:08,618 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:56:08,618 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 04:56:08,619 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 04:56:08,619 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:56:08,629 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:56:08,629 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 04:56:26,641 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 04:56:26,642 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 04:56:26,643 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 04:56:26,643 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 04:56:26,643 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 04:56:26,652 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 04:56:26,652 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:00:43,914 - INFO - app.core.security - Closing Redis connection...
2025-07-04 05:00:43,918 - INFO - app.core.security - Redis connection closed.
2025-07-04 05:02:05,408 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 05:02:05,408 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 05:02:05,411 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 05:02:05,412 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 05:02:05,417 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 05:02:05,417 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 05:02:05,417 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 05:02:05,417 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 12, 37, 5, 417544), 'iat': datetime.datetime(2025, 7, 4, 12, 2, 5, 417546)}
2025-07-04 05:02:05,417 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 05:02:07,629 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:02:07,629 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:02:07,629 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 05:02:07,789 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:02:07,789 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:02:07,789 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 05:02:07,790 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751631959, 'iat': 1751630159}
2025-07-04 05:02:07,790 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:02:07,794 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:02:07,794 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:02:07,794 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MzE5NTksImlhdCI6MTc1MTYzMDE1OX0.aVi_7IipHm-deEnMDUm2gdYm93M405MBsRWYWSxdWAA
2025-07-04 05:02:07,794 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MzE5NTksImlhdCI6MTc1MTYzMDE1OX0.aVi_7IipHm-deEnMDUm2gdYm93M405MBsRWYWSxdWAA
2025-07-04 05:02:24,533 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 05:02:24,534 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 05:02:24,534 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 05:02:24,535 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 12, 32, 24, 533576), 'iat': datetime.datetime(2025, 7, 4, 12, 2, 24, 533601)}
2025-07-04 05:02:24,535 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 05:02:24,535 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMzUzNDQsImlhdCI6MTc1MTYzMDU0NH0.IMVPOim9Wt3huwAF9f-4VZVZYx_YNLSHeh8nifYitUY, Expiry (seconds): 604800
2025-07-04 05:02:24,539 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 05:02:26,134 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:02:26,134 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:02:26,134 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632344, 'iat': 1751630544}
2025-07-04 05:02:26,134 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632344, 'iat': 1751630544}
2025-07-04 05:02:26,134 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:02:26,135 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:02:26,135 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:02:26,135 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632344, 'iat': 1751630544}
2025-07-04 05:02:26,135 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632344, 'iat': 1751630544}
2025-07-04 05:02:26,135 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:02:26,138 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:02:26,139 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:02:26,139 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:02:26,143 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:02:26,143 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:02:26,144 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632344, 'iat': 1751630544}
2025-07-04 05:02:26,144 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632344, 'iat': 1751630544}
2025-07-04 05:02:26,144 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:02:26,144 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:02:26,144 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:02:26,144 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632344, 'iat': 1751630544}
2025-07-04 05:02:26,144 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632344, 'iat': 1751630544}
2025-07-04 05:02:26,144 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:02:26,150 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:02:26,150 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:02:26,150 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:02:26,152 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:02:26,152 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:02:26,153 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632344, 'iat': 1751630544}
2025-07-04 05:02:26,153 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632344, 'iat': 1751630544}
2025-07-04 05:02:26,153 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:02:26,171 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:02:26,171 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:02:26,411 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:02:26,411 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:02:26,411 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632344, 'iat': 1751630544}
2025-07-04 05:02:26,411 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632344, 'iat': 1751630544}
2025-07-04 05:02:26,412 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:02:26,417 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:02:26,418 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:02:26,621 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:02:26,621 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:02:26,621 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632344, 'iat': 1751630544}
2025-07-04 05:02:26,621 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632344, 'iat': 1751630544}
2025-07-04 05:02:26,622 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:02:26,626 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:02:26,626 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:02:26,721 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:02:26,721 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:02:26,721 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632344, 'iat': 1751630544}
2025-07-04 05:09:31,859 - INFO - app.core.security - Closing Redis connection...
2025-07-04 05:09:31,860 - INFO - app.core.security - Redis connection closed.
2025-07-04 05:09:34,989 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 05:09:34,989 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 05:09:34,992 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 05:09:34,992 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 05:09:34,995 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 05:09:34,995 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 05:09:34,995 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 05:09:34,995 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 12, 44, 34, 995660), 'iat': datetime.datetime(2025, 7, 4, 12, 9, 34, 995662)}
2025-07-04 05:09:34,996 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 05:09:36,698 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:09:36,698 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:09:36,698 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632344, 'iat': 1751630544}
2025-07-04 05:10:01,977 - INFO - app.core.security - Closing Redis connection...
2025-07-04 05:10:01,978 - INFO - app.core.security - Redis connection closed.
2025-07-04 05:10:07,146 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 05:10:07,146 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 05:10:07,149 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 05:10:07,149 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 05:10:07,152 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 05:10:07,152 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 05:10:07,152 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 05:10:07,152 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 12, 45, 7, 152572), 'iat': datetime.datetime(2025, 7, 4, 12, 10, 7, 152574)}
2025-07-04 05:10:07,152 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 05:10:11,655 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:10:11,655 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:10:11,656 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632344, 'iat': 1751630544}
2025-07-04 05:10:11,656 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632344, 'iat': 1751630544}
2025-07-04 05:10:11,656 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:10:11,669 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:10:11,669 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:10:11,669 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MzIzNDQsImlhdCI6MTc1MTYzMDU0NH0.ZjIytd2kmC2I57uBYgcBv09pE4PyI5C9V44KEufTYVQ
2025-07-04 05:10:11,670 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MzIzNDQsImlhdCI6MTc1MTYzMDU0NH0.ZjIytd2kmC2I57uBYgcBv09pE4PyI5C9V44KEufTYVQ
2025-07-04 05:10:27,240 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 05:10:27,240 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 05:10:27,241 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 05:10:27,241 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 12, 40, 27, 240568), 'iat': datetime.datetime(2025, 7, 4, 12, 10, 27, 240582)}
2025-07-04 05:10:27,241 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 05:10:27,241 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMzU4MjcsImlhdCI6MTc1MTYzMTAyN30.-3XLANLwCpvcTZAjwyyHDJMejEy3pqHBhbX7_FVXs2k, Expiry (seconds): 604800
2025-07-04 05:10:27,245 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 05:10:28,341 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:10:28,341 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:10:28,342 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632827, 'iat': 1751631027}
2025-07-04 05:10:28,342 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632827, 'iat': 1751631027}
2025-07-04 05:10:28,342 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:10:28,342 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:10:28,343 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:10:28,343 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632827, 'iat': 1751631027}
2025-07-04 05:10:28,343 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632827, 'iat': 1751631027}
2025-07-04 05:10:28,343 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:10:28,347 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:10:28,347 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:10:28,348 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:10:28,353 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:10:28,353 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:10:28,354 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632827, 'iat': 1751631027}
2025-07-04 05:10:28,354 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632827, 'iat': 1751631027}
2025-07-04 05:10:28,354 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:10:28,354 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:10:28,354 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:10:28,355 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632827, 'iat': 1751631027}
2025-07-04 05:10:28,355 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632827, 'iat': 1751631027}
2025-07-04 05:10:28,355 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:10:28,357 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:10:28,357 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:10:28,358 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632827, 'iat': 1751631027}
2025-07-04 05:10:28,358 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632827, 'iat': 1751631027}
2025-07-04 05:10:28,358 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:10:28,362 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:10:28,362 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:10:28,362 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:10:28,366 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:10:28,366 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:10:28,584 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:10:28,584 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:10:28,585 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632827, 'iat': 1751631027}
2025-07-04 05:10:28,585 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632827, 'iat': 1751631027}
2025-07-04 05:10:28,585 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:10:28,589 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:10:28,589 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:10:28,893 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:10:28,893 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:10:28,894 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632827, 'iat': 1751631027}
2025-07-04 05:10:28,894 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632827, 'iat': 1751631027}
2025-07-04 05:10:28,894 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:10:28,902 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:10:28,902 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:10:28,907 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:10:28,907 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:10:28,908 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632827, 'iat': 1751631027}
2025-07-04 05:10:34,876 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:10:34,876 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:10:34,876 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632827, 'iat': 1751631027}
2025-07-04 05:10:34,877 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632827, 'iat': 1751631027}
2025-07-04 05:10:34,877 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:10:34,880 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:10:34,881 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:10:34,881 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MzI4MjcsImlhdCI6MTc1MTYzMTAyN30.klhsV6va7_tif4zyg3QYFHqAhgwRxRTnuctpE9mXmSY
2025-07-04 05:10:34,882 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MzI4MjcsImlhdCI6MTc1MTYzMTAyN30.klhsV6va7_tif4zyg3QYFHqAhgwRxRTnuctpE9mXmSY
2025-07-04 05:10:45,031 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 05:10:45,031 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 05:10:45,031 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 05:10:45,032 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 12, 40, 45, 31071), 'iat': datetime.datetime(2025, 7, 4, 12, 10, 45, 31084)}
2025-07-04 05:10:45,032 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 05:10:45,032 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMzU4NDUsImlhdCI6MTc1MTYzMTA0NX0.D_B12WoTIaepSWWWX5Hupq8TJraXcrzyIfNwbiAf79U, Expiry (seconds): 604800
2025-07-04 05:10:45,036 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 05:10:46,175 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:10:46,176 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:10:46,176 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:10:46,176 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:10:46,176 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:10:46,176 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:10:46,176 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:10:46,177 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:10:46,177 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:10:46,177 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:10:46,183 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:10:46,183 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:10:46,183 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:10:46,206 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:10:46,206 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:10:46,206 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:10:46,207 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:10:46,207 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:10:46,207 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:10:46,208 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:10:46,209 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:10:46,209 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:10:46,209 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:10:46,212 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:10:46,212 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:10:46,212 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:10:46,212 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:10:46,212 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:10:46,219 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:10:46,219 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:10:46,219 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:10:46,224 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:10:46,224 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:10:46,469 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:10:46,469 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:10:46,469 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:10:46,469 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:10:46,469 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:10:46,474 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:10:46,474 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:10:46,686 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:10:46,687 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:10:46,687 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:10:46,687 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:10:46,687 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:10:46,691 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:10:46,691 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:10:46,785 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:10:46,785 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:10:46,786 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:31,220 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:11:31,220 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:11:31,220 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:31,220 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:31,220 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:11:31,220 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:11:31,220 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:11:31,220 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:31,220 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:31,220 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:11:31,224 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:11:31,224 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:11:31,224 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:11:31,229 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:11:31,229 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:11:31,230 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:31,230 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:31,230 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:11:31,230 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:11:31,230 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:11:31,230 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:31,231 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:31,231 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:11:31,234 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:11:31,234 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:11:31,235 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:11:42,600 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:11:42,600 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:11:42,601 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:42,601 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:42,601 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:11:42,601 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:11:42,601 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:11:42,602 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:42,602 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:42,602 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:11:42,606 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:11:42,607 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:11:42,607 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:11:42,625 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:11:42,625 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:11:42,626 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:42,627 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:42,627 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:11:42,627 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:11:42,627 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:11:42,627 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:42,627 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:42,628 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:11:42,630 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:11:42,630 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:11:42,631 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:42,631 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:42,631 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:11:42,635 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:11:42,636 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:11:42,636 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:11:42,640 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:11:42,640 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:11:42,935 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:11:42,936 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:11:42,938 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:42,940 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:42,941 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:11:42,948 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:11:42,949 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:11:43,258 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:11:43,258 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:11:43,259 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:43,608 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:11:43,608 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:11:43,608 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:43,608 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:11:43,608 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:11:43,614 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:11:43,614 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:12:02,339 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:12:02,339 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:12:02,340 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:12:02,340 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632845, 'iat': 1751631045}
2025-07-04 05:12:02,340 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:12:02,345 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:12:02,345 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:12:02,346 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MzI4NDUsImlhdCI6MTc1MTYzMTA0NX0.vfWuz0_n4Eks-O69AGYUfKSgn6kKAAfUVgdEYEQRa-A
2025-07-04 05:12:02,347 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MzI4NDUsImlhdCI6MTc1MTYzMTA0NX0.vfWuz0_n4Eks-O69AGYUfKSgn6kKAAfUVgdEYEQRa-A
2025-07-04 05:12:10,628 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 05:12:10,628 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 05:12:10,628 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 05:12:10,628 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 12, 42, 10, 628325), 'iat': datetime.datetime(2025, 7, 4, 12, 12, 10, 628347)}
2025-07-04 05:12:10,629 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 05:12:10,629 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMzU5MzAsImlhdCI6MTc1MTYzMTEzMH0.Kk9AfEbR3zusLLJpoZOkzXQfWH_P7BaKbaGrT8T90iM, Expiry (seconds): 604800
2025-07-04 05:12:10,630 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 05:12:11,724 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:12:11,724 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:12:11,725 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:11,725 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:11,725 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:12:11,725 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:12:11,725 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:12:11,725 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:11,725 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:11,725 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:12:11,730 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:12:11,731 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:12:11,731 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:12:11,736 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:12:11,737 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:12:11,737 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:11,737 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:11,738 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:12:11,738 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:12:11,738 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:12:11,738 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:11,738 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:11,738 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:12:11,743 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:12:11,744 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:12:11,744 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:12:11,749 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:12:11,749 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:12:11,750 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:11,750 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:11,750 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:12:11,755 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:12:11,755 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:12:11,952 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:12:11,953 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:12:11,953 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:11,953 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:11,953 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:12:11,957 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:12:11,957 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:12:12,157 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:12:12,157 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:12:12,157 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:12,157 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:12,158 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:12:12,162 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:12:12,163 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:12:12,263 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:12:12,264 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:12:12,266 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:48,331 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:12:48,331 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:12:48,333 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:48,333 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:48,333 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:12:48,333 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:12:48,334 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:12:48,334 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:48,334 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:48,335 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:12:48,340 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:12:48,340 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:12:48,340 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:12:48,350 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:12:48,350 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:12:48,351 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:48,351 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:48,351 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:12:48,351 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:12:48,351 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:12:48,352 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:48,352 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:48,352 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:12:48,355 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:12:48,355 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:12:48,356 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:12:48,654 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:12:48,654 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:12:48,654 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:48,654 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:48,654 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:12:48,660 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:12:48,660 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:12:48,918 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:12:48,918 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:12:48,918 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:48,919 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:48,919 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:12:48,923 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:12:48,924 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:12:49,135 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:12:49,136 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:12:49,136 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:49,136 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:12:49,136 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:12:49,140 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:12:49,141 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:12:49,233 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:12:49,234 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:12:49,234 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:13:18,135 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:13:18,135 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:13:18,135 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:13:18,136 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751632930, 'iat': 1751631130}
2025-07-04 05:13:18,136 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:13:18,140 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:13:18,140 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:13:18,141 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MzI5MzAsImlhdCI6MTc1MTYzMTEzMH0.XAdKshijEH1wtmW_MQxNXhkUvsOx0a5nApp_SFfajak
2025-07-04 05:13:18,142 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MzI5MzAsImlhdCI6MTc1MTYzMTEzMH0.XAdKshijEH1wtmW_MQxNXhkUvsOx0a5nApp_SFfajak
2025-07-04 05:13:33,579 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 05:13:33,581 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 05:13:33,582 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 05:13:33,582 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 12, 43, 33, 579263), 'iat': datetime.datetime(2025, 7, 4, 12, 13, 33, 579284)}
2025-07-04 05:13:33,583 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 05:13:33,583 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMzYwMTMsImlhdCI6MTc1MTYzMTIxM30.k7OwTtkauKFZ6LvWyRSyAvxVRqbJvX-_pBUL0hehJ4k, Expiry (seconds): 604800
2025-07-04 05:13:33,585 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 05:13:34,742 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:13:34,742 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:13:34,743 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751633013, 'iat': 1751631213}
2025-07-04 05:13:34,743 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751633013, 'iat': 1751631213}
2025-07-04 05:13:34,743 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:13:34,743 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:13:34,743 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:13:34,743 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751633013, 'iat': 1751631213}
2025-07-04 05:13:34,744 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751633013, 'iat': 1751631213}
2025-07-04 05:13:34,744 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:13:34,749 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:13:34,749 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:13:34,749 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:13:34,756 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:13:34,756 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:13:34,756 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751633013, 'iat': 1751631213}
2025-07-04 05:13:34,756 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751633013, 'iat': 1751631213}
2025-07-04 05:13:34,757 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:13:34,757 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:13:34,757 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:13:34,757 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751633013, 'iat': 1751631213}
2025-07-04 05:13:34,758 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751633013, 'iat': 1751631213}
2025-07-04 05:13:34,758 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:13:34,760 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:13:34,760 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:13:34,760 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751633013, 'iat': 1751631213}
2025-07-04 05:13:34,761 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751633013, 'iat': 1751631213}
2025-07-04 05:13:34,761 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:13:34,767 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:13:34,768 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:13:34,768 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:13:34,773 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:13:34,774 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:13:35,047 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:13:35,047 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:13:35,048 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751633013, 'iat': 1751631213}
2025-07-04 05:13:35,048 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751633013, 'iat': 1751631213}
2025-07-04 05:13:35,048 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:13:35,052 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:13:35,052 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:13:35,244 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:13:35,244 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:13:35,244 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751633013, 'iat': 1751631213}
2025-07-04 05:13:35,244 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751633013, 'iat': 1751631213}
2025-07-04 05:13:35,245 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:13:35,251 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:13:35,251 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:13:35,359 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:13:35,359 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:13:35,360 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751633013, 'iat': 1751631213}
2025-07-04 05:13:48,720 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:13:48,720 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:13:48,720 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751633013, 'iat': 1751631213}
2025-07-04 05:13:48,721 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751633013, 'iat': 1751631213}
2025-07-04 05:13:48,721 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:13:48,733 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:13:48,733 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:14:31,142 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:14:31,142 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:14:31,143 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751633013, 'iat': 1751631213}
2025-07-04 05:14:31,143 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751633013, 'iat': 1751631213}
2025-07-04 05:14:31,143 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:14:31,149 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:14:31,149 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:14:31,150 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MzMwMTMsImlhdCI6MTc1MTYzMTIxM30.UzRK1JAtZ-MrXsM4UCbohVCDnql22QH407Gm5dCISyQ
2025-07-04 05:14:31,151 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MzMwMTMsImlhdCI6MTc1MTYzMTIxM30.UzRK1JAtZ-MrXsM4UCbohVCDnql22QH407Gm5dCISyQ
2025-07-04 05:14:41,416 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 05:14:41,416 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 05:14:41,416 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 05:14:41,416 - DEBUG - app.core.security - Payload to encode: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': datetime.datetime(2025, 7, 4, 12, 44, 41, 416072), 'iat': datetime.datetime(2025, 7, 4, 12, 14, 41, 416081)}
2025-07-04 05:14:41,417 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 05:14:41,418 - INFO - app.core.security - Storing refresh token for user ID 9 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiVlRIVE4iLCJleHAiOjE3NTIyMzYwODEsImlhdCI6MTc1MTYzMTI4MX0.xnt1j8rhBCl9pRXjSNnXJh3YhBZ-f4BJgzk_oFIOXlE, Expiry (seconds): 604800
2025-07-04 05:14:41,421 - INFO - app.core.security - Refresh token stored successfully for user ID: 9
2025-07-04 05:14:42,558 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:14:42,559 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:14:42,559 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751633081, 'iat': 1751631281}
2025-07-04 05:14:42,559 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751633081, 'iat': 1751631281}
2025-07-04 05:14:42,559 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:14:42,559 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:14:42,559 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:14:42,560 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751633081, 'iat': 1751631281}
2025-07-04 05:14:42,560 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751633081, 'iat': 1751631281}
2025-07-04 05:14:42,560 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-07-04 05:14:42,569 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-07-04 05:14:42,570 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-07-04 05:14:42,570 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-07-04 05:14:42,582 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:14:42,583 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:14:42,583 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751633081, 'iat': 1751631281}
2025-07-04 05:14:42,583 - INFO - app.core.security - Token payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751633081, 'iat': 1751631281}
2025-07-04 05:14:42,583 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:14:42,584 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:14:42,584 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:14:42,584 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751633081, 'iat': 1751631281}
2025-07-04 05:14:42,584 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751633081, 'iat': 1751631281}
2025-07-04 05:14:42,584 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-07-04 05:14:42,592 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-07-04 05:14:42,592 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-07-04 05:14:42,592 - INFO - app.core.security - Authenticated user - ID: 9, Type: live, Class: User
2025-07-04 05:14:42,599 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:14:42,600 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:14:42,600 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751633081, 'iat': 1751631281}
2025-07-04 05:14:42,600 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751633081, 'iat': 1751631281}
2025-07-04 05:14:42,600 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-07-04 05:14:42,607 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-07-04 05:14:42,607 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-07-04 05:14:43,087 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:14:43,087 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:14:43,088 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751633081, 'iat': 1751631281}
2025-07-04 05:14:43,088 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751633081, 'iat': 1751631281}
2025-07-04 05:14:43,091 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-07-04 05:14:43,116 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-07-04 05:14:43,116 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-07-04 05:14:43,598 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:14:43,599 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:14:43,599 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751633081, 'iat': 1751631281}
2025-07-04 05:14:43,599 - INFO - app.core.security - Token payload in get_current_user: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751633081, 'iat': 1751631281}
2025-07-04 05:14:43,599 - INFO - app.core.security - Looking up live user with ID: 9, Type: live
2025-07-04 05:14:43,605 - INFO - app.core.security - Found live user - ID: 9, Type: live
2025-07-04 05:14:43,605 - INFO - app.core.security - Successfully authenticated user - ID: 9, Type: live, Class: User
2025-07-04 05:14:43,661 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:14:43,662 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:14:43,662 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '9', 'user_type': 'live', 'account_number': 'VTHTN', 'exp': 1751633081, 'iat': 1751631281}
2025-07-04 05:15:24,526 - INFO - app.core.security - Closing Redis connection...
2025-07-04 05:15:24,527 - INFO - app.core.security - Redis connection closed.
2025-07-04 05:35:34,971 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 05:35:34,971 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 05:35:34,975 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 05:35:34,975 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 05:35:34,981 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 05:35:34,981 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 05:35:34,981 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 05:35:34,981 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 13, 10, 34, 981700), 'iat': datetime.datetime(2025, 7, 4, 12, 35, 34, 981702)}
2025-07-04 05:35:34,984 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 05:36:19,331 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 05:36:19,331 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 05:36:19,331 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 05:36:19,332 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 13, 6, 19, 331296), 'iat': datetime.datetime(2025, 7, 4, 12, 36, 19, 331309)}
2025-07-04 05:36:19,332 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 05:36:19,334 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMzczNzksImlhdCI6MTc1MTYzMjU3OX0.WYu172IW9sQp87p3Ab5tnk_XXdGFiJHSDaKTdhwH1ao, Expiry (seconds): 604800
2025-07-04 05:36:19,336 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 05:36:20,483 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:36:20,483 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:36:20,485 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:36:20,485 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:36:20,485 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:36:20,485 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:36:20,485 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:36:20,486 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:36:20,486 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:36:20,486 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:36:20,513 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:36:20,513 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:36:20,514 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:36:20,528 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:36:20,528 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:36:20,528 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:36:20,529 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:36:20,529 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:36:20,529 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:36:20,529 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:36:20,529 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:36:20,529 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:36:20,529 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:36:20,536 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:36:20,536 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:36:20,536 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:36:20,536 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:36:20,537 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:36:20,543 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:36:20,543 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:36:20,543 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:36:20,558 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:36:20,558 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:36:20,833 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:36:20,834 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:36:20,834 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:36:20,834 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:36:20,835 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:36:20,840 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:36:20,840 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:36:21,080 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:36:21,080 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:36:21,080 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:36:21,081 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:36:21,081 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:36:21,087 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:36:21,087 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:36:21,153 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:36:21,153 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:36:21,154 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:36:27,566 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:36:27,566 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:36:27,566 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:36:27,566 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:36:27,566 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:36:27,575 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:36:27,575 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:38:48,654 - INFO - app.core.security - Closing Redis connection...
2025-07-04 05:38:48,655 - INFO - app.core.security - Redis connection closed.
2025-07-04 05:38:51,479 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 05:38:51,479 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 05:38:51,483 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 05:38:51,483 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 05:38:51,491 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 05:38:51,491 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 05:38:51,491 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 05:38:51,492 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 13, 13, 51, 491836), 'iat': datetime.datetime(2025, 7, 4, 12, 38, 51, 491841)}
2025-07-04 05:38:51,492 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 05:38:53,712 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:38:53,712 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:38:53,713 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:39:46,525 - INFO - app.core.security - Closing Redis connection...
2025-07-04 05:39:46,526 - INFO - app.core.security - Redis connection closed.
2025-07-04 05:40:12,190 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 05:40:12,190 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 05:40:12,196 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 05:40:12,196 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 05:40:12,199 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 05:40:12,199 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 05:40:12,199 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 05:40:12,199 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 13, 15, 12, 199633), 'iat': datetime.datetime(2025, 7, 4, 12, 40, 12, 199634)}
2025-07-04 05:40:12,200 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 05:40:15,692 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:40:15,692 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:40:15,692 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:40:16,080 - WARNING - app.core.security - Service account token is missing.
2025-07-04 05:40:21,059 - INFO - app.core.security - Closing Redis connection...
2025-07-04 05:40:21,063 - INFO - app.core.security - Redis connection closed.
2025-07-04 05:41:49,359 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 05:41:49,359 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 05:41:49,363 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 05:41:49,363 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 05:41:49,366 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 05:41:49,366 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 05:41:49,366 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 05:41:49,366 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 13, 16, 49, 366343), 'iat': datetime.datetime(2025, 7, 4, 12, 41, 49, 366345)}
2025-07-04 05:41:49,366 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 05:41:54,709 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:41:54,709 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:41:54,710 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:42:01,085 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:42:01,085 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:42:01,086 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:42:01,086 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:42:01,086 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:42:01,101 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:42:01,101 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:42:10,075 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:42:10,075 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:42:10,075 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:42:10,076 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634379, 'iat': 1751632579}
2025-07-04 05:42:10,076 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:42:10,081 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:42:10,081 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:42:10,082 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MzQzNzksImlhdCI6MTc1MTYzMjU3OX0.xSfanT1Nj1i2uwvLG13Eau3Jalg2-q2QKz_3Q4uOuOw
2025-07-04 05:42:10,083 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MzQzNzksImlhdCI6MTc1MTYzMjU3OX0.xSfanT1Nj1i2uwvLG13Eau3Jalg2-q2QKz_3Q4uOuOw
2025-07-04 05:42:31,959 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 05:42:31,959 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 05:42:31,960 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 05:42:31,960 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 13, 12, 31, 959205), 'iat': datetime.datetime(2025, 7, 4, 12, 42, 31, 959218)}
2025-07-04 05:42:31,961 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 05:42:31,962 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMzc3NTEsImlhdCI6MTc1MTYzMjk1MX0.LudFQTeK--Zq-8cxUBENt5r1E92Q-U3fCJ2ioExBNqA, Expiry (seconds): 604800
2025-07-04 05:42:31,965 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 05:42:33,154 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:42:33,155 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:42:33,155 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:42:33,155 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:42:33,155 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:42:33,155 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:42:33,155 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:42:33,156 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:42:33,156 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:42:33,156 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:42:33,160 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:42:33,160 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:42:33,160 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:42:33,165 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:42:33,166 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:42:33,166 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:42:33,167 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:42:33,167 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 05:42:33,167 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:42:33,167 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:42:33,168 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:42:33,168 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:42:33,168 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:42:33,171 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:42:33,172 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:42:33,172 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:42:33,212 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:42:33,212 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:42:33,213 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:42:33,213 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:42:33,213 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:42:33,219 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:42:33,220 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:42:33,491 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:42:33,491 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:42:33,492 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:42:33,492 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:42:33,492 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:42:33,498 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:42:33,498 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:42:33,715 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:42:33,716 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:42:33,716 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:42:33,716 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:42:33,716 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:42:33,720 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:42:33,720 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:42:33,808 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:42:33,808 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:42:33,809 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:42:41,745 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:42:41,745 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:42:41,746 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:42:41,746 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:42:41,747 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:42:41,755 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:42:41,756 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:43:21,307 - INFO - app.core.security - Closing Redis connection...
2025-07-04 05:43:21,309 - INFO - app.core.security - Redis connection closed.
2025-07-04 05:43:52,872 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 05:43:52,873 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 05:43:52,875 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 05:43:52,875 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 05:43:52,879 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 05:43:52,879 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 05:43:52,879 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 05:43:52,879 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 13, 18, 52, 879468), 'iat': datetime.datetime(2025, 7, 4, 12, 43, 52, 879470)}
2025-07-04 05:43:52,879 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 05:43:56,373 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:43:56,373 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:43:56,374 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:43:56,374 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:43:56,374 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 05:43:56,386 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 05:43:56,386 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 05:43:57,091 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:43:57,091 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:43:57,091 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:45:33,089 - INFO - app.core.security - Closing Redis connection...
2025-07-04 05:45:33,090 - INFO - app.core.security - Redis connection closed.
2025-07-04 05:45:35,931 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 05:45:35,931 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 05:45:35,935 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 05:45:35,935 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 05:45:35,939 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 05:45:35,939 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 05:45:35,939 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 05:45:35,939 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 13, 20, 35, 939056), 'iat': datetime.datetime(2025, 7, 4, 12, 45, 35, 939059)}
2025-07-04 05:45:35,939 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 05:45:40,022 - INFO - app.core.security - Closing Redis connection...
2025-07-04 05:45:40,024 - INFO - app.core.security - Redis connection closed.
2025-07-04 05:45:42,483 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 05:45:42,483 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 05:45:42,488 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 05:45:42,488 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 05:45:42,491 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 05:45:42,491 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 05:45:42,491 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 05:45:42,491 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 13, 20, 42, 491233), 'iat': datetime.datetime(2025, 7, 4, 12, 45, 42, 491235)}
2025-07-04 05:45:42,491 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 05:45:44,662 - INFO - app.core.security - Closing Redis connection...
2025-07-04 05:45:44,665 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:45:44,665 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:45:44,665 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 05:45:44,669 - INFO - app.core.security - Redis connection closed.
2025-07-04 05:58:29,593 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 05:58:29,593 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 05:58:29,599 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 05:58:29,599 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 05:58:29,602 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 05:58:29,602 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 05:58:29,602 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 05:58:29,603 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 13, 33, 29, 602936), 'iat': datetime.datetime(2025, 7, 4, 12, 58, 29, 602938)}
2025-07-04 05:58:29,603 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 05:58:34,204 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 05:58:34,204 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 05:58:34,206 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751634751, 'iat': 1751632951}
2025-07-04 06:03:08,509 - INFO - app.core.security - Closing Redis connection...
2025-07-04 06:03:08,513 - INFO - app.core.security - Redis connection closed.
2025-07-04 06:21:15,901 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 06:21:15,901 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 06:21:15,921 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 06:21:15,921 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 06:21:15,929 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 06:21:15,929 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 06:21:15,929 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 06:21:15,929 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 13, 56, 15, 929396), 'iat': datetime.datetime(2025, 7, 4, 13, 21, 15, 929398)}
2025-07-04 06:21:15,931 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 06:21:20,312 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:21:20,312 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:21:20,314 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 06:21:26,695 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:21:26,695 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:21:26,695 - WARNING - app.core.security - JWTError in decode_token: ExpiredSignatureError - Signature has expired.
Traceback (most recent call last):
  File "C:\Users\Dhanush\FASTAPI\app\core\security.py", line 93, in decode_token
    payload = jwt.decode(token, settings.SECRET_KEY, algorithms=[settings.ALGORITHM])
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 174, in decode
    _validate_claims(
    ~~~~~~~~~~~~~~~~^
        claims,
        ^^^^^^^
    ...<5 lines>...
        options=defaults,
        ^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 497, in _validate_claims
    _validate_exp(claims, leeway=leeway)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Dhanush\FASTAPI\venv\Lib\site-packages\jose\jwt.py", line 331, in _validate_exp
    raise ExpiredSignatureError("Signature has expired.")
jose.exceptions.ExpiredSignatureError: Signature has expired.
2025-07-04 06:21:29,476 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:21:29,477 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:21:29,477 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1752237751, 'iat': 1751632951}
2025-07-04 06:21:29,477 - INFO - app.core.security - Attempting to retrieve refresh token data for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyMzc3NTEsImlhdCI6MTc1MTYzMjk1MX0.LudFQTeK--Zq-8cxUBENt5r1E92Q-U3fCJ2ioExBNqA
2025-07-04 06:21:29,481 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 06:21:29,481 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 06:21:29,481 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 06:21:29,481 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 13, 51, 29, 481596), 'iat': datetime.datetime(2025, 7, 4, 13, 21, 29, 481600)}
2025-07-04 06:21:29,481 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 06:21:29,482 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyNDAwODksImlhdCI6MTc1MTYzNTI4OX0.YR7Poqxy2nvlMQpuu8F2WIMGA_SSNwBYfU7N_fbHzII, Expiry (seconds): 604800
2025-07-04 06:21:29,482 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 06:21:32,023 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:21:32,023 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:21:32,024 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637089, 'iat': 1751635289}
2025-07-04 06:21:32,886 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:21:32,886 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:21:32,887 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637089, 'iat': 1751635289}
2025-07-04 06:21:32,887 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637089, 'iat': 1751635289}
2025-07-04 06:21:32,887 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 06:21:32,887 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:21:32,887 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:21:32,887 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637089, 'iat': 1751635289}
2025-07-04 06:21:32,887 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637089, 'iat': 1751635289}
2025-07-04 06:21:32,887 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 06:21:32,907 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 06:21:32,907 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 06:21:32,907 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 06:24:20,806 - INFO - app.core.security - Closing Redis connection...
2025-07-04 06:24:20,807 - INFO - app.core.security - Redis connection closed.
2025-07-04 06:27:59,292 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 06:27:59,292 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 06:27:59,295 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 06:27:59,295 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 06:27:59,300 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 06:27:59,300 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 06:27:59,300 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 06:27:59,300 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 14, 2, 59, 300272), 'iat': datetime.datetime(2025, 7, 4, 13, 27, 59, 300274)}
2025-07-04 06:27:59,300 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 06:28:01,877 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:28:01,877 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:28:01,877 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637089, 'iat': 1751635289}
2025-07-04 06:28:01,877 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637089, 'iat': 1751635289}
2025-07-04 06:28:01,877 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 06:28:01,883 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 06:28:01,883 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 06:28:01,883 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MzcwODksImlhdCI6MTc1MTYzNTI4OX0._K0ucmyNpilMuYtC7EPJPgXpQ4fO5zFs5RiKUUL-L8A
2025-07-04 06:28:01,883 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTE2MzcwODksImlhdCI6MTc1MTYzNTI4OX0._K0ucmyNpilMuYtC7EPJPgXpQ4fO5zFs5RiKUUL-L8A
2025-07-04 06:28:20,653 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 06:28:20,653 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 06:28:20,653 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 06:28:20,653 - DEBUG - app.core.security - Payload to encode: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': datetime.datetime(2025, 7, 4, 13, 58, 20, 653281), 'iat': datetime.datetime(2025, 7, 4, 13, 28, 20, 653291)}
2025-07-04 06:28:20,654 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 06:28:20,654 - INFO - app.core.security - Storing refresh token for user ID 1 (Type: demo). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTIyNDA1MDAsImlhdCI6MTc1MTYzNTcwMH0._7DlwSFtSaDToWYoSVZ5YX4gZ3WcUcPGN9sbs_frHvc, Expiry (seconds): 604800
2025-07-04 06:28:20,656 - INFO - app.core.security - Refresh token stored successfully for user ID: 1
2025-07-04 06:28:21,847 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:28:21,847 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:28:21,847 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751637500, 'iat': 1751635700}
2025-07-04 06:28:21,847 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751637500, 'iat': 1751635700}
2025-07-04 06:28:21,848 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 06:28:21,848 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:28:21,848 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:28:21,848 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751637500, 'iat': 1751635700}
2025-07-04 06:28:21,848 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751637500, 'iat': 1751635700}
2025-07-04 06:28:21,848 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 06:28:21,861 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 06:28:21,861 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 06:28:21,861 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 06:28:21,873 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:28:21,873 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:28:21,874 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751637500, 'iat': 1751635700}
2025-07-04 06:28:21,874 - INFO - app.core.security - Token payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751637500, 'iat': 1751635700}
2025-07-04 06:28:21,874 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 06:28:21,874 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:28:21,874 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:28:21,874 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751637500, 'iat': 1751635700}
2025-07-04 06:28:21,875 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751637500, 'iat': 1751635700}
2025-07-04 06:28:21,875 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 06:28:21,880 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 06:28:21,880 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 06:28:21,880 - INFO - app.core.security - Authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 06:28:21,886 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:28:21,886 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:28:21,887 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751637500, 'iat': 1751635700}
2025-07-04 06:28:21,887 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751637500, 'iat': 1751635700}
2025-07-04 06:28:21,887 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 06:28:21,890 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 06:28:21,891 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 06:28:22,117 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:28:22,117 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:28:22,117 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751637500, 'iat': 1751635700}
2025-07-04 06:28:22,117 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751637500, 'iat': 1751635700}
2025-07-04 06:28:22,117 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 06:28:22,120 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 06:28:22,120 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 06:28:22,445 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:28:22,445 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:28:22,446 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751637500, 'iat': 1751635700}
2025-07-04 06:28:22,642 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:28:22,642 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:28:22,642 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751637500, 'iat': 1751635700}
2025-07-04 06:28:22,643 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751637500, 'iat': 1751635700}
2025-07-04 06:28:22,643 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 06:28:22,654 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 06:28:22,654 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 06:28:33,723 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:28:33,723 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:28:33,723 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751637500, 'iat': 1751635700}
2025-07-04 06:28:33,723 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751637500, 'iat': 1751635700}
2025-07-04 06:28:33,724 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 06:28:33,727 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 06:28:33,727 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 06:29:35,837 - INFO - app.core.security - Closing Redis connection...
2025-07-04 06:29:35,840 - INFO - app.core.security - Redis connection closed.
2025-07-04 06:31:30,659 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 06:31:30,659 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 06:31:30,662 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 06:31:30,662 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 06:31:30,666 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 06:31:30,666 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 06:31:30,666 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 06:31:30,666 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 14, 6, 30, 666624), 'iat': datetime.datetime(2025, 7, 4, 13, 31, 30, 666626)}
2025-07-04 06:31:30,667 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 06:31:32,743 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:31:32,743 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:31:32,744 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751637500, 'iat': 1751635700}
2025-07-04 06:31:40,386 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:31:40,386 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:31:40,386 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751637500, 'iat': 1751635700}
2025-07-04 06:31:40,386 - INFO - app.core.security - Token payload in get_current_user: {'sub': '1', 'user_type': 'demo', 'account_number': '5O42G', 'exp': 1751637500, 'iat': 1751635700}
2025-07-04 06:31:40,386 - INFO - app.core.security - Looking up demo user with ID: 1
2025-07-04 06:31:40,390 - INFO - app.core.security - Found demo user - ID: 1, Type: demo
2025-07-04 06:31:40,390 - INFO - app.core.security - Successfully authenticated user - ID: 1, Type: demo, Class: DemoUser
2025-07-04 06:31:40,390 - INFO - app.core.security - Attempting to delete refresh token for key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE2Mzc1MDAsImlhdCI6MTc1MTYzNTcwMH0.tJ4StTcfF_1n1mjuVD5GJXR6b9VwBOj7hxMw77BkLEA
2025-07-04 06:31:40,390 - WARNING - app.core.security - Attempted to delete refresh token, but key not found in Redis: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxIiwidXNlcl90eXBlIjoiZGVtbyIsImFjY291bnRfbnVtYmVyIjoiNU80MkciLCJleHAiOjE3NTE2Mzc1MDAsImlhdCI6MTc1MTYzNTcwMH0.tJ4StTcfF_1n1mjuVD5GJXR6b9VwBOj7hxMw77BkLEA
2025-07-04 06:31:52,498 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 06:31:52,498 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 06:31:52,498 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 06:31:52,498 - DEBUG - app.core.security - Payload to encode: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': datetime.datetime(2025, 7, 4, 14, 1, 52, 498226), 'iat': datetime.datetime(2025, 7, 4, 13, 31, 52, 498238)}
2025-07-04 06:31:52,499 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 06:31:52,499 - INFO - app.core.security - Storing refresh token for user ID 4 (Type: N/A). Key: refresh_token:eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI0IiwidXNlcl90eXBlIjoibGl2ZSIsImFjY291bnRfbnVtYmVyIjoiRFlZNUEiLCJleHAiOjE3NTIyNDA3MTIsImlhdCI6MTc1MTYzNTkxMn0.QI8jdVb9LjJkE5WGMzx8LnpoC--A0KT36iPK-76Omk0, Expiry (seconds): 604800
2025-07-04 06:31:52,503 - INFO - app.core.security - Refresh token stored successfully for user ID: 4
2025-07-04 06:31:53,588 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:31:53,589 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:31:53,589 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:31:53,589 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:31:53,589 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 06:31:53,589 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:31:53,589 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:31:53,590 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:31:53,590 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:31:53,590 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 06:31:53,596 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 06:31:53,596 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 06:31:53,596 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 06:31:53,608 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:31:53,608 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:31:53,608 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:31:53,608 - INFO - app.core.security - Token payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:31:53,609 - INFO - app.core.security - Regular user token detected. Deferring to get_current_user.
2025-07-04 06:31:53,609 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:31:53,609 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:31:53,609 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:31:53,609 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:31:53,609 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 06:31:53,612 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:31:53,612 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:31:53,612 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:31:53,612 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:31:53,612 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 06:31:53,617 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 06:31:53,618 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 06:31:53,618 - INFO - app.core.security - Authenticated user - ID: 4, Type: live, Class: User
2025-07-04 06:31:53,622 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 06:31:53,622 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 06:31:53,906 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:31:53,906 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:31:53,907 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:31:53,907 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:31:53,907 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 06:31:53,913 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 06:31:53,914 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 06:31:54,153 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:31:54,154 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:31:54,154 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:31:54,154 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:31:54,154 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 06:31:54,158 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 06:31:54,159 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 06:31:54,223 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:31:54,224 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:31:54,224 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:31:58,657 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:31:58,657 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:31:58,658 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:31:58,658 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:31:58,658 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 06:31:58,666 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 06:31:58,667 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 06:40:02,401 - INFO - app.core.security - Closing Redis connection...
2025-07-04 06:40:02,405 - INFO - app.core.security - Redis connection closed.
2025-07-04 06:43:05,121 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 06:43:05,121 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 06:43:05,124 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 06:43:05,125 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 06:43:05,130 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 06:43:05,130 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 06:43:05,130 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 06:43:05,130 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 14, 18, 5, 130388), 'iat': datetime.datetime(2025, 7, 4, 13, 43, 5, 130390)}
2025-07-04 06:43:05,131 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 06:43:11,061 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:43:11,062 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:43:11,063 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:43:11,224 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:43:11,224 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:43:11,225 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:43:11,225 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:43:11,225 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 06:43:11,239 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 06:43:11,239 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 06:45:26,640 - INFO - app.core.security - Closing Redis connection...
2025-07-04 06:45:26,641 - INFO - app.core.security - Redis connection closed.
2025-07-04 06:45:32,552 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 06:45:32,552 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 06:45:32,557 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 06:45:32,557 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 06:45:32,563 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 06:45:32,563 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 06:45:32,563 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 06:45:32,563 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 14, 20, 32, 563449), 'iat': datetime.datetime(2025, 7, 4, 13, 45, 32, 563452)}
2025-07-04 06:45:32,564 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 06:45:38,707 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:45:38,708 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:45:38,708 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:48:14,684 - INFO - app.core.security - Closing Redis connection...
2025-07-04 06:48:14,685 - INFO - app.core.security - Redis connection closed.
2025-07-04 06:50:32,068 - INFO - app.core.security - Attempting to connect to Redis...
2025-07-04 06:50:32,068 - INFO - app.core.security - Redis connection details:
  Host: 127.0.0.1
  Resolved IP: 127.0.0.1
  Port: 6379
  DB: 0
  Password: <not set>
  Persistence: AOF enabled (appendonly.aof)
2025-07-04 06:50:32,071 - INFO - app.core.security - [SUCCESS] AOF persistence is correctly configured
2025-07-04 06:50:32,071 - INFO - app.core.security - [SUCCESS] Connected to Redis at 127.0.0.1 (127.0.0.1):6379
2025-07-04 06:50:32,077 - DEBUG - app.core.security - 
--- Token Creation Details ---
2025-07-04 06:50:32,077 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for encoding
2025-07-04 06:50:32,077 - DEBUG - app.core.security - ALGORITHM used for encoding: 'HS256'
2025-07-04 06:50:32,077 - DEBUG - app.core.security - Payload to encode: {'sub': 'barclays_service_provider', 'is_service_account': True, 'exp': datetime.datetime(2025, 7, 4, 14, 25, 32, 77635), 'iat': datetime.datetime(2025, 7, 4, 13, 50, 32, 77638)}
2025-07-04 06:50:32,078 - DEBUG - app.core.security - Generated JWT: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...

2025-07-04 06:50:38,195 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:50:38,195 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:50:38,196 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:50:38,197 - INFO - app.core.security - Token payload in get_current_user: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:50:38,197 - INFO - app.core.security - Looking up live user with ID: 4, Type: live
2025-07-04 06:50:38,213 - INFO - app.core.security - Found live user - ID: 4, Type: live
2025-07-04 06:50:38,213 - INFO - app.core.security - Successfully authenticated user - ID: 4, Type: live, Class: User
2025-07-04 06:50:41,731 - DEBUG - app.core.security - Attempting to decode token: eyJhbGciOiJIUzI1NiIsInR5cCI6Ik...
2025-07-04 06:50:41,731 - DEBUG - app.core.security - Using SECRET_KEY: C8mDq... for decoding
2025-07-04 06:50:41,732 - DEBUG - app.core.security - Token decoded successfully. Payload: {'sub': '4', 'user_type': 'live', 'account_number': 'DYY5A', 'exp': 1751637712, 'iat': 1751635912}
2025-07-04 06:51:23,419 - INFO - app.core.security - Closing Redis connection...
2025-07-04 06:51:23,422 - INFO - app.core.security - Redis connection closed.
